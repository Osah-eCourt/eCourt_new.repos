
var delta=window.delta||{};delta.navwidget=(function($){var nav=$('#nav-widget');var defaultHomeWidget="booking";var widgetVerticalPadding=24;var buttons=$('#nav-widget-mydelta, #nav-widget-booking, #nav-widget-status, #nav-widget-checkin, #nav-widget-escape, #nav-widget-need-help');var tabHeightCache={};var idPrefix='nav-widget-';var isOpenByDefault=false;var isDocked=nav.hasClass('docked');var isOpen=false;var isAnimating=false;var isExpanded=false;var isWidgetInitialized={"mydelta":false,"mytrips":false,"booking":false,"status":false,"checkin":false,"escape":false,"help":false};var buttonExpandTiming='228';var buttonExpandEasing='easeInQuint';var widgetExpandTiming='600';var widgetExpandEasing='easeOutExpo';var widgetFadeTiming='100';var mouseOutTimeout;var navWidgets=[];var navLocked=false;var pub={};pub.events={'close':'nav-widget-close-event','open':'nav-widget-open-event'};pub.init=function(){if(isDocked){initDockedElements();initDockedMouseOvers();initDockedWidgets();}else{initHomeWidgets();}};function addHelpNumber(){var widgetHeader="";if(CustomerInfo.isLoggedIn()&&CustomerInfo.isSkyMilesMember()&&CustomerInfo.getMembershipLevel()!="FF"){widgetHeader+='<p><strong>';if(CustomerInfo.getMembershipLevel()!='FF'){if(CustomerInfo.getMembershipLevel()=="FO"){widgetHeader+='Silver';}else if(CustomerInfo.getMembershipLevel()=="GM"){widgetHeader+='Gold';}else if(CustomerInfo.getMembershipLevel()=="PM"){widgetHeader+='Platinum';}else if(CustomerInfo.getMembershipLevel()=="DM"){widgetHeader+='Diamond';}
widgetHeader+=" Medallion";if(CustomerInfo.getMembershipLevel()=='DM'){widgetHeader+=" 1-800-325-6330";}else if(CustomerInfo.getMembershipLevel()=='PM'||CustomerInfo.getMembershipLevel()=="GM"){widgetHeader+=" 1-800-325-1551";}else if(CustomerInfo.getMembershipLevel()=="FO"){widgetHeader+=" 1-800-325-6330";}
widgetHeader+="</strong>"
if(CustomerInfo.getCountry()=="US"||CustomerInfo.getCountry()=="us"){}}
widgetHeader+="</p>";}
$("#helpHeader").html(widgetHeader);isWidgetInitialized["help"]==true;};function addTabHandlers(widgetName){switch(widgetName){case"booking":$('#widget-booking').on('tabsshow','#book-tabs',function(){var linkId=$("#book-tabs li.ui-state-active a").attr('id');var widgetHeight=0;if(linkId.toLowerCase()==="book-air-content-trigger"){widgetHeight=resizeWidget.getWidgetHeight();}else if(linkId.toLowerCase()==="book-hotel-content-trigger"){hideAirportLookup();HotelWidget.init();widgetHeight=resizeHotelWidget.getWidgetHeight();}else if(linkId.toLowerCase()==="book-car-content-trigger"){hideAirportLookup();CarWidget.init();widgetHeight=resizeCarWidget.getWidgetHeight();}else if(linkId.toLowerCase()==="book-delta-vacations-content-trigger"){widgetHeight="auto";}
if(widgetHeight>0){if(linkId.toLowerCase()==="book-air-content-trigger"){widgetHeight="auto";$("#widget-booking").css("height","auto");}
$("#widget-booking").animate({height:widgetHeight},widgetExpandTiming,widgetExpandEasing);}else{delta.navwidget.adjustWidgetHeight(widgetName);}});break;case"escape":$("#escape-tabs ul li a#ui-tabs-mapit").click(function(){$("#widget-booking").animate({height:delta.navwidget.adjustWidgetHeight(widgetName)},widgetExpandTiming,widgetExpandEasing);});$("#escape-tabs ul li a#ui-tabs-search").click(function(){$("#widget-booking").animate({height:delta.navwidget.adjustWidgetHeight(widgetName)},widgetExpandTiming,widgetExpandEasing);});$("#escape-tabs ul li a#ui-tabs-specialty").click(function(){$("#widget-booking").animate({height:delta.navwidget.adjustWidgetHeight(widgetName)},widgetExpandTiming,widgetExpandEasing);});$("#escape-tabs ul li a#ui-tabs-cruises").click(function(){$("#widget-escape").animate({height:delta.navwidget.adjustWidgetHeight(widgetName)},widgetExpandTiming,widgetExpandEasing);});break;default:break;}};function adjustWidgetHeight(widgetName){var widget=$("#widget-"+widgetName);var widgetChildren=$("#widget-"+widgetName).children();var previousVisibility=widget.css("visibility");var previousDisplay=widget.css("display");widget.css("display","none");widget.css("visibility","hidden");widget.css("display","block");var height=0;if(widgetName.toLowerCase()==="booking"&&!isDocked){var linkId=$("#book-tabs li.ui-state-active a").attr('id');if(linkId.toLowerCase()==="book-air-content-trigger"){height=resizeWidget.getWidgetHeight();}else if(linkId.toLowerCase()==="book-hotel-content-trigger"){height=resizeHotelWidget.getWidgetHeight();}else if(linkId.toLowerCase()==="book-car-content-trigger"){height=resizeCarWidget.getWidgetHeight();}else if(linkId.toLowerCase()==="book-delta-vacations-content-trigger"){height=resizeVacationsWidget.getWidgetHeight();}}
if(height===0){for(i=0,j=widgetChildren.length;i<j;i++){if($(widgetChildren[i]).css("display")==="block"){height+=$(widgetChildren[i]).innerHeight();}}}
widget.css("visibility",previousVisibility);widget.css("display",previousDisplay);if(isDocked){var widgetPadding=$("#"+idPrefix+(widgetName!=="help"?"":"need-")+widgetName).css("paddingTop");if(DeltaUtils.exists(widgetPadding)&&widgetPadding!==""){widgetPadding=widgetPadding.replace("px","");if(!isNaN(widgetPadding)){widgetPadding=parseInt(widgetPadding,10);}}
var dockedNavHeight=0;dockedNavHeight=parseInt(nav.innerHeight()/3);if(widgetName.toLowerCase()==="status"){height="372px";}else{height="auto";}}else{if(widgetName.toLowerCase()==="booking"){height="auto";}}
widget.css("height",height);return height;};function closeDockedNav(){if(!isOpen){return false;}else{isOpen=false;}
var sectionHeight=isExpanded?'40px':'23px';var containerHeight=isExpanded?'48px':'31px';delta.navwidget.closeWidgets();nav.find('#nav-widget-expander .minimized').show();nav.find('#nav-widget-expander .maximized').hide();nav.find('#nav-widget-container').animate({height:containerHeight},200);nav.find('section').animate({height:sectionHeight,paddingTop:'8px'},200);nav.find('figure').animate({width:'0',marginTop:'0',marginRight:'0'},200);nav.find('figure img').animate({left:'-42px'},200);};function closeDockedWidgets(){setWidgetShowHideClickHandler_off();var openWidget=$('.widget-container-docked:visible');var activeButton=buttons.filter('.active');$('#nav-widget-container').removeClass("expanded");openWidget.fadeOut(widgetFadeTiming,delta.navwidget.close);activeButton.removeClass('active');navLocked=false;if(openWidget.length)$.event.trigger({type:pub.events.close,'openWidget':openWidget});};function closeHomeWidgets(){setWidgetShowHideClickHandler_off();var openWidget=nav.find('.widget-container:visible');var activeButton=buttons.filter('.active');openWidget.fadeOut(widgetFadeTiming);activeButton.removeClass('active');activeButton.animate({width:'145px'},buttonExpandTiming,buttonExpandEasing,function(){isAnimating=false;});isOpen=false;if(openWidget.length)$.event.trigger({type:pub.events.close,'openWidget':openWidget});};function forceOpen(){var data;try{if(DeltaUtils.exists(loginData)&&loginData!=null){data=loginData;}else if(DeltaUtils.exists(tmpLoginData)&&tmpLoginData!=null){data=tmpLoginData;}}catch(error){try{if(DeltaUtils.exists(tmpLoginData)&&tmpLoginData!=null){data=tmpLoginData;}}catch(error){data=null;}}
if(this.isOpenByDefault){try{switch(selectedWidget){case"mydelta":case"booking":case"status":case"checkin":case"escape":delta.navwidget.openWidget(selectedWidget);delta.navwidget.initializeWidget(selectedWidget);delta.navwidget.isWidgetInitialized[selectedWidget]=true;break;case"book-vacation":delta.navwidget.openWidget("booking");delta.navwidget.initializeWidget("booking");delta.navwidget.isWidgetInitialized["booking"]=true;break;default:if(data!=null){if(data.loggedIn){CustomerInfo.addRaphaelScript();$("#nav-widget-mydelta h3").html("My Delta");$("#nav-widget-mydelta small").html("Trips, Skymiles, Profile &amp; Receipts");$("#widget-mydelta.widget-container").offset({left:$("#widget-mydelta.widget-container").offset().left+49});$("#widget-mydelta.widget-container").css({"height":"auto"});$("#nav-widget-mydelta").addClass("active");$("#nav-widget-mydelta").css({"width":"300"});delta.navwidget.initializeWidget("mydelta");delta.navwidget.isWidgetInitialized["mydelta"]=true;}else{$("#loginwidget").removeClass("hideMe");$("#widget-booking.widget-container").offset({left:$("#widget-booking.widget-container").offset().left+207});$("#widget-booking.widget-container").css({"height":"auto"});$("#nav-widget-booking").addClass("active");$("#nav-widget-booking").css({"width":"300"});delta.navwidget.initializeWidget("booking");delta.navwidget.isWidgetInitialized["booking"]=true;}}else{$("#loginwidget").removeClass("hideMe");$("#widget-booking.widget-container").offset({left:$("#widget-booking.widget-container").offset().left+207});$("#widget-booking.widget-container").css({"height":"auto"});$("#nav-widget-booking").addClass("active");$("#nav-widget-booking").css({"width":"300"});delta.navwidget.initializeWidget("booking");delta.navwidget.isWidgetInitialized["booking"]=true;}}}catch(error){$("#loginwidget").removeClass("hideMe");$("#widget-booking.widget-container").offset({left:$("#widget-booking.widget-container").offset().left+207});$("#widget-booking.widget-container").css({"height":"auto"});$("#nav-widget-booking").addClass("active");$("#nav-widget-booking").css({"width":"300"});delta.navwidget.initializeWidget("booking");delta.navwidget.isWidgetInitialized["booking"]=true;}}};function hideDockedBar(){$("#nav-widget").hide();};function hideIropIndicator(){$("#irop-indicator").hide();};function initDockedElements(){try{if((DeltaUtils.exists(loginData)&&loginData.loggedIn)||(DeltaUtils.exists(tmpLoginData)&&tmpLoginData.loggedIn)){delta.navwidget.showMyDelta()}}catch(error){}
var h3s=nav.find('h3');var h3sLength=h3s.length;h3s.each(function(i,o){var height=$(this).height();if(height>28){nav.addClass('expanded');isExpanded=true;return;}});$('#nav-widget-user figure').css('marginRight','0');var navContentContainer=new htmlDefinition({"tag":"div","id":"nav-widget-content","stub":true});var navContainer=new htmlDefinition({"tag":"div","id":"nav-widget-container","stub":true});nav.wrapInner(HTMLModeler.createOpenElem(navContentContainer));nav.wrapInner(HTMLModeler.createOpenElem(navContainer));$('<div id="nav-widget-topper" />').prependTo(nav);};function initDockedMouseOvers(){nav.hoverIntent({over:function(){delta.navwidget.open();clearInterval(mouseOutTimeout);},out:function(){mouseOutTimeout=navLocked?null:setTimeout(function(){delta.navwidget.close();},50);},timeout:500});nav.find('#nav-widget-expander').click(function(){if(isOpen){delta.navwidget.close();}else{delta.navwidget.open();}});};function initDockedWidgets(){buttons.bind('click',function(e){var w=$(e.target).closest('section');delta.navwidget.openWidget(w.attr('id').replace(idPrefix,''));});$('.widget-container-docked .close').live('click',function(e){delta.navwidget.close();});$(window).bind('resize',function(){positionNavWidgets();});};function initHomeWidgets(){buttons.bind('click',function(e){onclickpress_open(e);});buttons.bind('keypress',function(e){if(e.keyCode===13)onclickpress_open(e);});var onclickpress_open=function(e){var w=$(e.target).closest('section');if(w.hasClass('active')){delta.navwidget.closeWidgets();}else{delta.navwidget.openWidget(w.attr('id').replace(idPrefix,''));}};try{if(isHomePage){if(DeltaUtils.exists(isHomePage)&&isHomePage&&(DeltaUtils.exists(darkSiteState)&&darkSiteState!="dark-site-state1")&&(DeltaUtils.exists(darkSiteState)&&darkSiteState!="dark-site-state2")&&(DeltaUtils.exists(darkSiteState)&&darkSiteState!="dark-site-state3")){delta.navwidget.isOpenByDefault=true;}}}catch(error){}};function initializeWidget(widgetName){if(widgetName=="booking"){$("#book-tabs").tabs();try{if(selectedWidget=="book-vacation"){$("#book-tabs").tabs("select",3);}}catch(error){}
addTabHandlers(widgetName);SimpleSearchWidget.init();VacationWidget.init();}else if(widgetName=="checkin"){try{CheckinWidget.initialize();}catch(e){}}else if(widgetName=="mydelta"){if(!CustomerInfo.isAuthenticated()&&!CustomerInfo.isLoggedIn()){myTripsWidget.init();}else{MyDeltaSummaryWidget.initMyDeltaSummaryJSON();}}else if(widgetName=="status"){FlightStatusWidget.init();}else if(widgetName=="escape"){$("#escape-tabs").tabs();EscapeWidget.init();addTabHandlers(widgetName);}else if(widgetName=="help"){delta.navwidget.addHelpNumber();$("#needHelptabs").tabs();NeedHelpWidgetTemp.init();}
delta.navwidget.isWidgetInitialized[widgetName]=true;}
function initWidgets(){NeedHelpWidgetTemp.init();};function isDockedState(){return isDocked;};function openDockedNav(){if(isOpen){return false;}else{isOpen=true;}
var sectionHeight=isExpanded?'71px':'51px';var containerHeight=isExpanded?'87px':'67px';nav.find('#nav-widget-expander .maximized').css({display:'inline',marginTop:'10px'});nav.find('#nav-widget-expander .minimized').hide();$('#nav-widget-container').addClass("expanded");nav.find('#nav-widget-container').animate({height:containerHeight},200);nav.find('section').animate({height:sectionHeight,paddingTop:'16px'},200);nav.find('figure').animate({width:'42px',marginTop:'-3px',marginRight:'10px'},200);nav.find('figure img').animate({left:'0'},200);};function openDockedWidget(widgetName,callback){setWidgetShowHideClickHandler_on();var target=widgetName;if(widgetName=="need-help"){target=widgetName;widgetName="help";}else if(widgetName=="mydelta"){try{if(DeltaUtils.exists(CustomerInfo)){if(!CustomerInfo.isAuthenticated()&&!CustomerInfo.isLoggedIn()){widgetName="mytrips";target="mydelta";myTripsWidget.init();}}}catch(error){widgetName="mytrips";target="mydelta";myTripsWidget.init();}}
if(isAnimating){return false;}else{isAnimating=true;}
if(!isOpen){delta.navwidget.open();}
callback=callback||function(){return true;}
navLocked=true;var w=$('#widget-'+widgetName);var wButton=$('#'+idPrefix+target);var openWidget=$('.widget-container-docked:visible');if(!isWidgetInitialized[widgetName]){initializeWidget(widgetName);isWidgetInitialized[widgetName]==true;}
if(w.attr('id')==openWidget.attr('id')){isAnimating=false;return false;}
var activeButton=buttons.filter('.active');activeButton.removeClass('active');wButton.addClass('active');w.css('z-index',100);if(widgetName!="mydelta"){w.height(delta.navwidget.adjustWidgetHeight(widgetName));}
openWidget.css('z-index',50);openWidget.fadeOut(widgetFadeTiming);positionNavWidget(w,$('#'+idPrefix+target));if(openWidget.length){$.event.trigger({type:pub.events.close,'openWidget':openWidget});}
w.slideDown('75',function(){try{setPredictiveTextDefinition(widgetName);}catch(error){}
isAnimating=false;callback();});};function openHomeWidget(widgetName,callback){setWidgetShowHideClickHandler_on();var target=widgetName;if(widgetName=="mydelta"){try{if(DeltaUtils.exists(CustomerInfo)){if(!CustomerInfo.isAuthenticated()&&!CustomerInfo.isLoggedIn()){widgetName="mytrips";myTripsWidget.init();}}}catch(error){widgetName="mytrips";target="mydelta";myTripsWidget.init();}}
if(isAnimating){return false;}else{isAnimating=true;}
callback=callback||function(){return true;}
var w=$('#widget-'+widgetName);var wButton=$('#'+idPrefix+target);var openWidget=nav.find('.widget-container:visible');var needsInitialize=true;if(!isWidgetInitialized[widgetName]){initializeWidget(widgetName);isWidgetInitialized[widgetName]==true;}
if(delta.advisorywidget){delta.advisorywidget.close();}
isOpen=true;if(openWidget.length){$.event.trigger({type:pub.events.close,'openWidget':openWidget});}
$.Deferred(function(dfr){dfr.pipe(function(){var activeButton=buttons.filter('.active');activeButton.removeClass('active');wButton.addClass('active');openWidget.fadeOut(widgetFadeTiming);return $.when(activeButton.animate({width:'145px'},buttonExpandTiming,buttonExpandEasing),wButton.animate({width:'300px'},buttonExpandTiming,buttonExpandEasing));}).pipe(function(){var wPos=wButton.position();w.css({left:wPos.left+1,height:$("#widget-"+widgetName).height(),display:'block'});if(!isAnimating){return false;}
return w.animate({height:delta.navwidget.adjustWidgetHeight(widgetName)},widgetExpandTiming,widgetExpandEasing,function(){setPredictiveTextDefinition(widgetName);isAnimating=false;callback();});});}).resolve();};function positionNavWidget(widget,target){var pos=target.offset();var navWRight=nav.find('#nav-widget-content').offset().left+960;if(pos.left+312<navWRight){widget.css('left',pos.left);}else{var posRight=nav.width()-(pos.left+target.outerWidth());widget.css('right',posRight);}};function positionNavWidgets(){for(var w in navWidgets){try{positionNavWidget(navWidgets[w].obj,navWidgets[w].target);}catch(error){}}};function setDefaultHomeWidget(widget){defaultHomeWidget=widget;};function setPredictiveTextDefinition(widgetName){if(widgetName!=="checkin"&&widgetName!=="escape"){DeltaUtils.setPredictiveTextDefinition(null);}else{DeltaUtils.setPredictiveTextDefinition((widgetName==="checkin"?CheckinWidget.predictiveTextDefinition:EscapeWidget.predictiveTextDefinition));}}
function setWidgetShowHideClickHandler_on(){$('html').on('click.navWidgetShowHide',function(e){if(!$(e.target).is('td,li')&&!$(e.target).closest('nav, li a, .deltaToolTipTheme, .widget-container-docked, #airportlookup_dropdown, .delta2UpCal, .escape-child, #airportLookupContent, #LayoutContainer #ContentContainer button[data-icon-right="ui-icon-carat-1-e"]').length>0){delta.navwidget.closeWidgets();if(DeltaUtils.exists("#escape-widget-popup")&&$("#escape-widget-popup").is(":visible")){$('#escape-widget-popup #close_image').trigger('click');}}});}
function setWidgetShowHideClickHandler_off(){$('html').off('click.navWidgetShowHide');}
function showDockedBar(){$("#nav-widget").show();}
function showIropIndicator(){$("#irop-indicator").show();};function hideAirportLookup(){if(DeltaUtils.exists("#airportlookup_dropdown")&&$("#airportlookup_dropdown").is(":visible")){$("#airportlookup_dropdown").hide();$(".activeTarget").removeClass("activeTarget");}};function showMyDelta(){$("#nav-widget-mydelta h3").html("My Delta");$("#nav-widget-mydelta small").html("Trips, Skymiles, Profile &amp; Receipts");setDefaultHomeWidget("mydelta");};if(isDocked){pub.open=openDockedNav;pub.close=closeDockedNav;pub.openWidget=openDockedWidget;pub.closeWidgets=closeDockedWidgets;pub.showIropIndicator=showIropIndicator;pub.hideIropIndicator=hideIropIndicator;pub.addHelpNumber=addHelpNumber;}else{pub.openWidget=openHomeWidget;pub.closeWidgets=closeHomeWidgets;}
setWidgetShowHideClickHandler_on();hideAirportLookup();pub.showMyDelta=showMyDelta;pub.adjustWidgetHeight=adjustWidgetHeight;pub.isDockedState=isDockedState;pub.isWidgetInitialized=isWidgetInitialized;pub.initializeWidget=initializeWidget;pub.forceOpen=forceOpen;pub.isOpenByDefault=isOpenByDefault;return pub;})(jQuery);delta.navwidget.init();
(function($){$.fn.loginToolTip=function(options){var defaults={closeTipBtn:'loginToolTipCloseBtn',toolTipId:'loginToolTip',fixed:false,clickIt:false,inSpeed:200,outSpeed:100,tipContent:'',toolTipClass:'logindefaultTheme',xOffset:5,yOffset:3,onShow:null,onHide:null},settings=$.extend({},defaults,options);return this.each(function(){var obj=$(this);if(obj.attr('title')){var tipContent=obj.attr('title');}else{var tipContent=settings.tipContent;}
var buildloginToolTip=function(){$('body').append("<div id='"+settings.toolTipId+"' class='"+settings.toolTipClass+"'><div class='loginToolTipCloseDiv'></div><div class='loginToolTipContent'>"+tipContent+"</div></div>");if(tipContent){$('#'+settings.toolTipId+' .loginToolTipCloseDiv').append("<a id='"+settings.closeTipBtn+"' href='#' alt='close'>close</a>");}},positionloginToolTip=function(){$('#'+settings.toolTipId).css({top:(obj.offset().top-$('#'+settings.toolTipId).outerHeight()-settings.yOffset)+'px',left:(obj.offset().left+(obj.outerWidth()/2))+'px'}).stop().fadeIn(settings.inSpeed,function(){if($.isFunction(settings.onShow)){settings.onShow(obj);}});},removeloginToolTip=function(){$('#'+settings.toolTipId).stop().fadeOut(settings.outSpeed,function(){$(this).remove();if($.isFunction(settings.onHide)){settings.onHide(obj);}});};if(tipContent&&!settings.clickIt){obj.hover(function(){$('#'+settings.toolTipId).remove();obj.attr({title:''});buildloginToolTip();positionloginToolTip();},function(){$('#'+settings.closeTipBtn).click(function(){removeloginToolTip();return false;});});}
if(tipContent&&settings.clickIt){$('#'+settings.toolTipId).remove();obj.attr({title:''});obj.click(function(el){$('#'+settings.toolTipId).remove();obj.attr({title:''});buildloginToolTip();positionloginToolTip();$('#'+settings.closeTipBtn).click(function(){removeloginToolTip();return false;});return false;});}
if(!settings.fixed&&!settings.clickIt){obj.mousemove(function(el){$('#'+settings.toolTipId).css({top:(el.pageY-$('#'+settings.toolTipId).outerHeight()-settings.yOffset),left:(el.pageX+settings.xOffset)});});}});};})(jQuery);(function($){$.fn.overlabel=function(options){var opts=$.extend({},$.fn.overlabel.defaults,options);var selection=this.filter("label[for]").map(function(){var label=$(this);var id=label.attr("for");var field=document.getElementById(id);if(!field)return;var o=$.meta?$.extend({},opts,label.data()):opts;label.addClass(o.label_class);var hide_label=function(){label.css(o.hide_css)};var show_label=function(){this.value||label.css(o.show_css)};$(field).parent().addClass(o.wrapper_class).end().focus(hide_label).blur(show_label).each(hide_label).each(show_label)
return this;});return opts.filter?selection:selection.end();};$.fn.overlabel.defaults={label_class:"overlabel-apply",wrapper_class:"overlabel-wrapper",hide_css:{"display":"none"},show_css:{"display":"block","cursor":"text"},filter:false};})(jQuery);delta.LoginWidgetValidation={errorCode:function(message){try{var msg="";msg="<div class=\"errImg\"></div><div class=\"errMsg\">"+message+"</div>";return msg;}catch(error){if(delta.LoginWidget.isDebugEnabled==true){DeltaUtils.logMessage("Exception at errorCode Method Login");}}},trimLeadTrailSpaces:function(s){s=s.replace(/(^\s*)|(\s*$)/gi,"");s=s.replace(/[ ]{2,}/gi," ");s=s.replace(/\n /,"\n");return s;},getpassword:function(section){var value=$("#pwd"+section).val();value=DeltaUtils.stripBadChars(value);varUsername=delta.LoginWidgetValidation.trimLeadTrailSpaces($("#usernm"+section).val());$("#usernm"+section).val(varUsername);varLen=$("#usernm"+section).val().length;var setpwdFlag;if(value.length<4||value.length>20){setpwdFlag=false;}else{if(value.length<5&&value.match(/^[\d]{4}/)){if(value.length==4){if(varUsername.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i)){$("#passwordType"+section).val("PIN");setpwdFlag=true;}else if(varUsername.match(/^[\d]{9,12}$/)){$("#passwordType"+section).val("PIN");setpwdFlag=true;}else if(isNaN(varUsername)&&varUsername.match(/^[a-zA-Z0-9]*(?!\s)+$/)){jQuery.validator.messages.loginCheck=delta.LoginWidgetValidation.errorCode('Please use password when logging in with your Username or you may also login using your SkyMiles number or email address.');setpwdFlag=false;}}}else if(value.length>5&&value.match(/^[a-zA-Z0-9]+$/)&&!value.match(eval('/^([a-zA-Z0-9])\\1{'+(value.length-1)+'}$/'))){$("#passwordType"+section).val("PW");setpwdFlag=true;}}
return setpwdFlag;}};jQuery.validator.messages.loginCheck=delta.LoginWidgetValidation.errorCode('Please enter valid login credentials to continue.');jQuery.validator.classRuleSettings.loginCheck={loginCheck:true};jQuery.validator.addMethod("loginCheck",function(value,element,param){value=delta.LoginWidgetValidation.trimLeadTrailSpaces(value);value=$.trim(value);getPwdFlag=delta.LoginWidgetValidation.getpassword(param);if((value.length<6||value.length>132||getPwdFlag==false)){return false;}else{var isEmail=value.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i);var isUserName=value.match(/^[a-zA-Z0-9]*(?!\s)+$/)&&isNaN(value);var isSMOnly=((typeof isSMLoginOnly=='undefined')||isSMLoginOnly=="true");var isEmailDisabled=((typeof isEmailLoginEnabled=='undefined')||isEmailLoginEnabled=="false");jQuery.validator.messages.loginCheck=delta.LoginWidgetValidation.errorCode('Please enter valid login credentials to continue.');if((isEmail||isUserName)&&isSMOnly){jQuery.validator.messages.loginCheck=delta.LoginWidgetValidation.errorCode('Please use your SkyMiles number to log in. Username and email address cannot be used for login at this time.');}else if(isEmail&&isEmailDisabled){jQuery.validator.messages.loginCheck=delta.LoginWidgetValidation.errorCode('Please use your SkyMiles number or username to log in. Email address cannot be used for login at this time.');}
if(value.match(/^[\d]{9,12}$/)&&getPwdFlag==true){$(".usernameType").val("skymiles");return true;}
else if(value.match(/^[a-zA-Z0-9]*(?!\s)+$/)&&!isSMOnly){if(isNaN(value)&&getPwdFlag==true){$(".usernameType").val("username");return true;}else{return false;}}
else if(value.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i)&&getPwdFlag==true&&!isSMOnly&&!isEmailDisabled){$(".usernameType").val("email");return true;}}
return false;},jQuery.validator.messages.loginCheck);jQuery.validator.messages.passwordCheck=delta.LoginWidgetValidation.errorCode('Please enter valid login credentials to continue.');jQuery.validator.classRuleSettings.passwordCheck={passwordCheck:true};jQuery.validator.addMethod("passwordCheck",function(value,element,param){value=DeltaUtils.removeSpaces(value);value=DeltaUtils.stripBadChars(value);varUsername=DeltaUtils.removeSpaces($('#usernm').val());varLen=$('#usernm').val().length;var width=$("#login").width()+$("#errorDiv").width();if(value==""||value.length<4||value.length>20){return false;}else{if(value.match(/^[\d]{4}/)){if(value.length==4){if(varUsername.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i)){$("#passwordType").val("PIN");return true;}else if(varUsername.match(/^[\d]{9,12}$/)){$("#passwordType").val("PIN");return true;}else if(varUsername.match(/^[a-zA-Z0-9]*(?!\s)+$/)){return false;}}}else if(value.length>5&&value.match(/^[a-zA-Z0-9]+$/)&&!value.match(eval('/^([a-zA-Z0-9])\\1{'+(value.length-1)+'}$/'))){$("#passwordType").val("PW");return true;}}
return false;},jQuery.validator.messages.passwordCheck);jQuery.validator.messages.createPassword="A valid password must be 6-20 alphanumeric characters.";jQuery.validator.classRuleSettings.createPassword={createPassword:true};jQuery.validator.addMethod("createPassword",function(value,element,param){if(value==""||value.length<6||value.length>20||value.match(eval('/^(\\w)\\1{'+(value.length-1)+'}$/'))){return false;}else if(value.match(/^.*(?=.*[a-zA-Z0-9])^((?![\s!@#$%^&*()\-_+=<>.?\/\`\~:;\[\],"']).)*$/)){return true;}
return false;},jQuery.validator.messages.createPassword);jQuery.validator.messages.createUsername="A valid username must be a minimum of 6 characters.";jQuery.validator.classRuleSettings.createUsername={createUsername:true};jQuery.validator.addMethod("createUsername",function(value,element,param){if(value==""||value.length<6||value.match(eval('/^(\\w)\\1{'+(value.length-1)+'}$/'))){return false;}else if(value.match(/^.*(?=.*[a-zA-Z0-9])^((?![\s!@#$%^&*()\-_+=<>.?\/\`\~:;\[\],"']).)*$/)){return true;}
return false;},jQuery.validator.messages.createUsername);jQuery.validator.messages.comparePassword="The password you've entered does not match. Please try again.";jQuery.validator.classRuleSettings.comparePassword={comparePassword:true};jQuery.validator.addMethod("comparePassword",function(value,element,param){var newPwd=$("#newPassword").val();var confirmPwd=$("#newConfirmPassword").val();if(newPwd!=confirmPwd){return false;}else{return true;}
return false;},jQuery.validator.messages.comparePassword);jQuery.validator.messages.chkAnswer=delta.LoginWidgetValidation.errorCode('Please enter a valid answer for question 1.');jQuery.validator.classRuleSettings.chkAnswer={chkAnswer:true};jQuery.validator.addMethod("chkAnswer",function(value,element,param){value=DeltaUtils.removeSpaces(value);value=DeltaUtils.stripBadChars(value);var answerNo,eleName;eleName=element.name;if(eleName.indexOf("answer1")>=0){answerNo=" 1";}else if(eleName.indexOf("answer2")>=0){answerNo=" 2";}
if(value==""||value.length<4){jQuery.validator.messages.chkAnswer=delta.LoginWidgetValidation.errorCode('Please enter a valid answer for question'+answerNo+'.');return false;}else
if(value.length>50){jQuery.validator.messages.chkAnswer=delta.LoginWidgetValidation.errorCode('Security answers can not be more than 50 characters.');return false;}else{if(value.match(/^([a-zA-Z\d][a-zA-Z\d\-\.\s]*|)$/)&&value.length<50){return true;}else
{jQuery.validator.messages.chkAnswer=delta.LoginWidgetValidation.errorCode('Please enter a valid answer for question'+answerNo+'.');return false;}}},jQuery.validator.messages.chkAnswer);jQuery.validator.messages.checkSameAnswer=delta.LoginWidgetValidation.errorCode("The answer you've provided has already been used. Please provide a unique answer for each question.");jQuery.validator.classRuleSettings.checkSameAnswer={checkSameAnswer:true};jQuery.validator.addMethod("checkSameAnswer",function(value,element,param){var secAnswer1=document.getElementById("answer1").value;var secAnswer2=document.getElementById("answer2").value;if(secAnswer1.length>1&&secAnswer2.length>1){if(secAnswer1===secAnswer2){return false;}else{return true;}}
return false;},jQuery.validator.messages.checkSameAnswer);jQuery.validator.messages.chkQuestion=delta.LoginWidgetValidation.errorCode('Please select security question to continue.');jQuery.validator.classRuleSettings.chkQuestion={chkQuestion:true};jQuery.validator.addMethod("chkQuestion",function(value,element,param){value=DeltaUtils.removeSpaces(value);value=DeltaUtils.stripBadChars(value);var questionNo,eleName;eleName=element.name;if(eleName.indexOf("question1")>=0){questionNo=" 1 ";}else if(eleName.indexOf("question2")>=0){questionNo=" 2 ";}
if(value==""||value.length<1||value==null){jQuery.validator.messages.chkQuestion=delta.LoginWidgetValidation.errorCode('Please select security question'+questionNo+'to continue.');return false;}else{return true;}
return false;},jQuery.validator.messages.chkQuestion);jQuery.validator.messages.compareEmail=delta.LoginWidgetValidation.errorCode("The email addresses you've entered don't match. Please try again.");jQuery.validator.classRuleSettings.compareEmail={compareEmail:true};jQuery.validator.addMethod("compareEmail",function(value,element,param){value=DeltaUtils.removeSpaces(value);value=DeltaUtils.stripBadChars(value);var email1=$("#login_email").val();var email2=$("#login_confirmEmail").val();if(email1!=email2){return false;}else{return true;}
return false;},jQuery.validator.messages.compareEmail);jQuery.validator.messages.chkEmailId=delta.LoginWidgetValidation.errorCode("Please enter a valid email to continue.");jQuery.validator.classRuleSettings.chkEmailId={chkEmailId:true};jQuery.validator.addMethod("chkEmailId",function(value,element,param){value=DeltaUtils.removeSpaces(value);value=DeltaUtils.stripBadChars(value);if(value.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i)){return true;}else{return false;}return false;},jQuery.validator.messages.chkEmailId);jQuery.validator.messages.lastname=delta.LoginWidgetValidation.errorCode("Please enter a valid last name to continue.");jQuery.validator.classRuleSettings.lastname={lastname:true};jQuery.validator.addMethod("lastname",function(value,element,param){value=DeltaUtils.stripBadChars(value);if(value==""||value.length<1||value.length>40)
{return false;}
else{if(value.match(/^([a-zA-Z][a-zA-Z\-\'\s]*|)$/)){jQuery.validator.messages.lastname=delta.LoginWidgetValidation.errorCode('Please enter valid login credentials to continue.');return jQuery.validator.methods.loginCheck.call(this,$("#usernm"+param).val(),$("#usernm"+param).get(),param);}else{return false;}}},jQuery.validator.messages.lastname);var delta=window.delta||{};delta.LoginWidget={dockedMainDivId:'#loginwidget.bottomNav ',formSubmitted:null,headerMainDivId:'#loginwidgetHeader ',homeMainDivId:'#loginwidget.homepage ',loginPageMainDivId:'#loginwidgetLoginPage ',loginPwdDialogContent:'Your password is a secure way to access your My Delta account. When creating a password, you may use a combination of letters and numbers, with at least one number and one upper case letter required. Your password must be 6-20 characters long and cannot be a SkyMiles number, email address or username.',loginSec:"",loginSQADialogContent:'Please answer your security questions to establish a new password.',mainDivId:"",modalSecurityQuestionContent:'Create security Questions <a class=\"tooltip\" id=\"help1\"><img src=\"/custlogin/images/helpBlue.png\" alt=\"help icon\" class=\"sqa\" id=\"loginSQATooltipclick\" /></a>',isDebugEnabled:true,isHomePage:DeltaUtils.isHomePage(),isInitialized:false,spanArrowImg:'<span class="arrowImg"/>',timerLastName:null,hasPasswordSession:null,isCutoverPhase:null,addCommas:function(nStr){nStr+='';x1=nStr;var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1;},calculatePosition:function(elm){try{if($("#nav-widget-container")){var getBottomPos=$("#nav-widget-container").height();$(delta.LoginWidget.mainDivId+elm).css("bottom",getBottomPos);}else{var topCorner=$(delta.LoginWidget.mainDivId+"#login").position(),topCornerPosition=$(delta.LoginWidget.mainDivId+"#login").offset(),popupHeight=$(delta.LoginWidget.mainDivId+elm).height(),popupPositionTop=topCorner.top-popupHeight,popupPositionLeft=topCorner.left;$(delta.LoginWidget.mainDivId+elm).offset({top:popupPositionTop});}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in calculatePosition=> "+error);}}},callbackDashBoard:function(loggedInData){try{var loggedInFlag=CustomerInfo.isLoggedIn();if(loggedInFlag!=null&&loggedInFlag==true){try{if(delta.LoginWidget.loginSec==""){delta.LoginWidget.getLoggedInDataCallback(loggedInData);try{DeltaUtils.refreshloginTimeout();}catch(e){}}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callbackDashBoard(loggedIn)=> "+error);}}}else if(loggedInFlag!=null&&loggedInFlag==false){try{delta.LoginWidget.doModals();var mainDivId=delta.LoginWidget.mainDivId;var section=delta.LoginWidget.loginSec;var smNumber=CustomerInfo.getSkyMilesNumber();if(smNumber!=undefined&&smNumber!=null&&smNumber!="null"&&smNumber!=""){$(mainDivId+"#loginForm"+section).find("input[name=usernm]").val(smNumber);$(mainDivId+"#lblUser_Nm"+section).css("display","none");}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callbackDashBoard(NotloggedIn)=> "+error);}}}else{setOmnitureProp("logged out");return false;}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callbackDashBoard=> "+error);}}},callDialogModal:function(title,width,url,prevModal){try{if(delta.LoginWidget.loginSec==""||delta.LoginWidget.loginSec=="_LoginPage"){var dialogOpts={autoOpen:false,title:title,width:width,resizable:false,draggable:false,modal:true,minHeight:50};var isFooterWarningPhaseLogin=true;if(url.indexOf("cpwd.action")!=-1&&delta.LoginWidget.loginSec==""&&CustomerInfo.getSkyMilesNumber()!=undefined&&CustomerInfo.getSkyMilesNumber()!=null&&CustomerInfo.getSkyMilesNumber()!=""){isFooterWarningPhaseLogin=false;}
if(url.indexOf("cpwd.action")==-1){if($.browser.chrome!=undefined&&$.browser.chrome){dialogOpts.position=['middle',30];}}
$("#loginDlg").bind("dialogclose",function(event,ui){if($("#cpwdForm").length>0){document.cpwdForm.submit();}});if(isFooterWarningPhaseLogin){$("#loginDlg").load(url,function(){$("#loginDlg").dialog(dialogOpts).dialog("open");if(delta.LoginWidget.hasPasswordSession!=undefined&&delta.LoginWidget.hasPasswordSession!=null){if(!delta.LoginWidget.hasPasswordSession){if(!delta.LoginWidget.isCutoverPhase){$(".ui-dialog").addClass("createPwdDlgWidth");$("div.createPwdDlgWidth div.ui-dialog-titlebar span#ui-dialog-title-loginDlg").html("Please Create a Password");$("div.createPwdDlgWidth").find('button#createPwdNow').first().blur();}else{$(".ui-dialog").addClass("createCutoverPwdDlgWidth");$("div.createCutoverPwdDlgWidth div.ui-dialog-titlebar span#ui-dialog-title-loginDlg").html("Please Create a Password");$("div.createCutoverPwdDlgWidth").find('button#createPwdNow').first().blur();}}else{$(".ui-dialog").addClass("createPinPwdDlgWidth");$("div.createPinPwdDlgWidth").find('button#resetPwdNow').first().blur();}
delta.LoginWidget.hasPasswordSession=null;}
$('#loginCPWDTooltipclick').loginToolTip({clickIt:true,tipContent:delta.LoginWidget.loginPwdDialogContent,closeTipBtn:'loginToolTipCloseBtn'});$('#loginSQATooltipclick').loginToolTip({clickIt:true,tipContent:delta.LoginWidget.loginSQADialogContent,closeTipBtn:'loginToolTipCloseBtn'});var strPath=url.indexOf("custlogin/sqa.action");if(strPath!==-1){delta.LoginWidget.loadSQADropDowns();}
DeltaUtils.initButtons();delta.LoginWidget.chkError("","","modal");delta.LoginWidget.handleRequiredClickEvents(url,prevModal);});}}
else if(delta.LoginWidget.loginSec=="_Header"&&CustomerInfo.getSkyMilesNumber()!=undefined&&CustomerInfo.getSkyMilesNumber()!=null&&CustomerInfo.getSkyMilesNumber()!=""){if(url.indexOf("cpwd.action")!=-1){$("#loginDlg").bind("dialogclose",function(event,ui){if($("#cpwdForm").length>0){document.cpwdForm.submit();}});$("#loginDlg").load(url,function(){$("#loginDlg").dialog(dialogOpts).dialog("open");DeltaUtils.initButtons();delta.LoginWidget.chkError("","","modal");delta.LoginWidget.handleRequiredClickEvents(url,prevModal);});}}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callDialogModal=> "+error);}}},callNotMeAction:function(){try{$.ajax({url:"/custlogin/notMe.action",type:'POST',headers:{"cache-control":"no-cache"},dataType:"json",success:function(res){delta.LoginWidget.doNotMeSuccess("");if(!delta.LoginWidget.isHomePage){if($("#loginwidgetHeader").length){delta.LoginWidget.doNotMeSuccess("_Header");}
if($("#loginwidgetLoginPage").length){delta.LoginWidget.doNotMeSuccess("_LoginPage");}}
CustomerInfo.custData.rememberMeIndicator=false;}});}
catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callNotMeAction=> "+error);}}},callRememberMe:function(dataObj){try{var section=delta.LoginWidget.loginSec;var mainDivId=delta.LoginWidget.mainDivId;var userName,usernameVal,lastNameVal,userFullName="<span>Welcome back,</span> ";if(dataObj=="readCust"){userFullName+=(CustomerInfo.getPreferredName()==null)?CustomerInfo.getRememberMeFirstName():CustomerInfo.getPreferredName();usernameVal=CustomerInfo.getRememberMeId();lastNameVal=CustomerInfo.getRememberMeLastName();}else{userFullName+=(dataObj.preferredName==null)?dataObj.rememberMeFirstName:dataObj.preferredName;usernameVal=loginData.rememberMeID;lastNameVal=loginData.rememberMeLastName;}
var isSM=usernameVal.match(/^[\d]{9,12}$/);if(isSM||((typeof isSMLoginOnly!='undefined')&&isSMLoginOnly=="false")){userFullName+="<span>!</span>  ";$(mainDivId+".showLoginLinks").hide();$(mainDivId+".notMe").html(userFullName);$(mainDivId+".showNotMe").show();$("#lblUser_Nm"+section+",#lblLst_Nm"+section).hide();$("#usernm"+section).val(usernameVal);$("#lastname"+section).val(lastNameVal);$(mainDivId+".remember_me").attr("checked",true);}else{delta.LoginWidget.callNotMeAction();}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callRememberMe=> "+error);}}},callHomePageLogin:function(passWidth){$(delta.LoginWidget.homeMainDivId+" #login").animate({"width":passWidth});},checkFormPostURL:function(){var currentHostServer=window.location.hostname;var section=delta.LoginWidget.loginSec;if(currentHostServer!=loginHostServer){if(currentHostServer.indexOf("delta.com")>=0||currentHostServer.indexOf("localhost")>=0){document.forms['lastNameForm'+section].action="https://"+currentHostServer+"/custlogin/login.action";}}},checkIropStatus:function(){$.ajax({url:"/custlogin/getMoreInfo.action",type:'POST',headers:{"cache-control":"no-cache"},cache:false,dataType:"json",success:function(loginInfo){if(loginInfo.irop&&!delta.LoginWidget.isHomePage){$("#irop-indicator").show();}}});},checkPasswd:function(mainDivId,section){var passwordCheckTimer=setInterval(checkPassword,200);function checkPassword(){if($(mainDivId+"#pwd"+section).val().length>0){$(mainDivId+".fixMe").hide();clearInterval(passwordCheckTimer);}}},chkError:function(hasError,errorCd,whereToDisplay){try{var getErrorFile=delta.LoginWidget.getLoginAbsPath();var getErrorFilePath=getErrorFile+"errors/custlogin/";if(whereToDisplay==="modal"){hasError=CustomerInfo.hasError();errorCd=CustomerInfo.getErrorCode();if(hasError==true){delta.LoginWidget.errorCount(errorCd,"#javaError",getErrorFilePath,whereToDisplay);}else{$(".errorDivJavaError1").addClass("hideMe").removeClass("showMe");}}else if(whereToDisplay==="topLogin"){if(hasError==true){var mainDivId=delta.LoginWidget.mainDivId;if(!delta.LoginWidget.isHomePage&&delta.LoginWidget.loginSec==""){delta.LoginWidget.errorCount(errorCd,mainDivId+".javaErr",getErrorFilePath,whereToDisplay);}else{delta.LoginWidget.errorCount(errorCd,mainDivId+".errorDivJavaError1",getErrorFilePath,whereToDisplay);}}else{$(".errorDivJavaError1").addClass("hideMe").removeClass("showMe");}}else{return false;}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in chkError=> "+error);}}},createErrorNotification:function(){try{$("#login-content-errors").html($(delta.LoginWidget.mainDivId+"#loginErrorContainer").html());$("#login-content").css({position:"fixed",bottom:"70px",left:$("#nav-widget-user").offset().left+"px",display:"block",zIndex:10000});$("#login-content #login-content-errors *").show('slow',function(){});$("#login-content #login-content-lastname").hide();}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in createErrorNotification=> "+error);}}},createLastNameNotification:function(lastNameRequired){try{$("#login-content-lastname").html($("#lastNmForm").html());var isRememberMeCust=false;var lastNameLbl=$("#login-content-lastname .overlabel"),lastNameIp=$("#login-content-lastname input[name=lastname]");if((typeof loginData!='undefined')&&(loginData!=null)){if(loginData.rememberMeIndicator==true){lastNameLbl.hide();lastNameIp.val(loginData.rememberMeLastName);isRememberMeCust=true;}else{lastNameIp.val("");lastNameLbl.overlabel();}}else if(CustomerInfo.getRememberMeIndicator()==true){lastNameLbl.hide();lastNameIp.val(CustomerInfo.getRememberMeLastName());isRememberMeCust=true;}
if(isRememberMeCust&&!lastNameRequired){delta.LoginWidget.finalFormSubmit("#loginwidget.bottomNav ",'#lastNameForm',"");return true;}else{$("#loginwidget.bottomNav #submit-1").hide();}
$("#login-content").css({position:"fixed",bottom:"70px",left:$("#nav-widget-user").offset().left+"px",display:"block",zIndex:10000});$("#login-content #login-content-lastname *").show("slow",function(){$("#login-content-lastname").css("display","block");if(isRememberMeCust){lastNameLbl.hide();}});$("#login-content #login-content-errors *").hide();$("#login-content #login-content-errors").hide();$("#login-content-lastname .lastNameDiv #loginnavlst").html("Enter Last Name");lastNameLbl.click(function(){lastNameLbl.hide();lastNameIp.focus();});lastNameIp.focus(function(){lastNameLbl.hide();}).blur(function(){if(lastNameIp.val()==""){lastNameLbl.show();}});}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in createLastNameNotification=> "+error);}}},displayLoginData:function(loggedInData){try{var section=delta.LoginWidget.loginSec;$("#loggedIn").html($("#_displayLoggedInfo_tmpl").render(loggedInData));if(delta.LoginWidget.isHomePage){$('#loggedIn').removeClass("bottomNav").addClass("homepage");if(loggedInData!=undefined&&loggedInData.displayPwdWarning){$("#createPassWordWarningDiv").show();$("#closeImage").live("click",function(){$.ajax({url:'/custlogin/getDashBrdData.action',type:'POST',cache:false,dataType:"json",data:{updateWarningMsgInd:"Y"},success:function(data){}});$("#createPassWordWarningDiv").hide();});}else if(loggedInData==undefined&&loginData!=undefined&&loginData.displayPwdWarning){$("#createPassWordWarningDiv").show();$("#closeImage").live("click",function(){$.ajax({url:'/custlogin/getDashBrdData.action',type:'POST',cache:false,dataType:"json",data:{updateWarningMsgInd:"Y"},success:function(data){}});$("#createPassWordWarningDiv").hide();});}
try{if($('#userMedalLevel').length>0){$(".logoutInner").width(388);if($("#createPassWordWarningDiv").css("display")!="none"){$("#createPassWordWarningDiv").addClass("userMedalLevelWarningDiv");}}else{$(".logoutInner").width(314);}}catch(error){}}else{$('#loggedIn').removeClass("homepage").addClass("bottomNav");$("#loggedIn.bottomNav").css("display","block");delta.LoginWidget.showHeaderLoggedIn(true);$("#header_logout").attr("href","/custlogin/logout.action");}
$(".loggedout").addClass("hideMe").removeClass("showMe");$(".loggedin").removeClass("hideMe").addClass("showMe");var os=(function(){var ua=navigator.userAgent.toLowerCase();return{isWin2K:/windows nt 5.0/.test(ua),isXP:/windows nt 5.1/.test(ua),isVista:/windows nt 6.0/.test(ua),isWin7:/windows nt 6.1/.test(ua),isChrome:/ chrome/.test(ua),isFirefox:/ firefox/.test(ua),isIE:/ msie/.test(ua),isSafari:/ safari/.test(ua)};}());if((os.isWin7&&os.isSafari)||(os.isWin7&&os.isFirefox)||(os.isWin7&&os.isSafari)==true){$("#loggedIn"+section+" .my-profile-link").css('width','54px');}
if((os.isWin7&&os.isChrome)||(os.isWin7&&os.isFirefox)||(os.isWin7&&os.isSafari)==true){$('div .fltLeft .sample .notPref .rightSpace10').css('width','366px');$('fieldset .fltLeft .sub_container_profile .clrBoth .ssinfoSection .roundContainer').css('width','364px');$('div .BotInner div .middle').css('width','350px');}
var logoutLinkWidth=$(".logout-lnk").outerWidth();var lastNameWidth=$(".custlogin_userInfo").outerWidth();var surplasWidth=logoutLinkWidth-51;if(logoutLinkWidth>51){surplasWidth=lastNameWidth-surplasWidth;$(".custlogin_userInfo").css({"width":surplasWidth+"px","line-height":"17px"});}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in displayLoginData=> "+error);}}},doBrowserStuff:function(){var browserVer="";if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){browserVer="ipad";}else if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var ieVer=new Number(RegExp.$1);browserVer="ie"+ieVer;}
$("body").addClass(browserVer);},doModals:function(){var hasError=CustomerInfo.hasError();var hasPw=CustomerInfo.hasPassword();var hasSqa=CustomerInfo.hasSQA();var hasEmail=CustomerInfo.hasEmail();var errorCd=CustomerInfo.getErrorCode();var hasUserNm=null;if(CustomerInfo.custData!=null&&typeof(CustomerInfo.custData.hasUserNm)!="undefined"){hasUserNm=CustomerInfo.custData.hasUserNm;}
var rememberMeIndicator=CustomerInfo.getRememberMeIndicator();var errorDescription;var setModalPath=delta.LoginWidget.getLoginAbsPath();$("#loginDlg").remove();$("body").append("<div id=\"loginDlg\" />");delta.LoginWidget.showHeaderLoggedIn(false);if(hasPw==false&&hasPw!=null){delta.LoginWidget.callDialogModal("START USING YOUR PASSWORD",505,setModalPath+"cpwd.action","");}else if(hasSqa==false&&hasSqa!=null){delta.LoginWidget.callDialogModal("CREATE SECURITY QUESTIONS",300,setModalPath+"sqa.action","");}else if(hasEmail==false&&hasEmail!=null){delta.LoginWidget.callDialogModal("Update Email ",300,setModalPath+"email.action","");}else if(hasUserNm==false&&hasUserNm!=null){delta.LoginWidget.callDialogModal("UPDATE USERNAME",300,setModalPath+"usrnm.action","");}else if(rememberMeIndicator==true&&rememberMeIndicator!=null){delta.LoginWidget.callRememberMe("readCust");}else{delta.LoginWidget.chkError(hasError,errorCd,"topLogin");}},doNotMeSuccess:function(section){$("#loginnav"+section+" .notMe").text("");$("#loginnav"+section+" .showNotMe").css("display","none");$("#loginnav"+section+" .showLoginLinks").css("display","block");$("#lblUser_Nm"+section+", #lblLst_Nm"+section+", #lblPwd"+section).css("display","block");$("#usernm"+section+", #pwd"+section+", #lastname"+section).val("");$("#login"+section+" .rememberMe").val(false);$("#login"+section+" .remember_me").attr("checked",false);},doRememberMe:function(){var mainDivId=delta.LoginWidget.mainDivId;$(mainDivId+".remember_me").change(function(){($(this).is(":checked"))?$(mainDivId+".rememberMe").val(true):$(mainDivId+".rememberMe").val(false);if(!($(this).is(":checked"))&&CustomerInfo.getRememberMeIndicator()){delta.LoginWidget.callNotMeAction();}});},errorCount:function(errorCd,div,url,loc){try{var section=delta.LoginWidget.loginSec;var submittedLoginForm=CustomerInfo.getFormNameSubmitted();delta.LoginWidget.showHeaderLoggedIn(false);if(submittedLoginForm==null||submittedLoginForm==""){submittedLoginForm="LoginMain";}
if(submittedLoginForm.indexOf("Header")>=0&&section==""&&loc!="modal"){delta.LoginWidget.loadHeaderSection();}
if((section==""&&(submittedLoginForm=="LoginMain"||loc=="modal"))||(section=="_Header"&&submittedLoginForm=="LoginHeader")||(section=="_LoginPage"&&submittedLoginForm=="LoginPage")){var x=errorCd.split(',');var mainDivId=delta.LoginWidget.mainDivId;for(i=0;i<x.length;i++){errorFileName="errorMsg"+x[i]+".html";var templateData=null;var errorClassNm="";if(!delta.LoginWidget.isHomePage&&section==""){errorClassNm="errBotomNav";}else{errorClassNm="error";}
templateData={"ErrorClass":errorClassNm,"ErrorCode":x[i]};$(div).append($("#errorMsgTemplate").render(templateData));if(loc==="topLogin"){var dispType=mainDivId;}else{var dispType=".dlgContainer ";}
$(dispType+"#divErr"+x[i]).load(url+errorFileName,function(){if(loc==="topLogin"){if(delta.LoginWidget.isHomePage){$("#loginErrorContainer"+section).css("display","block");$(mainDivId+".errorDivJavaError1").addClass("showMe").removeClass("hideMe");var loginDivWidth=$(mainDivId+".loginWrapper").width()+$(".errorDivJavaError1").width()+45;delta.LoginWidget.callHomePageLogin(loginDivWidth);}else{if(section==""){delta.LoginWidget.calculatePosition('.errorDivJavaError1');delta.LoginWidget.createErrorNotification();}else{$("#loginErrorContainer"+section).css("display","block");$(mainDivId+".errorDivJavaError1").addClass("showMe").removeClass("hideMe");if($("#javaErrMsgId_Header .errMsg").find(".loginHelpLink1").length>0){$("#remDiv_Header").hide();}}}
$(mainDivId+'#submit-1').show();$(mainDivId+"#loginForm"+section).find("input").val("");$(mainDivId+"label.overlabel").overlabel();$(mainDivId+".remember_me").attr("checked",false);if(!CustomerInfo.isAuthenticated()){$(mainDivId+"#loginForm"+section).find("input[name=usernm]").val(CustomerInfo.getSkyMilesNumber());if(section=="_Header"||mainDivId.trim()=="#loginwidget.bottomNav"){$(mainDivId+"#lblUser_Nm"+section).css("display","none");}}}else{$("#javaError").addClass("showMe").removeClass("hideMe");}});}}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in errorCount=> "+error);}}},finalFormSubmit:function(mainDivId,formName,section){$(formName)[0].formNameSubmitted.value=delta.LoginWidget.getFormNameSubmitted(formName);var fn=DeltaUtils.removeSpaces($(mainDivId+"#usernm"+section).val());var pwd=$(mainDivId+"#pwd"+section).val();if($(formName)[0].username.value==""||$(formName)[0].username.value==null){$(formName)[0].username.value=fn;$(mainDivId+"#loginForm"+section+" .username").val(fn);}
if($(formName)[0].password.value==""||$(formName)[0].password.value==null){$(formName)[0].password.value=pwd;$(mainDivId+"#loginForm"+section+" .password").val(pwd);}
if(typeof loginRefreshURL==='undefined'){if($(formName)[0].refreshURL.value==""||$(formName)[0].refreshURL.value==null){$(formName)[0].refreshURL.value=window.location.href;}else{$(mainDivId+".refreshURL").attr("value",window.location.href);}}else{$(mainDivId+".refreshURL").attr("value",loginRefreshURL);$(formName)[0].refreshURL.value=loginRefreshURL;}
var BAUelement=document.getElementById('custLoginParameter');var BAUForm=document.getElementById('smlogin_login');var BAUParamVal=$("#custLoginParameter").val();if(typeof(BAUForm)!='undefined'&&BAUForm!=null){if(typeof(BAUelement)!='undefined'&&BAUelement!=null){$(mainDivId+".BAUParams").attr("value",$("#custLoginParameter").val());}}
if($(mainDivId+".remember_me").is(":checked")){$(mainDivId+".rememberMe").val(true);}else{$(mainDivId+".rememberMe").val(false);}
var currentHostServer=window.location.hostname;if(currentHostServer!=loginHostServer){if(currentHostServer.indexOf("delta.com")>=0||currentHostServer.indexOf("localhost")>=0){$(formName)[0].action="https://"+currentHostServer+"/custlogin/login.action";}}
if(CustomerInfo!=null&&CustomerInfo.custData!=null&&typeof(CustomerInfo.custData.loggedIn)!="undefined"&&CustomerInfo.custData.loggedIn){return;}
if(formName=="#lastNameForm"+section){if(!delta.LoginWidget.isHomePage&&formName=="#lastNameForm"){if($(mainDivId+".remember_me").is(":checked")){$(mainDivId+".rememberMe").val(true);}else{$(mainDivId+".rememberMe").val(false);}
$("#login-content #lastNameForm").submit();}else{if(formName=="#lastNameForm_LoginPage"){document.lastNameForm_LoginPage.submit();}else if(formName=="#lastNameForm_Header"){document.lastNameForm_Header.submit();}else{document.lastNameForm.submit();}}}else{if(formName==="#loginForm_LoginPage"){document.loginForm_LoginPage.submit();}else if(formName==="#loginForm_Header"){document.loginForm_Header.submit();}else{document.loginForm.submit();}}},getCountryOrLanguageCookie:function(country,language,indicator){try{var cookieSplit="";var jsonLanguage="";var jsonCountry="";var cookieCountry="";var cookieLanguage="";var getCntryLangCookie="";if(country!=null&&country.length>0){jsonCountry=country;}else{jsonCountry="us";}
if(language!=null&&language.length>0){jsonLanguage=language;}else{jsonLanguage="en";}
var getCntryLangCookie=CookieUtils.get("pref");if(getCntryLangCookie===null){getCntryLangCookie="en-us";}
cookieSplit=getCntryLangCookie.split("-");cookieLanguage=cookieSplit[0].toLowerCase();cookieCountry=cookieSplit[1].toLowerCase();getIndFromLocalCookie=CookieUtils.get("lngInd");if(jsonCountry.toLowerCase()!=cookieCountry||jsonLanguage.toLowerCase()!=cookieLanguage){$("#loginDlg").remove();$("body").append("<div id=\"loginDlg\" />");var setModalPath=delta.LoginWidget.getLoginAbsPath();if(indicator==false&&getIndFromLocalCookie==false){if(jsonCountry.toLowerCase()!=cookieCountry){delta.LoginWidget.callDialogModal("Country Settings",300,setModalPath+"countrysettings.action","");}else if(jsonLanguage.toLowerCase()!=cookieLanguage){delta.LoginWidget.callDialogModal("Language Settings",300,setModalPath+"languagesettings.action","");}}}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in getCountryOrLanguageCookie=> "+error);}}},getFormNameSubmitted:function(formName){if(formName.indexOf("Header")>=0){return"LoginHeader";}else if(formName.indexOf("LoginPage")>=0){return"LoginPage";}else{return"LoginMain";}},getLoggedInDataCallback:function(storeLoginDataForDashbrd){try{if(storeLoginDataForDashbrd.skymilesMember=="false"){storeLoginDataForDashbrd.skymilesMember=null;}
if(storeLoginDataForDashbrd.medallionMemberDesc!=null&&storeLoginDataForDashbrd.medallionMemberDesc!=""){if(storeLoginDataForDashbrd.medallionMemberDesc.indexOf("&#174")!==-1){storeLoginDataForDashbrd.medallionMemberDesc(storeLoginDataForDashbrd.medallionMemberDesc.replace('&#174',''));}
if(storeLoginDataForDashbrd.medallionMemberDesc.indexOf("&#174;")!==-1){storeLoginDataForDashbrd.medallionMemberDesc=storeLoginDataForDashbrd.medallionMemberDesc.replace('&#174;','');}}
if(storeLoginDataForDashbrd.smBalance!=null&&storeLoginDataForDashbrd.smBalance!=""){storeLoginDataForDashbrd.smBalance=delta.LoginWidget.addCommas(storeLoginDataForDashbrd.smBalance);}
if(CustomerInfo.getMiddleName()==null){CustomerInfo.setMiddleName(" ");}
delta.LoginWidget.displayLoginData(storeLoginDataForDashbrd);if(delta.LoginWidget.loginSec==""){if(CustomerInfo.getCountry()==null){CustomerInfo.setCountry("us");}
var country=CustomerInfo.getCountry();if(CustomerInfo.getLanguage()==null){CustomerInfo.setLanguage("en");}
var language=CustomerInfo.getLanguage();if(CustomerInfo.getLangPromptIndicator()==null){CustomerInfo.setLangPromptIndicator(false);}
var indicator=CustomerInfo.getLangPromptIndicator();delta.LoginWidget.getCountryOrLanguageCookie(country,language,indicator);}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in getLoggedInDataCallback=> "+error);}}},getLoginAbsPath:function(){try{var absoluteLoginPath="/custlogin/";if(absoluteLoginPath.indexOf("custlogin//")!==-1){absoluteLoginPath=absoluteLoginPath.replace("custlogin//","custlogin/");}
if(absoluteLoginPath.indexOf("//custlogin")!==-1){absoluteLoginPath=absoluteLoginPath.replace("//custlogin","/custlogin");}
return absoluteLoginPath;}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("abs path..");}}},getLoginInfo:function(){try{var section=delta.LoginWidget.loginSec;var mainDivId=delta.LoginWidget.mainDivId;if(((typeof loginData!='undefined')&&(loginData!=null))&&(typeof loginData.loggedIn!='undefined')&&(loginData.loggedIn)){try{if(section==""){CustomerInfo.setData(loginData,"custData");}}catch(error){}
if(section==""){delta.LoginWidget.callbackDashBoard(loginData);$("#loggedIn"+section).removeClass("hideMe");}}else if(((typeof loginData!='undefined')&&(loginData!=null))&&(typeof loginData.loggedIn!='undefined')&&(!loginData.loggedIn)){try{if(section==""){CustomerInfo.setData(loginData,"custData");}}catch(error){}
$(mainDivId).removeClass("hideMe");delta.LoginWidget.showHeaderLoggedIn(false);if(loginData.rememberMeIndicator==true){delta.LoginWidget.callRememberMe(loginData);}}else{if(section==""){delta.LoginWidget.getUserData();}else{delta.LoginWidget.doModals();}}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in getLoginInfo=> "+error);}}},getUserData:function(){try{$.ajax({url:"/custlogin/getDashBrdData.action",type:'POST',headers:{"cache-control":"no-cache"},cache:false,dataType:"json",success:function(logindata){delta.LoginWidget.handleUserData(logindata);}});}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in getUserData=> "+error);}}},handleFancyboxClickEvent:function(mainDivId,section){$(mainDivId+".fancybox").on("click",function(){try{var a;if(!delta.LoginWidget.isHomePage&&section==""){a="#ui-error-holder";}else{a=(mainDivId+".errorDiv");$("#pwd"+section).blur(function(){$("#usernm"+section).valid();});}
delta.LoginWidget.validateLoginForm(a,mainDivId,section);}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in handleFancyboxClickEvent=> "+error);}}});},handleFieldLabels:function(){$("label.overlabel").overlabel().show();},handleLoginFormValidate:function(){var mainDivId=delta.LoginWidget.mainDivId;var section=delta.LoginWidget.loginSec;delta.LoginWidget.handlePwdKeyEvent(mainDivId,section);delta.LoginWidget.handlePwdFocusEvent(mainDivId,section);delta.LoginWidget.handleRememberMeFocusEvent(mainDivId,section);delta.LoginWidget.handleUsernmKeyupEvent(mainDivId,section);delta.LoginWidget.handleUsernmClickEvent(mainDivId,section);delta.LoginWidget.handleUsernmFocusEvent(mainDivId,section);delta.LoginWidget.handleFancyboxClickEvent(mainDivId,section);delta.LoginWidget.lastNameSubmit(mainDivId,section);},handlePwdFocusEvent:function(mainDivId,section){$(mainDivId+"#pwd"+section).focus(function(event){var userName=$(mainDivId+"#usernm"+section).val();var lastNameRequired=delta.LoginWidget.isLastNameRequired(userName);if(!lastNameRequired){if(delta.LoginWidget.isHomePage){delta.LoginWidget.callHomePageLogin('auto');$("#loginErrorContainer .error").hide();}else{if($("#dialog").has("#login-now-close")&&$("#dialog").is(":visible")){$("#dialog").hide();}}}
if(section=="_Header"){$("#remDiv_Header").show();}
$("#loginErrorContainer"+section).hide();$(mainDivId+" .errorDivJavaError1").hide();if($(mainDivId+"#pwd"+section).val().length=="4"){$(mainDivId+"#submit-1"+section).show();$(mainDivId+" .lastNameDiv").hide();$(mainDivId+" .lastNameDiv .error").hide();$(mainDivId+"#lastname"+section).val()=="";if(delta.LoginWidget.isHomePage){var loginWidth=$(mainDivId+"#login").width();delta.LoginWidget.callHomePageLogin('auto');}}
if(!delta.LoginWidget.isHomePage&&section==""&&!lastNameRequired){$("#lastNameForm .lastNameDiv").hide();}});$("#loginwidget.bottomNav #pwd, #loginwidget.bottomNav #usernm").bind("focusout",function(e){$("#login-content .password").val($("#loginwidget.bottomNav #pwd").val());$("#login-content .pwdType").val($(mainDivId+"#passwordType"+section).val());$("#login-content .username").val($("#loginwidget.bottomNav #usernm").val());$("#login-content .usernameType").val($("#loginwidget.bottomNav .usernameType"+section).val());});},handlePwdKeyEvent:function(mainDivId,section){$(mainDivId+"#pwd"+section).keydown(function(event){if((!event.shiftKey&&event.keyCode==9)||event.keyCode==13){if(section==""&&!delta.LoginWidget.isHomePage&&$("#login-content #lastname").is(":visible")){$("#login-content #lastname").focus();return false;}else if($(mainDivId+"#lastname"+section).is(":visible")){$(mainDivId+"#lastname"+section).focus();return false;}}
if(event.keyCode==13){event.preventDefault();$("#submit1"+section).click();}});$(mainDivId+"#pwd"+section).keyup(function(event){var usrName=$(mainDivId+"#usernm"+section).val();var isSM=usrName.match(/^[\d]{9,12}$/);var lastNameRequired=delta.LoginWidget.isLastNameRequired(usrName);if(lastNameRequired||(isSM&&!CustomerInfo.getRememberMeIndicator())){delta.LoginWidget.timerLastName=setTimeout(function(){delta.LoginWidget.showLoginLastNameOnFly(mainDivId,section,lastNameRequired);},10);}});$(mainDivId+"#pwd"+section).bind("keyup mouseup click",function(){if($(mainDivId+"#pwd"+section).val().length>=1){$(mainDivId+"#lblPwd"+section).css("display","none");}else{$(mainDivId+"#lblPwd"+section).css("display","block");}});},handleRememberMeFocusEvent:function(mainDivId,section){$("#loginwidget.bottomNav  .remember_me").change(function(){if($("#loginwidget.bottomNav .remember_me").is(":checked")){$("#login-content .rememberMe").val(true);}else{$("#login-content .rememberMe").val(false);}});},handleRequiredClickEvents:function(url,prevModal){$('#cancelLanguage').live("click",function(){$("#loginDlg").dialog("close");});$("#updateProfile").live("click",function(){try{var customerID=CustomerInfo.getCustomerId();var skymilesNumber=CustomerInfo.getSkyMilesNumber();var getCntryLangCookie=CookieUtils.get("pref");if(getCntryLangCookie===null){getCntryLangCookie="en-us";}
var langCookie=getCntryLangCookie.split("-");var selectedLanguage=langCookie[0].toLowerCase();var countryLagnObj={"customerID":customerID,"skymilesNumber":skymilesNumber,"languageCode":selectedLanguage};delta.LoginWidget.updateProfileContryLang(countryLagnObj);$("#loginDlg").dialog("close");}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in callDialogModal(updateProfile click event)=> "+error);}}});$("#donotaskMe_language, #donotaskMe_country").live("click",function(event,ui){try{var countryLagnObj;var customerID=CustomerInfo.getCustomerId();var skymilesNo=CustomerInfo.getSkyMilesNumber();var lngInd=null;if($("#donotaskMe_language").is(":checked")||$("#donotaskMe_country").is(":checked")){lngInd=true;countryLagnObj={"customerID":customerID,"skymilesNumber":skymilesNo,"promtIndicatorVal":true};}else{lngInd=false;countryLagnObj={"customerID":customerID,"skymilesNumber":skymilesNo,"promtIndicatorVal":false};}
delta.LoginWidget.updateProfileContryLang(countryLagnObj);document.cookie="lngInd"+"="+lngInd;}catch(error){if(delta.LoginWidget.isDebugEnabled==true){if($(this).attr('id')=='donotaskMe_language'){delta.LoginWidget.logMessage("Exception in callDialogModal(donotaskMe_language click event)=> "+error);}else{delta.LoginWidget.logMessage("Exception in callDialogModal(donotaskMe_country click event)=> "+error);}}}});$("#updateCountry").live("click",function(){window.location.href='/profile/index.action';});$('#cancelCountry').live("click",function(){$("#loginDlg").dialog("close");});$('#c_reatePwd').click(function(){$("#submitButton").val("StorePassword");$("#cpwdForm").validate({submitHandler:function(form){document.cpwdForm.submit();},rules:{newPassword:{createPassword:true},newConfirmPassword:{comparePassword:true}},errorClass:"errValidation",errorElement:"div",wrapper:"div"});});$('#c_reateEmail').click(function(){$("#emailForm").validate({submitHandler:function(form){document.emailForm.submit();},rules:{email:{chkEmailId:true},confirmEmail:{chkEmailId:true,compareEmail:true}},errorClass:"errValidation",errorElement:"div",wrapper:"div"});});$('#c_reateSqa').click(function(){$("#sqaForm").validate({submitHandler:function(form){document.sqaForm.submit();},rules:{question1:{chkQuestion:true},answer1:{chkAnswer:true},question2:{chkQuestion:true},answer2:{chkAnswer:true,checkSameAnswer:true}},errorElement:"div",errorClass:"errValidation"});});$('#c_userName').click(function(){$("#cUserName").validate({submitHandler:function(form){document.cUserName.submit();},rules:{newUserName:{createUsername:true}},errorClass:"errValidation",errorElement:"div",wrapper:"div"});});$("#newUserName").keypress(function(){var userNameObj={"userName":$(this).val(),"primaryEmailAddress":true};$.ajax({url:"profile/userNameLookUp.action",type:"POST",data:userNameObj,datatype:"json",headers:{"cache-control":"no-cache"},success:function(result){$("#javaError").empty();if(result.faultDo.status=='FAIL'){var errCd=result.faultDo.error.errorCode;$("#javaError").load("profile/errors/profile/PRF"+errCd+".html").show();}else{if(result.errorMessage=='TRUE'||result.errorMessage=='true'){var errCd="1073";$("#javaError").load("profile/errors/profile/PRF"+errCd+".html").show();}else if(result.errorMessage=='FALSE'||result.errorMessage=='false'){$("#javaError").html("Username available.").show().fadeOut(3000);}}}});});$('#back').click(function(){if(prevModal.indexOf("/custlogin/sqa.action")!==-1){delta.LoginWidget.callDialogModal(delta.LoginWidget.modalSecurityQuestionContent,300,prevModal,"");return false;}else if(prevModal.indexOf("/custlogin/email.action")!==-1){delta.LoginWidget.callDialogModal("Enter Valid Email ",300,prevModal,"");return false;}});$('#continue').click(function(){$("#loginDlg").dialog("close");});$("#asGuest").click(function(){if(delta.LoginWidget.hasPasswordSession)
delta.LoginWidget.setPasswordDialogOmnitureProp("continue as guest","pin to password");else
delta.LoginWidget.setPasswordDialogOmnitureProp("continue without logging In","pin to password");if($("#cpwdForm").length>0){document.cpwdForm.submit();}});$('#remindMeLater,#remindMeLaterEmail').click(function(){var setModalPath1=delta.LoginWidget.getLoginAbsPath();if($(this).attr("id")=="remindMeLaterEmail"){delta.LoginWidget.callDialogModal("SURE YOU WANT TO WAIT?",300,setModalPath1+"rusure.action?flag=email",url);}else{delta.LoginWidget.callDialogModal("SURE YOU WANT TO WAIT?",300,setModalPath1+"rusure.action?flag=sqa",url);}
return false;});$('#remindMeLaterPwd').live("click",function(){$("#submitButton").val("AnswerLater");delta.LoginWidget.setPasswordDialogOmnitureProp("i'll use my password next time","pin to password");$("#loginDlg").dialog("close");document.cpwdForm.submit();});$("#loginDlg #createPwdNow, #loginDlg #resetPwdNow").live("click",function(){if(this.id=="createPwdNow"){delta.LoginWidget.setPasswordDialogOmnitureProp("create password now","pin to password");}else{delta.LoginWidget.setPasswordDialogOmnitureProp("reset password","pin to password");}
document.cpwdForm.action="/custlogin/updatePasswordFromLogin.action";document.cpwdForm.submit();});$("#loginDlg #usePwdNow").live("click",function(){$.post("/custlogin/removeSession.action",function(data){$("#loginDlg #loginHelpPageName").val("");delta.LoginWidget.setPasswordDialogOmnitureProp("login with password","pin to password");document.cpwdForm.action="/custlogin/loginPage.action";document.cpwdForm.submit();});});},handleTemplates:function(){$.views.allowCode=true;$.views.registerTags({isMillionMiler:function(c){if(this.data.millionMiler&&(delta.LoginWidget.isHomePage||delta.LoginWidget.loginSec=="_LoginPage")){var tier=this.data.millionMilerTier;tier=(tier<10&&tier.length<2)?("0"+tier):tier;var templateData={"Tier":tier};var htmlTemplate=$("#memberTypeTemplate").render(templateData);return htmlTemplate;}else{return'';}},isPreferrednamePresent:function(){if(this.data.preferredName==null){return(this.data.firstName+" "+this.data.lastName).toLowerCase();}else{return(this.data.preferredName).toLowerCase();}},myProfileButton:function(){var templateData={"Title":"My Profile"};var htmlTemplate=$("#myProfileLinkTemplate").render(templateData);return(delta.LoginWidget.isHomePage||delta.LoginWidget.loginSec=="_LoginPage")?htmlTemplate:'';}});},handleUserData:function(logindata){if((typeof logindata!="undefined"&&logindata!=null)){if(typeof logindata.sessionexpired!='undefined'||logindata.sessionexpired==true){if(logindata.redirectURL!='undefined'){window.location.replace(logindata.redirectURL);}}else{CustomerInfo.setData(logindata,"custData");delta.LoginWidget.callbackDashBoard(logindata);if(logindata.firstTime){delta.LoginWidget.checkIropStatus();}
if(CustomerInfo.isLoggedIn()==false){$(delta.LoginWidget.mainDivId).removeClass("hideMe");}}}else{$(delta.LoginWidget.mainDivId).removeClass("hideMe");delta.LoginWidget.showHeaderLoggedIn(false);}},handleUsernameValidation:function(mainDivId,usrName,section){var userFlag=false;if(usrName.match(/^[\d]{9,12}$/)){$(mainDivId+".usernameType").val("skymiles");userFlag=true;}else if(usrName.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i)){$(mainDivId+".usernameType").val("email");userFlag=true;}else if(usrName.match(/^[a-zA-Z0-9]*(?!\s)+$/)&&isNaN(usrName)){$(mainDivId+".usernameType").val("username");userFlag=true;}
if(userFlag){if(section=="_Header"){$("#remDiv_Header").show();}
$("#loginErrorContainer"+section).hide();delta.LoginWidget.loginSubmit(mainDivId,section);}},handleUsernmClickEvent:function(mainDivId,section){$(mainDivId+"#usernm"+section).bind("click",function(e){if(!e){var e=window.event;}
var event=e.type;$("#loginErrorContainer"+section).hide();$(mainDivId+" .errorDivJavaError1").hide();$(mainDivId+"#submit-1"+section).show();$(mainDivId+".lastNameDiv").hide();$(mainDivId+".lastNameDiv .error").hide();$(mainDivId+"#lastname"+section).val()=="";if(delta.LoginWidget.isHomePage){delta.LoginWidget.callHomePageLogin('auto');}else{if(section==""){$("#login-content").hide();$("#login-content #login-content-errors").hide();}else if(section=="_Header"){$("#remDiv_Header").show();}}
if(event!=""||event!=null){var valPwd=$(mainDivId+"#pwd"+section).val();if(valPwd!=""&&valPwd!=null){$(mainDivId+".fixMe").css(mainDivId+"display","none");}else{delta.LoginWidget.checkPasswd(mainDivId,section);}}});},handleUsernmKeyupEvent:function(mainDivId,section){$(mainDivId+"#usernm"+section).keyup(function(event){if(event.keyCode==37||event.keyCode==39||event.keyCode==8){return false;}});$(mainDivId+"#usernm"+section).bind("keyup mouseup click",function(){if($(mainDivId+"#usernm"+section).val().length>=1){$(mainDivId+"#lblUser_Nm"+section).css("display","none");}
else{$(mainDivId+"#lblUser_Nm"+section).css("display","block");}});},handleUsernmFocusEvent:function(mainDivId,section){$(mainDivId+"#usernm"+section).bind("focus",function(e){if(!delta.LoginWidget.isHomePage&&$("#dialog").has("#login-now-close")&&$("#dialog").is(":visible")){$("#dialog").hide();}});$(mainDivId+"#usernm"+section).bind("focusout",function(e){var usrName=$(mainDivId+"#usernm"+section).val();var isSM=usrName.match(/^[\d]{9,12}$/);var lastNameRequired=delta.LoginWidget.isLastNameRequired(usrName);if(lastNameRequired||isSM){delta.LoginWidget.showLoginLastNameOnFly(mainDivId,section,lastNameRequired);}});},hideJavaError:function(){$(".errorDivJavaError1 .ui-dialog-titlebar-close span").live("click",function(){$("#login-content #login-content-errors *").hide();});$(".backendErrDiv-cross").live("click",function(){$("#login-content #login-content-errors *").hide();});},hideOverLabel:function(section){$(window).load(function(){try{if(navigator.userAgent.toLowerCase().match("chrome")){if($("#usernm"+section+":-webkit-autofill").length>0){$("#lblUser_Nm"+section).hide();}
if($("#pwd"+section+":-webkit-autofill").length>0){$("#lblPwd"+section).hide();}
if($("#lastname"+section+":-webkit-autofill").length>0){$("#lblLst_Nm"+section).hide();}}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in hideOverLabel=> "+error);}}});},init:function(loginSection){delta.LoginWidget.loginSec=loginSection;delta.LoginWidget.setMainDivId();if(loginSection==""&&!delta.LoginWidget.isHomePage){$("#header_login").append(delta.LoginWidget.spanArrowImg);}
if(loginSection=="_Header"){delta.LoginWidget.showHeaderSection();}
if(loginSection==""||loginSection=="_LoginPage"){delta.LoginWidget.handleTemplates();}
if(loginSection==""){delta.LoginWidget.handleFieldLabels();}
delta.LoginWidget.doRememberMe();delta.LoginWidget.checkFormPostURL();delta.LoginWidget.getLoginInfo();delta.LoginWidget.handleLoginFormValidate();delta.LoginWidget.notMe();if(loginSection==""){if(delta.LoginWidget.isHomePage){$("#loginForm #homePg").val("homePg");$("#lastNameForm #homePg").val("homePg");}
delta.LoginWidget.hideJavaError();delta.LoginWidget.doBrowserStuff();delta.LoginWidget.setFocus();delta.LoginWidget.loginTooltip();delta.LoginWidget.setLoggedInStatus();}
delta.LoginWidget.loginHelp();delta.LoginWidget.hideOverLabel(loginSection);},isLastNameRequired:function(usrName){var isEmail=usrName.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i);var isUserName=usrName.match(/^[a-zA-Z0-9]*(?!\s)+$/)&&isNaN(usrName);var isEmailEnabled=isEmail&&(typeof isEmailLoginEnabled!='undefined')&&isEmailLoginEnabled=="true";var isLastNmReqUserNm=isUserName&&((typeof isUserNameWithLastName=="undefined")||isUserNameWithLastName=="true");var lastNameRequired=(isEmailEnabled||isLastNmReqUserNm)&&(typeof isSMLoginOnly!='undefined')&&isSMLoginOnly=="false";return lastNameRequired;},lastNameSubmit:function(mainDivId,section){$("#login-content").on('submit',"#lastNameForm",function(e){if(CustomerInfo!=null&&CustomerInfo.custData!=null&&typeof(CustomerInfo.custData.loggedIn)!="undefined"&&CustomerInfo.custData.loggedIn){e.preventDefault();}});$("#lastname"+section).keypress(function(e){if(e.keyCode==13){e.preventDefault();$("#lastnameSubmitBtn"+section).click();}});$("#lastnameSubmitBtn"+section).live("click",function(){try{var lastNameDisPos;if(!delta.LoginWidget.isHomePage&&section==""){lastNameDisPos="#login-content-lastname"+" .loginPindetected .errorLstRqd";}else{lastNameDisPos=(mainDivId+" .loginPindetected .errorLstRqd");}
delta.LoginWidget.validateLastNameForm(mainDivId,section,lastNameDisPos);}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in lastNameSubmit=> "+error);}}});},showHeaderSection:function(){$("#loginHeaderDlg").fadeToggle();$("#loginwidgetHeader label.overlabel").overlabel();$(document).mousedown(function(e){var headerLoginNav=$("#header_login").children();if($(e.target).parents('#loginHeaderDlg').length<=0&&!headerLoginNav.is(e.target)&&!($("#loginwidgetHeader .error").is(":visible"))){$('#loginHeaderDlg').hide();$("#loginErrorContainer_Header, .headerErrorContainer").hide();$("#header_login").removeClass("loginHeaderBtnOpen").addClass("loginHeaderBtnClose");}});},loadHeaderSection:function(){if($("#loginwidgetHeader").length<=0){$("body").find("#loginHeaderDlg").remove();$("#headerLoginContainer").append("<div id=\"loginHeaderDlg\" />");var url="/widgetnav/pages/custlogin/header.jsp";$("#loginHeaderDlg").load(url,function(data,status,xhr){if(status=="success"){$("#loginHeaderDlg").html(data);delta.LoginWidget.init("_Header");delta.LoginWidget.positionHeaderLogin();DeltaUtils.initButtons();var bottleNavSmNumber=$("#loginwidget.bottomNav #loginForm").find("input[name=usernm]").val();if(bottleNavSmNumber!=undefined&&bottleNavSmNumber!=null&&bottleNavSmNumber!="null"&&bottleNavSmNumber!=""){$("#loginForm_Header #usernm_Header").val(bottleNavSmNumber);$("#loginForm_Header #lblUser_Nm_Header").css("display","none");}}else{$("#loginHeaderDlg").html("");}});}else{$("#loginHeaderDlg").fadeToggle();}
if($("#header_login").hasClass("loginHeaderBtnClose")){$("#header_login").removeClass("loginHeaderBtnClose").addClass("loginHeaderBtnOpen");$("#remDiv_Header").show();}else if($("#header_login").hasClass("loginHeaderBtnOpen")){$("#header_login").removeClass("loginHeaderBtnOpen").addClass("loginHeaderBtnClose");$("#loginErrorContainer_Header, .headerErrorContainer").hide();}},loadSQADropDowns:function(){try{$.ajax({url:"/custlogin/getSQList.action",type:"POST",headers:{"cache-control":"no-cache"},dataTye:"json",success:function(successResult){var listItems="";for(var i=0;i<successResult.length;i++){if(successResult[i].currentIndicator==="Y"){listItems+="<option value='"+successResult[i].questionNumber+"'>"+successResult[i].questionText+"</option>";}}
$("#question1").append(listItems);$("#question2").append(listItems);}});}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in loadSQADropDowns=> "+error);}}},loginHelp:function(){var mainDivId=delta.LoginWidget.mainDivId;var selector=mainDivId+" .loginHelpLink1";if(mainDivId.indexOf("bottomNav")!=1){selector=selector+", #login-content .loginHelpLink1";}
$(selector).live("click",function(){var domain=window.location.host;var urlPath="https://"+domain+"/content/www/en_US/support/login-help.html";$(this).attr("href",urlPath);});},loginSubmit:function(mainDivId,section){try{var formName=section.replace("_","");$(mainDivId+".username").val($(mainDivId+"#usernm"+section).val());$(mainDivId+".password").val($(mainDivId+"#pwd"+section).val());$(mainDivId+".usernmType").val($(mainDivId+"#usernameType"+section).val());$(mainDivId+".pwdType").val($(mainDivId+"#passwordType"+section).val());if($(mainDivId+".remember_me").is(":checked")){$(mainDivId+".rememberMe").val(true);}else{$(mainDivId+".rememberMe").val(false);}
var BAUele=document.getElementById('custLoginParameter');var BAUfrm=document.getElementById('smlogin_login');var BAUVal=$("#custLoginParameter").val();if(typeof(BAUfrm)!='undefined'&&BAUfrm!=null){if(typeof(BAUele)!='undefined'&&BAUele!=null){$(".BAUParams").attr("value",$("#custLoginParameter").val());}}
if(typeof loginRefreshURL==='undefined'){$(mainDivId+".refreshURL").val(window.location.href);}else{$(mainDivId+".refreshURL").val(loginRefreshURL);}
$(mainDivId+".errorDiv").hide();$(mainDivId+".errorDivJavaError1").addClass("hideMe").removeClass("showMe");var fn=$(mainDivId+".username").val();var pwd=$(mainDivId+".password").val();$(mainDivId+"#lastname"+section).attr("value","");var isEmail=fn.match(/^[\w-]+(?:\.[\w-]+)*@([a-z0-9-]+\.)+[a-z]{2,4}$/i);var isUserName=fn.match(/^[a-zA-Z0-9]*(?!\s)+$/)&&isNaN(fn);var lastNameRequired=delta.LoginWidget.isLastNameRequired(fn);if(lastNameRequired||(!lastNameRequired&&pwd.length===4)){$(mainDivId+"label.overlabel").overlabel();if(!delta.LoginWidget.isHomePage&&section==""){if(CustomerInfo!=null&&CustomerInfo.custData!=null&&typeof(CustomerInfo.custData.loggedIn)!="undefined"&&CustomerInfo.custData.loggedIn){return;}
delta.LoginWidget.createLastNameNotification(lastNameRequired);}else{var isRememberMeCust=false;if((typeof loginData!='undefined')&&(loginData!=null)){if(loginData.rememberMeIndicator==true){isRememberMeCust=true;$(mainDivId+"#lblLst_Nm"+section).css("display","none");$(mainDivId+"#lastname"+section).attr("value",loginData.rememberMeLastName);}else{$(mainDivId+"#lastname"+section).attr("value","");}}else{if(CustomerInfo.getRememberMeIndicator()==true){isRememberMeCust=true;$(mainDivId+"#lblLst_Nm"+section).css("display","none");$(mainDivId+"#lastname"+section).attr("value",CustomerInfo.getRememberMeLastName());}else{$(mainDivId+"#lastname"+section).attr("value","");}}
if(isRememberMeCust&&!lastNameRequired){delta.LoginWidget.finalFormSubmit(mainDivId,"#lastNameForm"+section,section);return true;}else{$(mainDivId+" #submit-1"+section).hide();}
if(delta.LoginWidget.isHomePage){var loginDivWidth=$(mainDivId+".lastNameDiv").width()+$(mainDivId+".loginWrapper").width()+25;delta.LoginWidget.callHomePageLogin(loginDivWidth);}
$(mainDivId+".topDiv").show();$(mainDivId+".lastNameDiv").show();$(mainDivId+"#lastnameTextboxDiv"+section+" .overlabel").click(function(){$(mainDivId+"#lastnameTextboxDiv"+section+" .overlabel").hide();$(mainDivId+"#lastname"+section).focus();});}}else{$(mainDivId+".lastNameDiv").hide();$(mainDivId+".lastNameDiv .error").hide();delta.LoginWidget.finalFormSubmit(mainDivId,'#loginForm'+section,section);}}catch(error){if(delta.LoginWidget.isDebugEnabled==true){delta.LoginWidget.logMessage("Exception in loginSubmit=> "+error);}}},loginTooltip:function(){$('.loginTooltipclick').loginToolTip({clickIt:true,tipContent:"You can now login to delta.com",closeTipBtn:'loginToolTipCloseBtn'});},logMessage:function(message){if(this.isDebugEnabled){DeltaUtils.logMessage(message);}},notMe:function(){var section=delta.LoginWidget.loginsec;var mainDivId=delta.LoginWidget.mainDivId;$(mainDivId+" .linknotme").live("click",function(){delta.LoginWidget.callNotMeAction();});},positionHeaderLogin:function(){var posLeft=$("#header_login").offset().left+$("#header_login").outerWidth()-$("#login_Header").outerWidth();var posTop=$("#header_login").offset().top+$("#header_login").outerHeight();$("#loginHeaderDlg").offset({top:posTop,left:posLeft});},setMainDivId:function(){if(delta.LoginWidget.loginSec==""){if(delta.LoginWidget.isHomePage){delta.LoginWidget.mainDivId=delta.LoginWidget.homeMainDivId;}else{delta.LoginWidget.mainDivId=delta.LoginWidget.dockedMainDivId;}}else if(delta.LoginWidget.loginSec=="_Header"){delta.LoginWidget.mainDivId=delta.LoginWidget.headerMainDivId;}else{delta.LoginWidget.mainDivId=delta.LoginWidget.loginPageMainDivId;}},setFocus:function(){$(".bottomNav #usernm").focus(function(){try{delta.navwidget.open();$("#nav-widget-user #login").width("222");}catch(e){}});},setLoggedInStatus:function(){try{var loginStatus=CustomerInfo.isLoggedIn();if(loginStatus!=null){if(loginStatus){listatus='logged in';}else{listatus='logged out';}}else{listatus='logged out';}
s.linkTrackVars='s.prop34';s.prop34=listatus;s.prop34='';}
catch(e){}},showHeaderLoggedIn:function(isLoggedIn){if(isLoggedIn){$("#header_login").hide();$("#header_logout").show();}else{$("#header_login").show();$("#header_logout").hide();}},showLoginLastNameOnFly:function(mainDivId,section,lastNameRequired){var $pwdField=$(mainDivId+"#pwd"+section);var usrName=$(mainDivId+"#usernm"+section).val();var notPIN=false;if(lastNameRequired){if(!delta.LoginWidget.isHomePage&&section==""){if($("#login-content-lastname").children().length>0&&!$("#login-content-lastname").is(":hidden")){return false;}}else{if($("#login-content-lastname").children().length>0&&!$(mainDivId+".lastNameDiv").is(":hidden")){return false;}}}
if(lastNameRequired||(!lastNameRequired&&$pwdField.val().length==4)){var pwdFlag=delta.LoginWidgetValidation.getpassword(section),userFlag=false;if(pwdFlag||lastNameRequired){this.handleUsernameValidation(mainDivId,usrName,section);}else{notPIN=true;}}else{notPIN=true;}
if(notPIN&&!lastNameRequired){$(mainDivId+"#submit-1"+section).show();if(!delta.LoginWidget.isHomePage&&section==""){if(!$("#login-content").is(":hidden")){$("#login-content").hide();}}else{if(!$(mainDivId+".lastNameDiv").is(":hidden")){$(mainDivId+".lastNameDiv").hide();if(section==""){delta.LoginWidget.callHomePageLogin('auto');}}}}
if(delta.LoginWidget.timerLastName){clearTimeout(delta.LoginWidget.timerLastName);}
delta.LoginWidget.timerLastName=null;},updateProfileContryLang:function(countryLagnObj){$.ajax({url:"/profile/countryLang_updateLangPromtIndicator.action",type:"POST",headers:{"cache-control":"no-cache"},data:countryLagnObj,dataType:"json",success:function(langPromtIndicator){}});},updateSkyMiles:function(skyMiles){skyMiles=delta.LoginWidget.addCommas(skyMiles);$("#loggedIn #sky-miles").html(skyMiles);if($("#loggedIn_LoginPage #sky-miles_LoginPage").length>0){$("#loggedIn_LoginPage #sky-miles_LoginPage").html(skyMiles);}},updateUserName:function(userName){$("#loggedIn #custlogin_name").html(userName);if($("#loggedIn_LoginPage #custlogin_name_LoginPage").length>0){$("#loggedIn_LoginPage #custlogin_name_LoginPage").html(userName);}},setPasswordDialogOmnitureProp:function(desc,loc){s.linkTrackVars='prop1,prop2';s.prop1=desc;s.prop2=loc;s.tl(this,'o',desc);s.prop1=s.prop2='';},validateLastNameForm:function(mainDivId,section,lastNameDisPos){$("#lastNameForm"+section).validate({submitHandler:function(form){delta.LoginWidget.finalFormSubmit(mainDivId,"#lastNameForm"+section,section);},rules:{lastname:{lastname:section}},highlight:function(element,errorClass,validClass){delta.LoginWidget.formSubmitted="lastNameForm"+section;if(!delta.LoginWidget.isHomePage&&delta.LoginWidget.formSubmitted=="lastNameForm"){$(lastNameDisPos).addClass("error").removeClass("valid");}else{$(mainDivId+".errorLstRqd").addClass("error headerErrorContainer").removeClass("valid");if(delta.LoginWidget.isHomePage){delta.LoginWidget.callHomePageLogin(946);}}},unhighlight:function(element,errorClass,validClass){delta.LoginWidget.formSubmitted="lastNameForm"+section;if(!delta.LoginWidget.isHomePage&&delta.LoginWidget.formSubmitted=="lastNameForm"){$(lastNameDisPos).addClass("valid").removeClass("error");}else{$(mainDivId+".errorLstRqd").removeClass("error").addClass("valid");if(delta.LoginWidget.isHomePage){delta.LoginWidget.callHomePageLogin(549);}}},errorElement:"div",wrapper:"div",errorLabelContainer:lastNameDisPos});},validateLoginForm:function(errorContainerLabel,mainDivId,section){$("#loginForm"+section).validate({submitHandler:function(form){delta.LoginWidget.loginSubmit(mainDivId,section);},rules:{usernm:{loginCheck:section}},highlight:function(element,errorClass,validClass){delta.LoginWidget.formSubmitted="loginForm"+section;if(!delta.LoginWidget.isHomePage&&delta.LoginWidget.formSubmitted=="loginForm"){$("#ui-error-holder").addClass("error").removeClass("valid");$("#login-content").css({position:"fixed",bottom:"70px",left:$("#nav-widget-user").offset().left+"px",display:"block",zIndex:10000});}else{$(mainDivId+".errorDiv").addClass("error").removeClass("valid");}
if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);if(delta.LoginWidget.isHomePage||delta.LoginWidget.formSubmitted!="loginForm"){$(mainDivId+".errorDiv").hide();}}else{if(delta.LoginWidget.isHomePage||delta.LoginWidget.formSubmitted!="loginForm"){$(mainDivId+".errorDiv").show();$(mainDivId+".javaErr").addClass("hideMe").removeClass("showMe");if(delta.LoginWidget.isHomePage){var loginDivWidth=$(mainDivId+".loginWrapper").width()+$(mainDivId+".errorDiv").width()+50;delta.LoginWidget.callHomePageLogin(loginDivWidth);}
$("#loginErrorContainer"+section).show();}else{delta.LoginWidget.calculatePosition('#login-content-errors');$("#login-content-lastname").hide();}}},unhighlight:function(element,errorClass,validClass){delta.LoginWidget.formSubmitted="loginForm"+section;if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);if(delta.LoginWidget.isHomePage||delta.LoginWidget.formSubmitted!="loginForm"){$(mainDivId+".errorDiv").hide();$("#loginErrorContainer"+section).show();if(!$(mainDivId+".lastNameDiv").is(":hidden")){$(mainDivId+" #submit-1"+section).hide();}}}else{if(delta.LoginWidget.isHomePage||delta.LoginWidget.formSubmitted!="loginForm"){$(mainDivId+".javaErr").addClass("hideMe").removeClass("showMe");$(mainDivId+".errorDiv").show();if(delta.LoginWidget.isHomePage){var loginDivWidth=$(mainDivId+'.loginWrapper').width()+$(mainDivId+".errorDiv").width()+50;delta.LoginWidget.callHomePageLogin(loginDivWidth);}
if(!$(mainDivId+".lastNameDiv").is(":hidden")){$(mainDivId+" #submit-1"+section).hide();}}}
if(!delta.LoginWidget.isHomePage&&delta.LoginWidget.formSubmitted=="loginForm"&&$("#submit-1").is(":hidden")&&$("#login-content-lastname").is(":hidden")&&$("#ui-error-holder").is(":hidden")){$("#submit-1").show();}},errorElement:"div",wrapper:"div",errorLabelContainer:errorContainerLabel,errorPlacement:function(error,element){error.appendTo($(mainDivId+".errorDiv"));}});}};$(document).ready(function(){delta.LoginWidget.init("");if(!delta.LoginWidget.isHomePage){$("#header_login").click(function(){delta.LoginWidget.loadHeaderSection();});if($("#loginwidgetLoginPage").length>0){delta.LoginWidget.init("_LoginPage");}}});
if(dwr==null)var dwr={};if(dwr.engine==null)dwr.engine={};if(DWREngine==null)var DWREngine=dwr.engine;if(SavedSearchDWR==null)var SavedSearchDWR={};SavedSearchDWR._path='/air-shopping/dwr';SavedSearchDWR.getSavedSearchList=function(p0,callback){dwr.engine._execute(SavedSearchDWR._path,'SavedSearchDWR','getSavedSearchList',p0,callback);}
var month_names=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var RecentSavedSearch={savedSearchList:"",getSavedSearches:function(callback){var list="";var orgDestList="";var departDate="";var returnDate="";var tripType="";var noOfPax="";var isUpgradeable="";var isAwards="";var savedSearchDwrCallFlag=$("#recentSavedFlag").html();var skyMilesID="";if(CustomerInfo.custData!==null&&!SimpleSearchWidget.hasSavedSearchesInit){if(typeof(CustomerInfo.custData.customerID)!=="undefined"&&CustomerInfo.custData.customerID!=""){skyMilesID=CustomerInfo.custData.customerID;$("#savedsearch_ul").html('<div class="search_loading"></div>');SavedSearchDWR.getSavedSearchList(skyMilesID,{async:true,callback:function(savedSearchList){RecentSavedSearch.savedSearchList=savedSearchList;$.each(savedSearchList,function(index,search){if(search==null){list=list+"<li></li><li></li><li>"+"error occured during data fetch"+"</li><li></li><li></li>";$(".search_loading").remove();$("#savedsearch_ul").html(list);return 0;}
else if(search.length==0){}
else{SimpleSearchWidget.hasSavedSearches=true;tripType=search.tripType;noOfPax=search.numberOfPassengers;isUpgradeable=search.isUpgradeable;orgDestList=search.origDestInfos;isAwards=search.isRedeemMiles;$.each(orgDestList,function(index,orgDest){if(orgDest==null){return 0;}
else{list=list+"<li style='display:none; '>"+orgDest.originCityCd+"-"+orgDest.destinationCityCd+"-"+orgDest.departureTime+"-"+orgDest.returnTime+"-"+tripType+"-"+noOfPax+"-"+isUpgradeable+"-"+isAwards+"</li>"+"<li>"+search.alias+"</li>";}});$("#savedSearch").show();}});$(".search_loading").remove();$("#savedsearch_ul").html(list);$('#scroll_saved').tinyscrollbar_update();SimpleSearchWidget.hasSavedSearchesInit=true;callback();},errorHandler:function(){SimpleSearchWidget.hasSavedSearchesInit=true;callback();}});}else{(arguments.length>0)?callback():"";}}else{(arguments.length>0)?callback():"";}},saveRecentSearch:function(callback){var tripType=searchWidgetUtils.convertTripTypeForBAU($("#pol_widget_tripType").val());if("oneway"==tripType){var c_inData=$("#air-shopping-widget-mainContent #originCity").val()+"~"+$("#air-shopping-widget-mainContent #destinationCity").val()+"~"+$("#air-shopping-widget-mainContent #departureDate").val()+"~Return Date~"+tripType+"~"+$("#air-shopping-widget-mainContent #paxCount").val()+"~"+$("#air-shopping-widget-mainContent #is_Flex_Search").val()+"~"+$("#air-shopping-widget-mainContent #is_award_travel").val()+"~"+$("#air-shopping-widget-mainContent #isTraveling").attr('checked')+"~"+$("#air-shopping-widget-mainContent #pol_widget_isRequestUpgrade").attr('checked');}else{var c_inData=$("#air-shopping-widget-mainContent #originCity").val()+"~"+$("#air-shopping-widget-mainContent #destinationCity").val()+"~"+$("#air-shopping-widget-mainContent #departureDate").val()+"~"+$("#air-shopping-widget-mainContent #returnDate").val()+"~"+tripType+"~"+$("#air-shopping-widget-mainContent #paxCount").val()+"~"+$("#air-shopping-widget-mainContent #is_Flex_Search").val()+"~"+$("#air-shopping-widget-mainContent #is_award_travel").val()+"~"+$("#air-shopping-widget-mainContent #isTraveling").attr('checked')+"~"+$("#air-shopping-widget-mainContent #pol_widget_isRequestUpgrade").attr('checked');}
var c_data=RecentSavedSearch.getCookieContent(function(c_data){var searchRecords=c_data.split("*");var notSaved=true;var nc_data="";if(searchRecords.length>4){searchRecords.pop();searchRecords.pop();searchRecords.push("");}
for(i=searchRecords.length-2;i>-1;i--)
{if(searchRecords[i].toLowerCase()==c_inData.toLowerCase())
{notSaved=false;}else{nc_data=searchRecords[i]+"*"+nc_data;}}
if(notSaved){var tempSearchData=c_inData+"*"+nc_data;saveSingleAttributeValuePair("SimpleSearchWidgetRecentSearches",tempSearchData);setTimeout(function(){callback();},100);}else{callback();}});},loadRecentSearch:function(){RecentSavedSearch.getCookieContent(function(c_data){var searchRecords=c_data.split("*");var list="";for(i=0;i<searchRecords.length-1;i++)
{var searchRecord=searchRecords[i];var fromCity=searchRecord.split("~")[0];var toCity=searchRecord.split("~")[1];var stdate=new Date(searchRecord.split("~")[2]);var eddateStr=searchRecord.split("~")[3];var stdateStr=month_names[stdate.getMonth()]+" "+stdate.getDate();if(eddateStr!="Return Date"){var eddate=new Date(eddateStr);eddateStr=" - "+month_names[eddate.getMonth()]+" "+eddate.getDate();}else{eddateStr="";}
if((fromCity!=null&&fromCity.indexOf("undefined")==-1)&&(toCity!=null&&toCity.indexOf("undefined")==-1)&&stdateStr.indexOf("undefined")==-1&&eddateStr.indexOf("undefined")==-1&&stdateStr.indexOf("NaN")==-1&&eddateStr.indexOf("NaN")==-1)
list=list+"<li class='recentInput' id='"+searchRecord+"' > "+fromCity+" to "+toCity+", "+stdateStr+eddateStr+"</li>";}
$("ul#recentSearches").html(list);});},init:function(callback){var status=false;var string="";RecentSavedSearch.getCookieContent(function(c_data,from){if(c_data!=null&&c_data!=""){status=true;string+="Recent";}
if(SimpleSearchWidget.hasSavedSearches){status=true;string+="Saved";}
callback(status,string,from);});},getCookieContent:function(callback){if(SimpleSearchWidget.hasRecentSearches){callback(SimpleSearchWidget.recentSearchesData,"from simpleSearchWidget.hasRecentSearches");}else if(!SimpleSearchWidget.hasRecentSearchesInit){loadSingleAttributeWithCallback("SimpleSearchWidgetRecentSearches",function(searchData){SimpleSearchWidget.hasRecentSearchesInit=true;if(searchData!=null){SimpleSearchWidget.recentSearchesData=searchData;SimpleSearchWidget.hasRecentSearches=true;}
if(CustomerInfo.custData===null){setTimeout(function(){if(RecentSavedSearch.custDataTimeoutCounter<RecentSavedSearch.custDataTimeout){if(CustomerInfo.custData!==null){RecentSavedSearch.getSavedSearches(function(){callback(SimpleSearchWidget.recentSearchesData,"from simpleSearchWidget.recentSearchesData inside setTimeout");});}
else{RecentSavedSearch.custDataTimeoutCounter++;setTimeout(arguments.callee,100);}}else{CustomerInfo.custData="";CustomerInfo.custData.customerID="";RecentSavedSearch.getSavedSearches(function(){callback(SimpleSearchWidget.recentSearchesData,"from simpleSearchWidget.recentSearchesData");});}},100);}else{RecentSavedSearch.getSavedSearches(function(){callback(SimpleSearchWidget.recentSearchesData,"from simpleSearchWidget.recentSearchesData");});}});}},custDataTimeout:function(){if(delta.navwidget.isDockedState()){return 3;}else{return 25;}},custDataTimeoutCounter:0};ErrorMessages={eC101605:{errMsg:"We're sorry. The passenger count you've entered exceed the limit.",errCode:"101605"},eC20128:{errMsg:"Please select at least one passenger.",errCode:"20128"},eC7090:{errMsg:"The number of passengers requested is not supported. Please select between 1 and 9 passengers.",errCode:"7090"},eC7076:{errMsg:"You cannot have the same departure and arrival city.",errCode:"7076"},eC1605:{errMsg:"Sorry, you have too many passengers.",errCode:"1605"},noDate:{errMsg:"Please enter a valid "},invalidFormatDate:{errMsg:"Please enter date in mm/dd/yyyy format."},futureDate:{errMsg:"Please choose a date no more than 331 days from today."},sameAirport:{errMsg:"Please enter different arrival and departure cities."},wrongAirport:{errMsg:"We're sorry. No cities or airport codes matched that entry. Please try again."},blankAirports:{errMsg:"Please enter valid 'FROM' and 'TO' locations."},blankDates:{errMsg:"Please enter valid Departure and Return dates."},clearErrorMsg:function(element){$(element).removeClass("spc_err_msg");}};jQuery.validator.messages.requiredFromCity="";jQuery.validator.classRuleSettings.requiredFromCity={requiredFromCity:true};jQuery.validator.addMethod("requiredFromCity",function(value,element,param){ErrorMessages.clearErrorMsg(element);if(AirportValidation.isBlank()){jQuery.validator.messages.requiredFromCity="";return false;}else if((value=="City or Airport"||$.trim(value)=="")||value.length!=3||!(/^[a-z]+$/i.test(value))){jQuery.validator.messages.requiredFromCity=ErrorMessages.noDate.errMsg+" 'FROM' City or Airport code.";return false;}else if(AirportValidation.sameValueOrBlank(value,$(param[0]).val())){jQuery.validator.messages.requiredFromCity="";return false;}else{jQuery.validator.messages.requiredFromCity="";return true;}},jQuery.validator.messages.requiredFromCity);jQuery.validator.messages.requiredToCity="";jQuery.validator.classRuleSettings.requiredToCity={requiredToCity:true};jQuery.validator.addMethod("requiredToCity",function(value,element,param){ErrorMessages.clearErrorMsg(element);if(AirportValidation.isBlank()){jQuery.validator.messages.requiredToCity=ErrorMessages.blankAirports.errMsg;return false;}else if((value=="City or Airport"||$.trim(value)=="")||value.length!=3||!(/^[a-z]+$/i.test(value))){jQuery.validator.messages.requiredToCity=ErrorMessages.noDate.errMsg+" 'TO' City or Airport code.";return false;}else if(AirportValidation.sameValueOrBlank(value,$(param[0]).val())){jQuery.validator.messages.requiredToCity=ErrorMessages.sameAirport.errMsg;return false;}else{jQuery.validator.messages.requiredToCity="";return true;}},jQuery.validator.messages.requiredToCity);jQuery.validator.messages.requiredStartDate="";jQuery.validator.classRuleSettings.requiredStartDate={requiredStartDate:true};jQuery.validator.addMethod("requiredStartDate",function(value,element,param){ErrorMessages.clearErrorMsg(element);var invalidFormatCheck=DateValidation.formatCheck(value);var invalidmaxRangeCheck=DateValidation.maxRangeCheck(value);var invalidminRangeCheck=DateValidation.minRangeCheck(value);var invalidReturnDate=DateValidation.returnCheck();if(DateValidation.blankDateCheck()&&!($('#air-shopping-widget-mainContent #roundtripDateWrap').attr('class')=="oneWayHidden")){jQuery.validator.messages.requiredStartDate="";return false;}else if(value=="Depart Date"||$.trim(value)==""){jQuery.validator.messages.requiredStartDate=ErrorMessages.noDate.errMsg+" Departure Date.";return false;}else if(invalidFormatCheck){if($('div[for=returnDate]').text()!=ErrorMessages.invalidFormatDate.errMsg||($('div[for=returnDate]').text()==ErrorMessages.invalidFormatDate.errMsg&&$('div[for=returnDate]').css("display")=="none")){jQuery.validator.messages.requiredStartDate=ErrorMessages.invalidFormatDate.errMsg;}else{jQuery.validator.messages.requiredStartDate="";}
return false;}else if(invalidmaxRangeCheck){jQuery.validator.messages.requiredStartDate=ErrorMessages.futureDate.errMsg;return false;}else if(invalidminRangeCheck){jQuery.validator.messages.requiredStartDate=ErrorMessages.noDate.errMsg+" Departure Date.";return false;}else if(invalidReturnDate){jQuery.validator.messages.requiredStartDate=ErrorMessages.noDate.errMsg+" Departure Date.";$("#"+element.id).val("");return false;}else{jQuery.validator.messages.requiredStartDate="";return true;}},jQuery.validator.messages.requiredStartDate);jQuery.validator.messages.requiredReturnDate="";jQuery.validator.classRuleSettings.requiredReturnDate={requiredReturnDate:true};jQuery.validator.addMethod("requiredReturnDate",function(value,element,param){ErrorMessages.clearErrorMsg(element);var invalidFormatCheck=DateValidation.formatCheck(value);var invalidmaxRangeCheck=DateValidation.maxRangeCheck(value);var invalidminRangeCheck=DateValidation.minRangeCheck(value);var invalidReturnDate=DateValidation.returnCheck();if(DateValidation.blankDateCheck()){jQuery.validator.messages.requiredReturnDate=ErrorMessages.blankDates.errMsg;return false;}else if(value=="Return Date"||$.trim(value)==""){jQuery.validator.messages.requiredReturnDate=ErrorMessages.noDate.errMsg+" Return Date.";return false;}else if(invalidFormatCheck){if($('div[for=departureDate]').text()!=ErrorMessages.invalidFormatDate.errMsg||($('div[for=departureDate]').text()==ErrorMessages.invalidFormatDate.errMsg&&$('div[for=departureDate]').css("display")=="none")){jQuery.validator.messages.requiredReturnDate=ErrorMessages.invalidFormatDate.errMsg;}else{jQuery.validator.messages.requiredReturnDate="";}
return false;}else if(invalidmaxRangeCheck){jQuery.validator.messages.requiredReturnDate=ErrorMessages.futureDate.errMsg;return false;}else if(invalidminRangeCheck){jQuery.validator.messages.requiredReturnDate=ErrorMessages.noDate.errMsg+" Return Date.";return false;}else if(invalidReturnDate){jQuery.validator.messages.requiredReturnDate=ErrorMessages.noDate.errMsg+" Return Date.";$("#"+element.id).val("");return false;}else{jQuery.validator.messages.requiredReturnDate="";return true;}},jQuery.validator.messages.requiredReturnDate);jQuery.validator.messages.requiredPassengerCount="";jQuery.validator.classRuleSettings.requiredPassengerCount={requiredPassenger:true};jQuery.validator.addMethod("requiredPassengerCount",function(value,element,param){ErrorMessages.clearErrorMsg(element);if($.trim(value)==""||value=="0"){jQuery.validator.messages.requiredPassengerCount=ErrorMessages.eC20128.errMsg;return false;}else if(isNaN(value)){jQuery.validator.messages.requiredPassengerCount=ErrorMessages.eC7090.errMsg;return false;}else if($.trim(value)>9){jQuery.validator.messages.requiredPassengerCount=ErrorMessages.eC101605.errMsg;return false;}else{jQuery.validator.messages.requiredPassengerCount="";return true;}},jQuery.validator.messages.requiredPassengerCount);var AirportValidation={sameValueOrBlank:function(param1,param2){if(param1.toUpperCase()==param2.toUpperCase()){return true;}
return false;},isBlank:function(){var param1=$('#air-shopping-widget-mainContent #originCity').val();var param2=$('#air-shopping-widget-mainContent #destinationCity').val();if(!(((param1=="City or Airport"||$.trim(param1)=="")||param1.length!=3||!(/^[a-z]+$/i.test(param1)))&&((param2=="City or Airport"||$.trim(param2)=="")||param2.length!=3||!(/^[a-z]+$/i.test(param2))))){return false;}
return true;}};var DateValidation={maxDaysinFuture:331,todayDate:function(){var dateArr=$("#serverDate").html().split("-");return new Date(dateArr[0],dateArr[1],dateArr[2]);},minDate:function(){return new Date(DateValidation.todayDate().getFullYear(),DateValidation.todayDate().getMonth(),DateValidation.todayDate().getDate());},maxDate:function(){return new Date(DateValidation.minDate().getTime()+DateValidation.maxDaysinFuture*24*60*60*1000);},formatCheck:function(value){var re=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(re.test(value)){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if((xdata.getFullYear()==aaaa)&&(xdata.getMonth()==mm-1)&&(xdata.getDate()==gg)){return false;}else{return true;}}else
return true;},rangeCheck:function(value){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if(xdata.getTime()<DateValidation.minDate().getTime()||xdata.getTime()>DateValidation.maxDate().getTime()){return true;}else{return false;}},maxRangeCheck:function(value){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if(xdata.getTime()>DateValidation.maxDate().getTime()){return true;}else{return false;}},minRangeCheck:function(value){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if(xdata.getTime()<DateValidation.minDate().getTime()){return true;}else{return false;}},returnCheck:function(){var depdata=$('#departureDate').val().split('/');var retdata=$('#returnDate').val().split('/');if(DateValidation.formatCheck($('#air-shopping-widget-mainContent #departureDate').val())||DateValidation.formatCheck($('#air-shopping-widget-mainContent #returnDate').val())){return false;}
var depgg=parseInt(depdata[1],10);var depmm=parseInt(depdata[0],10);var depaaaa=parseInt(depdata[2],10);var xdepdata=new Date(depaaaa,depmm-1,depgg);var retgg=parseInt(retdata[1],10);var retmm=parseInt(retdata[0],10);var retaaaa=parseInt(retdata[2],10);var xretdata=new Date(retaaaa,retmm-1,retgg);if(xdepdata.getTime()>xretdata.getTime()){return true;}else{return false;}},formatDate:function(value){if(!this.isValidateDate(value)){return value;}
var convertDate=this.formatYear(value);return convertDate;},isValidateDate:function(dateValue){var objRegExp=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{2,4}$/;if(!objRegExp.test(dateValue)){return false;}
return true;},formatYear:function(strInput){var strYear;var strRetVal=strInput;strYear=strInput.substr(strInput.lastIndexOf("\/")+1);if(strYear.length==2){strYear=parseInt(strYear)+2000;strRetVal=""+strInput.substring(0,(strInput.lastIndexOf("\/")+1))+strYear;}
return strRetVal;},blankDateCheck:function(){var departDate=$('#air-shopping-widget-mainContent #departureDate').val();var returnDate=$('#air-shopping-widget-mainContent #returnDate').val();if(!((departDate=="Depart Date"||$.trim(departDate)=="")&&(returnDate=="Return Date"||$.trim(returnDate)==""))){return false;}
return true;}};var validateFlightSearchForm={skipflex:true,blockForm:false,formValidate:function(){$("[validateThisField]").attr("validateThisField",false);$("[validateThisField=false]").parent().not(":hidden").each(function(){$("[validateThisField=false]",$(this)).attr("validateThisField",true);});$("form#flightSearchForm").validate({errorClass:"spc_err_msg",errorElement:"div",onkeyup:function(element){if(element.id==="departureDate"||element.id==="returnDate"){var value=element.value;if(value!=null&&value.match(/^\d{2}\/$/)!==null){value=element.value.split("/")[0];if(!(value<=12&&value>=1)){$(element).valid();element.value="";}}}},onfocusout:false,submitHandler:function(form){if(!validateFlightSearchForm.blockForm){if(searchWidgetUtils.setRecentSearch){$('#findFlightsSubmit').attr('disabled','disabled');}
$('#air-shopping-widget-mainContent #originCity').val($('#air-shopping-widget-mainContent #originCity').val().toUpperCase());$('#air-shopping-widget-mainContent #destinationCity').val($('#air-shopping-widget-mainContent #destinationCity').val().toUpperCase());if($("#flightSearchForm #is_Flex_Search").val()=="true"){$("#flightSearchForm #datesFlexible").val("true");}
if($("#flightSearchForm #is_award_travel").val()=="true"){$("#flightSearchForm #awardTravel").val("true");}
if(!SimpleSearchWidget.isMoreOptionsSearch){if($("#air-shopping-widget-mainContent #is_Flex_Search").val()=="true"){$("#flightSearchForm #datesFlexible").val("true");$("#flightSearchForm").attr("action",airShoppingDefaultHost+"/air-shopping/flexDates.action");}else if($("#flightSearchForm #is_award_travel").val()=="true"){AwardSearch.submitAwardSearch();}}
if(searchWidgetUtils.setRecentSearch&&!SimpleSearchWidget.isMoreOptionsSearch){RecentSavedSearch.saveRecentSearch(function(){form.submit(function(){validateFlightSearchForm.blockForm=true;});$('#findFlightsSubmit').attr('disabled','disabled');});}else{form.submit(function(){validateFlightSearchForm.blockForm=true;});}}},errorLabelContainer:"#book-air-errorMsg",ignore:"[validateThisField!=true]:hidden",rules:{"originCity":{requiredFromCity:['input[name="destinationCity"]']},"destinationCity":{requiredToCity:['input[name="originCity"]']},"departureDate":{requiredStartDate:true,maxlength:false},"returnDate":{requiredReturnDate:true,maxlength:false},"paxCount":{requiredPassengerCount:true,maxlength:false}}});}};$(document).ready(function(){$('#findFlightsSubmit').removeAttr('disabled');});(function(a){function b(b,c){function w(a){if(!(g.ratio>=1)){o.now=Math.min(i[c.axis]-j[c.axis],Math.max(0,o.start+((k?a.pageX:a.pageY)-p.start)));n=o.now*h.ratio;g.obj.css(l,-n);j.obj.css(l,o.now)}
return false}
function v(b){a(document).unbind("mousemove",w);a(document).unbind("mouseup",v);j.obj.unbind("mouseup",v);document.ontouchmove=j.obj[0].ontouchend=document.ontouchend=null;return false}
function u(b){if(!(g.ratio>=1)){var b=b||window.event;var d=b.wheelDelta?b.wheelDelta/120:-b.detail/3;n-=d*c.wheel;n=Math.min(g[c.axis]-f[c.axis],Math.max(0,n));j.obj.css(l,n/h.ratio);g.obj.css(l,-n);b=a.event.fix(b);b.preventDefault()}}
function t(b){p.start=k?b.pageX:b.pageY;var c=parseInt(j.obj.css(l));o.start=c=="auto"?0:c;a(document).bind("mousemove",w);document.ontouchmove=function(b){a(document).unbind("mousemove");w(b.touches[0])};a(document).bind("mouseup",v);j.obj.bind("mouseup",v);j.obj[0].ontouchend=document.ontouchend=function(b){a(document).unbind("mouseup");j.obj.unbind("mouseup");v(b.touches[0])};return false}
function s(){j.obj.bind("mousedown",t);j.obj[0].ontouchstart=function(a){a.preventDefault();j.obj.unbind("mousedown");t(a.touches[0]);return false};i.obj.bind("mouseup",w);if(c.scroll&&this.addEventListener){e[0].addEventListener("DOMMouseScroll",u,false);e[0].addEventListener("mousewheel",u,false)}else if(c.scroll){e[0].onmousewheel=u}}
function r(){j.obj.css(l,n/h.ratio);g.obj.css(l,-n);p["start"]=j.obj.offset()[l];var a=m.toLowerCase();h.obj.css(a,i[c.axis]);i.obj.css(a,i[c.axis]);j.obj.css(a,j[c.axis])}
function q(){d.update();s();return d}
var d=this;var e=b;var f={obj:a(".viewport",b)};var g={obj:a(".overview",b)};var h={obj:a(".scrollbar",b)};var i={obj:a(".track",h.obj)};var j={obj:a(".thumb",h.obj)};var k=c.axis=="x",l=k?"left":"top",m=k?"Width":"Height";var n,o={start:0,now:0},p={};this.update=function(a){f[c.axis]=f.obj[0]["offset"+m];g[c.axis]=g.obj[0]["scroll"+m];g.ratio=f[c.axis]/g[c.axis];h.obj.toggleClass("disable",g.ratio>=1);i[c.axis]=c.size=="auto"?f[c.axis]:c.size;j[c.axis]=Math.min(i[c.axis],Math.max(0,c.sizethumb=="auto"?i[c.axis]*g.ratio:c.sizethumb));h.ratio=c.sizethumb=="auto"?g[c.axis]/i[c.axis]:(g[c.axis]-f[c.axis])/(i[c.axis]-j[c.axis]);n=a=="relative"&&g.ratio<=1?Math.min(g[c.axis]-f[c.axis],Math.max(0,n)):0;n=a=="bottom"&&g.ratio<=1?g[c.axis]-f[c.axis]:isNaN(parseInt(a))?n:parseInt(a);r()};return q()}
a.tiny=a.tiny||{};a.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:true,size:"auto",sizethumb:"auto"}};a.fn.tinyscrollbar=function(c){var c=a.extend({},a.tiny.scrollbar.options,c);this.each(function(){a(this).data("tsb",new b(a(this),c))});return this};a.fn.tinyscrollbar_update=function(b){return a(this).data("tsb").update(b)};})(jQuery)
var SimpleSearchWidget=window.SimpleSearchWidget||{};SimpleSearchWidget={init:function(){if(this.needsInit){this.needsInit=false;if($("#air-shopping-widget-mainContent #originCity").length>0&&$("#air-shopping-widget-mainContent #destinationCity").length>0){DeltaUtils.addAutocomplete("#air-shopping-widget-mainContent #originCity","airportCode");DeltaUtils.addAutocomplete("#air-shopping-widget-mainContent #destinationCity","airportCode");}
$(document).on('click.searchFlightResults','#air-shopping-widget-mainContent #depDateCalIcon',function(){$(departureDate).trigger("focus");});$(document).on('click.searchFlightResults','#air-shopping-widget-mainContent #retDateCalIcon',function(){$(returnDate).trigger("focus");});$("body").on("click",".ui-menu-item",function(){$("#lang_container").hide();});$("#air-shopping-widget-mainContent #originCity, #air-shopping-widget-mainContent #destinationCity").on("focusout",function(){$("#lang_container").hide();});var departureDate=$("#air-shopping-widget-mainContent #departureDate");var returnDate=$("#air-shopping-widget-mainContent #returnDate");var language="en";var country="US";var mp_lang=CookieUtils.get("MP_LANG");var mp_country=CookieUtils.get("MP_COUNTRY");(DeltaUtils.exists(mp_lang)&&mp_lang!="")?language=mp_lang:"";(DeltaUtils.exists(mp_country)&&mp_country!="")?country=mp_country.toUpperCase():"";var displayFormat="MM/dd/yyyy";var langcntryRegEx=/^[a-zA-Z]{2}$/;var locationObj=window.location;var protocol=locationObj.protocol;var host=locationObj.host;var ctx=protocol+"//"+host;function myPositionCallBack(event,fieldObj,calContainerObj){myCal.positionCal(event,fieldObj,calContainerObj);}
function myCalCallBack(elementObj,dateStr){if(dateStr!=null){elementObj.value=dateStr;if(elementObj.name=='departureDate'){var rDate=myCal.getDateObject(dateStr);if(rDate!=null){$('#dateText').empty().append("You've selected "+rDate);var dDate=new Date(rDate.getTime()+(5*24*60*60*1000));returnDate.get(0).value=myCal.getDateString(dDate.getMonth()+1,dDate.getDate(),dDate.getFullYear());}}}};delta.calendar.globalConfiguration();delta.calendar.create({calendarElement:$('.airShoppingDateFieldWrap'),daysInFutureToShow:331,daysInPastToShow:0,startDateTitle:'Depart Date',endDateTitle:'Return Date',showDropDown:true});SearchWidget.resetFields();var locationHost=window.location.host;destAirportLookup=new AirportLookup({targetInp:'#air-shopping-widget-mainContent #destinationCity',trigger:'#air-shopping-widget-mainContent #destCityLookup',displayTitle:'Arriving Airport',serverUrl:locationHost});orgAirportLookup=new AirportLookup({targetInp:'#air-shopping-widget-mainContent #originCity',trigger:'#air-shopping-widget-mainContent #srcCityLookup',displayTitle:'Departing Airport',serverUrl:locationHost});this.getCustData();if(SimpleSearchWidget.loginSessionDataFound){if(SimpleSearchWidget.custData.loggedIn==true&&SimpleSearchWidget.custData.medallionMbrInd=="1"){$("#pol_widget_isRequestUpgrade").attr("checked","checked");$('#air-shopping-widget-mainContent .request-upgrade-content').removeClass("hideDisplay");}}
$(document).on('click.searchFlightResults','#book_award_checkbox',function(){SimpleSearchWidget.processFieldsForAwardCheckbox('true');});$("#isTraveling").on("click",function(event){SimpleSearchWidget.checkedTravelling();});try{$(document).on('click.searchFlightResults','#air-shopping-widget button,#air-shopping-widget input, #air-shopping-widget #recentSavedCont, #air-shopping-widget #recentSavedBox',function(){resizeWidget.afterValidation();});$(document).on('blur.searchFlightResults','#air-shopping-widget input',function(){resizeWidget.afterValidation();});$(document).on('click.searchFlightResults','#air-shopping-widget #findFlightsSubmit',function(){resizeWidget.afterValidation();searchWidgetUtils.setHiddenFields();$("form#flightSearchForm").submit();});$("#book-hotel-content-trigger, #book-car-content-trigger").on("click.searchFlightResults",function(){if($("#recentSavedBox").is(":visible")){$("#recentSavedBox").slideUp(50);$('#recentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});}});$("#inputwarp_source_city,"+"#inputwarp_destination_city,"+" #paxCount,"+" .pass-countArrow-wrap,"+" #air-shopping-widget-mainContent input[type='checkbox'],"+" #air-shopping-widget-mainContent #recentSearchArrow,"+" #air-shopping-widget-mainContent #findFlightsSubmit").on("click.searchFlightResults",function(){if($(".delta2UpCal").is(":visible")){delta.deltaPolCalendarMgr.closeAll();}});}catch(e){}
DeltaUtils.setPlaceholderText("#air-shopping-widget-mainContent input[placeholder]");validateFlightSearchForm.formValidate();if(delta.navwidget.isDockedState()){$("#pol_widget_checkbox_div").addClass("pad-top10");}
RecentSavedSearch.init(function(status,string,callback_from){var recentSavedFlagValue=$.trim($('#recentSavedFlag').html());$("#recentSavedFlag").html(recentSavedFlagValue);if(status){$('#recentSavedFlag').html(string);SimpleSearchWidget.recentSearchHeight=30;SearchWidget.showSearch("callback from "+callback_from);}
else{SimpleSearchWidget.recentSearchHeight=0}
SimpleSearchWidget.processFieldsForAwardCheckbox('none');});}},needsInit:true,custData:{},getCustData:function(){if((typeof(CustomerInfo)==="object")&&CustomerInfo.custData!==null){if(CustomerInfo.custData.loggedIn===true){SimpleSearchWidget.loginSessionDataFound=true;SimpleSearchWidget.custData=CustomerInfo.custData;return true;}}
if((typeof(loginData)==="object")&&loginData!==null){if(loginData.loggedIn===true){SimpleSearchWidget.loginSessionDataFound=true;SimpleSearchWidget.custData=loginData;return true;}}
if((typeof(tmpLoginData)==="object")&&tmpLoginData!==null){if(tmpLoginData.loggedIn===true){SimpleSearchWidget.loginSessionDataFound=true;SimpleSearchWidget.custData=tmpLoginData;return true;}}
return false;},hasRecentSearches:false,recentSearchHeight:30,hasRecentSearchesInit:false,recentSearchesData:"",hasSavedSearches:false,hasSavedSearchesInit:false,savedSearchesData:"",documentReadyCalled:false,currentCalendarFocus:"",isMoreOptionsSearch:false,loginSessionDataFound:false,processFieldsForAwardCheckbox:function(flag){this.getCustData();if(flag=="true"){$("#cashBtn,#milesBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #is_award_travel").val("true");$("#air-shopping-widget-mainContent #milesBtn").addClass("trip-selected");if(SimpleSearchWidget.loginSessionDataFound){if(SimpleSearchWidget.custData.loggedIn==true&&((SimpleSearchWidget.custData.membershipLevel=="FO"&&SimpleSearchWidget.custData.medallionMbrInd=="1")||SimpleSearchWidget.custData.membershipLevel=="FF")){$("#air-shopping-widget-mainContent #iam_travelling_index").show();$("#air-shopping-widget-mainContent .imtraveling_search-left-cell").css({"visibility":"visible"});$("#air-shopping-widget-mainContent #isTraveling").attr("checked",true);$("#pol_widget_isRequestUpgrade").removeAttr("checked");$('#air-shopping-widget-mainContent .request-upgrade-content').hide();}else if(SimpleSearchWidget.custData.loggedIn==true&&((SimpleSearchWidget.custData.membershipLevel!="FO"&&SimpleSearchWidget.custData.medallionMbrInd=="1")||(true==SimpleSearchWidget.custData.pwmMbr))){$("#air-shopping-widget-mainContent #iam_travelling_index").show();$("#air-shopping-widget-mainContent .imtraveling_search-left-cell").css({"visibility":"visible"});$("#air-shopping-widget-mainContent #isTraveling").attr("checked",true);SimpleSearchWidget.showRequestUpgrade();}}}else if(flag=="false"){$("#cashBtn,#milesBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #is_award_travel").val("false");$("#air-shopping-widget-mainContent #cashBtn").addClass("trip-selected");if(SimpleSearchWidget.loginSessionDataFound){$("#air-shopping-widget-mainContent #isTraveling").attr("checked",false);$("#air-shopping-widget-mainContent #iam_travelling_index").show();$("#air-shopping-widget-mainContent .imtraveling_search-left-cell").css({"visibility":"hidden"});SimpleSearchWidget.showRequestUpgrade();}}
delta.navwidget.adjustWidgetHeight("booking");},checkedTravelling:function(){this.getCustData();if(SimpleSearchWidget.custData.loggedIn==true&&SimpleSearchWidget.custData.membershipLevel!="FO"&&SimpleSearchWidget.custData.medallionMbrInd=="1"){if(SimpleSearchWidget.isCheckedTravelling()){$("#pol_widget_isRequestUpgrade").attr("checked","checked");$('#air-shopping-widget-mainContent .request-upgrade-content').show();}else{$("#pol_widget_isRequestUpgrade").removeAttr("checked");$('#air-shopping-widget-mainContent .request-upgrade-content').hide();}
delta.navwidget.adjustWidgetHeight("booking");}},isCheckedTravelling:function(){return($("#air-shopping-widget-mainContent #isTraveling").is(":checked"));},isRequestUpgradeShow:function(){return $('#air-shopping-widget-mainContent .request-upgrade-content').hasClass("hideDisplay");},showRequestUpgrade:function(){if(!SimpleSearchWidget.isRequestUpgradeShow()){$("#pol_widget_isRequestUpgrade").attr("checked","checked");$('#air-shopping-widget-mainContent .request-upgrade-content').show();}}};$(function(){$("body").append($("#searchWidgetpopupContent").html());$("#searchWidgetpopupContent").html(" ");var airportID;$('#air-shopping-widget-mainContent #departureDate, #air-shopping-widget-mainContent #returnDate').on({'keyup.searchFlightResults':function(event){var v=$(this).val();if((event.keyCode>47&&event.keyCode<58)||(event.keyCode>95&&event.keyCode<106)){if(v.match(/^\d{2}$/)!==null){$(this).val(v+'/');}else if(v.match(/^\d{2}\/\d{2}$/)!==null||v.match(/^\d{1}\/\d{2}$/)!==null){$(this).val(v+'/');}}else if(event.keyCode==191){v=v.replace("//","/");$(this).val(v);}else if(event.keyCode==37||event.keyCode==39||event.keyCode==36||event.keyCode==35||event.keyCode==9||event.keyCode==8||event.keyCode==46||event.keyCode==16){}else{v=v.replace(/[^0-9\/]/g,"");$(this).val(v);}},'focusout.searchFlightResults':function(){var v=$(this).val();v=DateValidation.formatDate($(this).val());$(this).val(v);if(!DateValidation.formatCheck(v)&&!DateValidation.rangeCheck(v)){var vdata=v.split('/');var mm=(vdata[0].length==2)?vdata[0]:"0"+vdata[0];var gg=(vdata[1].length==2)?vdata[1]:"0"+vdata[1];var aaaa=vdata[2];v=mm+"/"+gg+"/"+aaaa;$(this).val(mm+"/"+gg+"/"+aaaa);}}});$(document).off("click.searchFlightResults",".recent-search-arrow").on("click.searchFlightResults",".recent-search-arrow",function(){if($("#recentSavedBox").css("display")=="none"){RecentSavedSearch.loadRecentSearch();if(SimpleSearchWidget.custData!==null){if(SimpleSearchWidget.custData.customerID!==null&&SimpleSearchWidget.custData.customerID!=""&&SimpleSearchWidget.custData.customerID!=="undefined"){RecentSavedSearch.getSavedSearches();}}
SearchWidget.hidePopups();var pos=$(".recent-saved-search").offset();$('#recentSavedBox').css({'left':pos.left,'top':pos.top+24});$("#recentSavedBox").slideDown(300,function(){$('#scroll_saved').tinyscrollbar_update();});$('#recentSearchArrow').css({'border-bottom-color':'#fff','background-color':'#fff'});$(window).scroll(function(){SearchWidget.hideSearchDiv();});}else{$("#recentSavedBox").slideUp(300);$('#recentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});}});$("#savedsearch_ul").on('click.searchFlightResults','li',function(){var savedTrip=$(this).prev().text();var originCity=savedTrip.split("-")[0];var destCity=savedTrip.split("-")[1];var departDate=savedTrip.split("-")[2];var returnDate=savedTrip.split("-")[3];var tripTypeInit=savedTrip.split("-")[4];var paxCount=savedTrip.split("-")[5];var isUpgradeable=savedTrip.split("-")[6];var isAwardTrip=savedTrip.split("-")[7];var tripType=searchWidgetUtils.convertTripTypeForPol(tripTypeInit);$("#air-shopping-widget-mainContent #returnDate").show();SearchWidget.hideSearchDiv();$('#air-shopping-widget-mainContent #originCity').val(originCity);$('#air-shopping-widget-mainContent #destinationCity').val(destCity);if(paxCount!='null'&&paxCount!=''&&paxCount!='undefined'){$("#air-shopping-widget-mainContent #paxCount").val(paxCount);}
if(tripType!='null'&&tripType!=''&&tripType!='undefined'){$("#pol_widget_tripType").val(tripType);if(tripType=='ROUND_TRIP')
{$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #roundTripBtn").addClass("trip-selected");$("#air-shopping-widget-mainContent #roundtripDateWrap").removeClass("oneWayHidden");$("#air-shopping-widget-mainContent #retDateCalIcon").parent().show();}else if(tripType=='ONE_WAY'){$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #oneWayBtn").addClass("trip-selected");$("#air-shopping-widget-mainContent #returnDate").hide();$("#air-shopping-widget-mainContent #roundtrip_cal_icon").hide();$("#air-shopping-widget-mainContent #roundtripDateWrap").addClass("oneWayHidden");$("#air-shopping-widget-mainContent #retDateCalIcon").parent().hide();}}
if(isAwardTrip=='true'||isAwardTrip=='checked'){SimpleSearchWidget.processFieldsForAwardCheckbox('true');}else{SimpleSearchWidget.processFieldsForAwardCheckbox('false');}
if(!DeltaUtils.supportsPlaceholderAttr()){var selectorPattern="#air-shopping-widget-mainContent input[placeholder]";var $rootSearch=$(selectorPattern);$rootSearch.each(function(){if($(this).val()!=$(this).attr('placeholder')){$(this).removeClass('placeholder');}});}
$("form#flightSearchForm").validate().resetForm();resizeWidget.afterValidation();});$("ul.selList").on('click.searchFlightResults','li',function(){$(this).parent().children().removeClass('clickedCountry');$(this).addClass('clickedCountry');});$(document).on('click.searchFlightResults','#baseContainer_Upper , body',function(event){if($(event.target).attr("id")!="recentSearchArrow"&&!$('#recentSavedBox').is(":hidden")){if($(event.target).parents().filter('div#recentSavedBox').attr('id')!='recentSavedBox'){SearchWidget.hideSearchDiv();}}});$(document).on('click','#air-shopping-widget-mainContent #roundTripBtn, #air-shopping-widget-mainContent #oneWayBtn',function(){$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$(this).addClass("trip-selected");if($(this).attr('id')=="oneWayBtn"){if($(".delta2UpCal").is(":visible")&&$("#air-shopping-widget-mainContent #returnDate").hasClass("selectedDateInput")){delta.deltaPolCalendarMgr.closeAll();}
$("#air-shopping-widget-mainContent #roundtripDateWrap").addClass('oneWayHidden');$("#air-shopping-widget-mainContent #returnDate").hide();$("#air-shopping-widget-mainContent #retDateCalIcon").parent().hide();$("#pol_widget_tripType").val('ONE_WAY');}else{$("#air-shopping-widget-mainContent #roundtripDateWrap").removeClass('oneWayHidden');$("#air-shopping-widget-mainContent #returnDate").show();$("#air-shopping-widget-mainContent #retDateCalIcon").parent().show();$("#pol_widget_tripType").val('ROUND_TRIP');}
if(!DeltaUtils.supportsPlaceholderAttr()){var selectorPattern="#air-shopping-widget-mainContent input[placeholder]";var $rootSearch=$(selectorPattern);$rootSearch.each(function(){if($(this).val()!=$(this).attr('placeholder')){$(this).removeClass('placeholder');}});}
$("form#flightSearchForm").validate().resetForm();});$(document).on('click','#cashBtn, #milesBtn',function(){if($(this).attr('id')=="cashBtn"){SimpleSearchWidget.processFieldsForAwardCheckbox('false');}else{SimpleSearchWidget.processFieldsForAwardCheckbox('true');}});$(document).on('click','#air-shopping-widget-mainContent #exactDaysBtn, #air-shopping-widget-mainContent #flexDaysBtn',function(){$("#air-shopping-widget-mainContent #exactDaysBtn,#air-shopping-widget-mainContent #flexDaysBtn").removeClass("trip-selected");$(this).addClass("trip-selected");if($(this).attr('id')=="exactDaysBtn"){$("#is_Flex_Search").val('false');}else{$("#is_Flex_Search").val('true');}});$(document).on('click.searchFlightResults','#close_image',function(){$("#originCity").removeClass("inputWrap_blue_border");$("#destinationCity").removeClass("inputWrap_blue_border");});$("#scroll_country, #scroll_airport, #scroll_stateProvince, #scroll_stateProvinceAirport, #scroll_alphabaticalAirport, #scroll_saved").tinyscrollbar({sizethumb:17});$(document).on('click.searchFlightResults','ul#recentSearches li',function(){resizeWidget.afterValidation();});$(document).on('click.searchFlightResults','li.recentInput',function(){depDate=$(this).attr("id").split("~")[2];retDate=$(this).attr("id").split("~")[3];$("#air-shopping-widget-mainContent #originCity").val($(this).attr("id").split("~")[0]).removeClass("greyColorTxt");$("#air-shopping-widget-mainContent #destinationCity").val($(this).attr("id").split("~")[1]).removeClass("greyColorTxt");$("#air-shopping-widget-mainContent #departureDate").val($(this).attr("id").split("~")[2]).removeClass("greyColorTxt");$("#air-shopping-widget-mainContent #returnDate").val($(this).attr("id").split("~")[3]).removeClass("greyColorTxt");var paxCount=$(this).attr("id").split("~")[5];$("#air-shopping-widget-mainContent #paxCount").val(paxCount);var tripTypeInit=$(this).attr("id").split("~")[4];var tripType=searchWidgetUtils.convertTripTypeForPol(tripTypeInit);$("#pol_widget_tripType").val(tripType);if(tripType=='ROUND_TRIP'){$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #roundTripBtn").addClass("trip-selected");$("#air-shopping-widget-mainContent #roundtripDateWrap").removeClass("oneWayHidden");$("#air-shopping-widget-mainContent #returnDate").show();$("#air-shopping-widget-mainContent #retDateCalIcon").parent().show();}else if(tripType=='ONE_WAY'){$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #oneWayBtn").addClass("trip-selected");$("#air-shopping-widget-mainContent #roundtripDateWrap").addClass("oneWayHidden");$("#air-shopping-widget-mainContent #returnDate").hide();$("#air-shopping-widget-mainContent #retDateCalIcon").parent().hide();}
$('#air-shopping-widget-mainContent #isDatesFlexible').attr('checked',false);var flexibleDates=$(this).attr("id").split("~")[6];$('#air-shopping-widget-mainContent #isDatesFlexible').val(flexibleDates);$("#air-shopping-widget-mainContent #exactDaysBtn,#air-shopping-widget-mainContent #flexDaysBtn").removeClass("trip-selected");if(flexibleDates=='checked'||flexibleDates=='true'){$("#air-shopping-widget-mainContent #flexDaysBtn").addClass("trip-selected");$("#is_Flex_Search").val('true');}else{$("#air-shopping-widget-mainContent #exactDaysBtn").addClass("trip-selected");$("#is_Flex_Search").val('false');}
var isBookAward=$(this).attr("id").split("~")[7];if(isBookAward=='checked'||isBookAward=='true'){SimpleSearchWidget.processFieldsForAwardCheckbox('true');}else{SimpleSearchWidget.processFieldsForAwardCheckbox('false');}
if(!DeltaUtils.supportsPlaceholderAttr()){var selectorPattern="#air-shopping-widget-mainContent input[placeholder]";var $rootSearch=$(selectorPattern);$rootSearch.each(function(){if($(this).val()!=$(this).attr('placeholder')){$(this).removeClass('placeholder');}});}
SearchWidget.hideSearchDiv();$("form#flightSearchForm").validate().resetForm();});});var SearchWidget={hideSearchDiv:function(){$('#recentSavedBox').slideUp(50);$('#air-shopping-widget-mainContent #recentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});},resetFields:function(){if($("#originCity").val()!="City or Airport"||$("#originCity").val()=="")
{}
if($("#destinationCity").val()!="City or Airport"||$("#destinationCity").val()=="")
{}
if($("#air-shopping-widget-mainContent #departureDate").val()!="Depart Date"||$("#destinationCity").val()=="")
{}
if($("#air-shopping-widget-mainContent #returnDate").val()!="Return Date"||$("#destinationCity").val()=="")
{}},checkPaxCount:function(val){if(val<2){$(".passCount-arrow-down").addClass("disabled");$(".passCount-arrow-up").removeClass("disabled");}else if(val>8){$(".passCount-arrow-up img").addClass("disabled");$(".passCount-arrow-down img").removeClass("disabled");}else if(isNaN(val)){$(".passCount-arrow-up").addClass("disabled");$(".passCount-arrow-down").addClass("disabled");}else{$(".passCount-arrow-up").removeClass("disabled");$(".passCount-arrow-down").removeClass("disabled");}},showSearch:function(from){var recentSavedFlag=$.trim($('#recentSavedFlag').html());if(recentSavedFlag=="Recent")
{$('.recent-saved-search').html('Recent Searches');$("#recentSearch").show();$('#recentSearch').css("border-bottom","none");SearchWidget.preFillSearchData();$('#recentSavedCont').show();}
else if(recentSavedFlag=="Saved")
{$('.recent-saved-search').html('Saved Searches');$('#savedSearch').show();$('#savedSearch').css("border-bottom","none");$('#recentSavedCont').show();}
else if(recentSavedFlag=="RecentSaved")
{$('.recent-saved-search').html('Recent and Saved Searches');$('#recentSearch, #savedSearch').show();SearchWidget.preFillSearchData();$('#recentSavedCont').show();}
setTimeout(function(){resizeWidget.afterValidation();},200);},preFillSearchData:function(){RecentSavedSearch.getCookieContent(function(c_data){var searchRecords=c_data.split("*");var firstSearchRecord=searchRecords[0].split("~");if(firstSearchRecord[0]!=null){$("#air-shopping-widget-mainContent #originCity").val(firstSearchRecord[0]);$("#air-shopping-widget-mainContent #originCity").removeClass("placeholder");}
if(firstSearchRecord[1]!=null){$("#air-shopping-widget-mainContent #destinationCity").val(firstSearchRecord[1]);$("#air-shopping-widget-mainContent #destinationCity").removeClass("placeholder");}
if(firstSearchRecord[2]!=null){var depDate=new Date(firstSearchRecord[2]);var inputDepDate=depDate.getMonth()+1+"/"+depDate.getDate()+"/"+depDate.getFullYear();if(inputDepDate.indexOf("NaN")==-1){$("#air-shopping-widget-mainContent #departureDate").val(inputDepDate);$("#air-shopping-widget-mainContent #departureDate").removeClass("placeholder");}}
if(firstSearchRecord[3]!=null&&firstSearchRecord[3]!=""&&firstSearchRecord[3]!="Return Date"){var retDate=new Date(firstSearchRecord[3]);var inputRetDate=retDate.getMonth()+1+"/"+retDate.getDate()+"/"+retDate.getFullYear();if(inputRetDate.indexOf("NaN")==-1){$("#air-shopping-widget-mainContent #returnDate").val(inputRetDate);$("#air-shopping-widget-mainContent #returnDate").removeClass("placeholder");}}
if(firstSearchRecord[4]!=null){var tripTypeInit=firstSearchRecord[4];var tripType=searchWidgetUtils.convertTripTypeForPol(tripTypeInit);$("#pol_widget_tripType").val(tripType);if(tripType!='null'&&tripType!=''&&tripType!='undefined'){$("#pol_widget_tripType").val(tripType);if(tripType.toLowerCase()=='round_trip')
{$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #roundTripBtn").addClass("trip-selected");$("#air-shopping-widget-mainContent #roundtripDateWrap").removeClass("oneWayHidden");$("#air-shopping-widget-mainContent #retDateCalIcon").parent().show();}else if(tripType.toLowerCase()=='one_way'){$("#air-shopping-widget-mainContent #roundTripBtn,#air-shopping-widget-mainContent #oneWayBtn").removeClass("trip-selected");$("#air-shopping-widget-mainContent #oneWayBtn").addClass("trip-selected");$("#air-shopping-widget-mainContent #returnDate").hide();$("#air-shopping-widget-mainContent #roundtrip_cal_icon").hide();$("#air-shopping-widget-mainContent #roundtripDateWrap").addClass("oneWayHidden");$("#air-shopping-widget-mainContent #retDateCalIcon").parent().hide();}}}
if(firstSearchRecord[5]!=null){$("#air-shopping-widget-mainContent #paxCount").val(firstSearchRecord[5]);}
if(firstSearchRecord[6]!=null){var flexibleDates=firstSearchRecord[6];$('#air-shopping-widget-mainContent #isDatesFlexible').val(flexibleDates);$("#air-shopping-widget-mainContent #exactDaysBtn,#air-shopping-widget-mainContent #flexDaysBtn").removeClass("trip-selected");if(flexibleDates=='checked'||flexibleDates=='true'){$("#air-shopping-widget-mainContent #flexDaysBtn").addClass("trip-selected");$("#is_Flex_Search").val('true');}else{$("#air-shopping-widget-mainContent #exactDaysBtn").addClass("trip-selected");$("#is_Flex_Search").val('false');}}
if(firstSearchRecord[7]!=null){var isBookAward=firstSearchRecord[7];if(isBookAward=='checked'||isBookAward=='true'){SimpleSearchWidget.processFieldsForAwardCheckbox('true');}else{SimpleSearchWidget.processFieldsForAwardCheckbox('false');}}});},hidePopups:function(){$("#recentSavedBox").slideUp(300);$('#recentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});}}
var searchWidgetUtils={setHiddenFields:function(){if($("#air-shopping-widget-mainContent #is_award_travel").val()=="true"){if($("#pol_widget_isRequestUpgrade").attr("checked")=="checked"){}
if($("#air-shopping-widget-mainContent #is_Flex_Search").val()=="true"){$("#pol_widget_awards_calendarSearch").val("true");$("#air-shopping-widget-mainContent #flexMainRTRTravelDate").val("on");}}else{if($("#pol_widget_isRequestUpgrade").attr("checked")=="checked"){}
if($("#air-shopping-widget-mainContent #is_Flex_Search").val()=="true"){$("#air-shopping-widget-mainContent #flexMainRTRTravelDate").val("on");}}},cleanUpInputs:function(){if($("#air-shopping-widget-mainContent #originCity").val().length!=3){$("#air-shopping-widget-mainContent #originCity").val("");}
if($("#air-shopping-widget-mainContent #destinationCity").val().length!=3){$("#air-shopping-widget-mainContent #destinationCity").val("");}
if($("#air-shopping-widget-mainContent #departureDate").val().split("/").length!=3){$("#air-shopping-widget-mainContent #departureDate").val("");}
if($("#air-shopping-widget-mainContent #returnDate").val().split("/").length!=3){$("#air-shopping-widget-mainContent #returnDate").val("");}},setFormMultiCitySearch:function(){$("#pol_widget_tripType").val("MULTICITY");SimpleSearchWidget.isMoreOptionsSearch=true;$("#flightSearchForm").attr("action",airShoppingDefaultHost+"/air-shopping/searchFlights.action?tripType=MULTICITY")
$("#flightSearchForm").submit();},setMoreOptionsSearch:function(){var tripType=$("#pol_widget_tripType").val();SimpleSearchWidget.isMoreOptionsSearch=true;var formAction=airShoppingDefaultHost+"/air-shopping/searchFlights.action?tripType="+tripType;$("#flightSearchForm").attr("action",formAction);$("#flightSearchForm").submit();},convertTripTypeForPol:function(tripType){if(tripType==="oneway"){return"ONE_WAY";}
if(tripType==="roundtrip"){return"ROUND_TRIP";}
if(tripType==="multicity"){return"MULTICITY";}
return tripType;},convertTripTypeForBAU:function(tripType){if(tripType==="ONE_WAY"){return"oneway";}
if(tripType==="ROUND_TRIP"){return"roundtrip";}
if(tripType==="MULTICITY"){return"multicity";}
return tripType;},setRecentSearch:true}
var AwardSearch={submitAwardSearch:function(){SimpleSearchWidget.getCustData();if(SimpleSearchWidget.loginSessionDataFound){if(SimpleSearchWidget.custData.loggedIn==true&&SimpleSearchWidget.custData.usernameType=="skymiles"&&SimpleSearchWidget.custData.medallionMbrInd=="1"){if($("#air-shopping-widget-mainContent #isTraveling").is(":checked")===true){$("#air-shopping-widget-mainContent #awards_medallionTraveler").val(SimpleSearchWidget.custData.medallionMbrInd);}}}
else{$("#air-shopping-widget-mainContent #awards_medallionTraveler").val("0");}
$("#air-shopping-widget-mainContent #awardTravel").val("true");return true;}}
$(document).on('click.searchFlightResults','#air-shopping-widget-mainContent #air-shopping-multicity-link, #air-shopping-widget-mainContent #air-shopping-moreOptions-link',function(){searchWidgetUtils.setRecentSearch=false;$("#flightSearchForm").validate().cancelSubmit=true;searchWidgetUtils.cleanUpInputs();if($(this).attr('id')=="air-shopping-multicity-link"){searchWidgetUtils.setFormMultiCitySearch();}else if($(this).attr('id')=="air-shopping-moreOptions-link"){searchWidgetUtils.setMoreOptionsSearch();}});$("#pol_widget_isRequestUpgrade").live("click",function(){if($("#pol_widget_isRequestUpgrade").attr("checked")!="checked"){$("#pol_widget_MUUpgrade").val("off");$("#pol_widget_showMUUpgrade").val("off");}else{$("#pol_widget_MUUpgrade").val("on");$("#pol_widget_showMUUpgrade").val("on");}});$("#air-shopping-widget-mainContent #isTraveling").on("click",function(){if($("#air-shopping-widget-mainContent #isTraveling").is(":checked")){$("#air-shopping-widget-mainContent #awards_iamtravelling").val("true");}else{$("#air-shopping-widget-mainContent #awards_iamtravelling").val("false");}});var resizeWidget={afterValidation:function(){if(!delta.navwidget.isDockedState()&&$("#air-shopping-widget").is(":visible")){setTimeout(function(){var widgetContainer=$("#widget-booking");widgetContainer.css("height",resizeWidget.getWidgetHeight());},10);}else{var widgetContainer=$("#widget-booking");widgetContainer.css("height","");}},getWidgetHeight:function(){var airShoppingContainer=$("#air-shopping-widget .widget-body");return airShoppingContainer.height()+airShoppingContainer.position().top+SimpleSearchWidget.recentSearchHeight+(!delta.navwidget.isDockedState()?0:27);}}
var DeltaGraph={config:null,definition:null,graph:{},copy:function(obj){if(null==obj||"object"!=typeof obj)return obj;var copy=obj.constructor();for(var attr in obj){if(obj.hasOwnProperty(attr))copy[attr]=obj[attr];}
return copy;},drawBar:function(paper,gLeft,gTop,gWidth,gHeight,maxUnits,bgColors,values,icons){var chart=paper.set(),boxWidth=Math.round(gWidth*0.8),boxHeight=Math.round(gHeight*0.9),boxLeft=gLeft+((gWidth-boxWidth)/2),boxTop=gTop+((gHeight-boxHeight)/2),left=boxLeft,unit=boxHeight/maxUnits,spacer=Math.round((boxWidth/values.length)*0.25),gBox=paper.rect(gLeft,gTop,gWidth,gHeight).attr({fill:"#ffffff",stroke:"#cccccc"}),box=paper.rect(boxLeft,boxTop,boxWidth,boxHeight).attr({gradient:"270-#eeeeee-#cccccc",stroke:"#333333"});chart.push(box);for(var x=unit*10;x<(maxUnits*unit);x+=unit*10){chart.push(paper.path("M"+boxLeft+" "+(boxTop+boxHeight-x)+"L"
+(boxLeft+boxWidth)+" "+(boxTop+boxHeight-x)).attr({stroke:"#999999"}));var text=paper.text(boxLeft,(boxTop+boxHeight-x),(x/unit)+"");text.translate(-(text.getBBox().width+(spacer*0.1)),text.getBBox().height/5);chart.push(text);};var drawBar=function(j){var val=values[j],bWidth=Math.round((boxWidth/values.length)*0.70),bHeight=Math.round(unit*val),bLeft=left+spacer,bTop=Math.round(boxTop+boxHeight-bHeight);chart.push(paper.rect(bLeft,bTop,bWidth,bHeight).attr({gradient:"0-#000000-#999999:20-#999999:80-#000000",stroke:"#333333"}));chart.push(paper.rect(bLeft,bTop,bWidth,bHeight).attr({fill:bgColors[j],stroke:"#333333",opacity:0.8}));chart.push(paper.image(icons[j].src,bLeft+(bWidth*0.25),bTop+3,icons[j].w,icons[j].h));left+=bWidth+spacer;};chart.push(paper.rect(boxLeft,boxTop,boxWidth,boxHeight).attr({stroke:"#333333","stroke-width":1}));for(var i=0;i<values.length;i++){drawBar(i);};return chart;},drawCarousel:function(paper,left,top,width,height,items,itemWidth,itemHeight,fontSize,textAttr,boxAttr,selectScale){var chart=paper.set();var rollItems=[],roller=paper.set(),selected=0;var RollItem=function(paper,image,text,fontSize,left,top,width,height,textAttr,boxAttr,selectScale){this.elements=paper.set();this.left=left;this.top=top;this.width=width;this.height=height;this.fontSize=fontSize;this.selectScale=selectScale?selectScale:1.5;var defaultText={"font-family":"Arial, Verdana, Times New Roman","font-size":"12px","fill":"#ffffff",stroke:"#000000","stroke-width":0,"font-weight":"bold"},defaultBox={"fill":"#ffffff","stroke":"#ffffff","stroke-width":0,opacity:0.5},itemWidth=width/this.selectScale,itemHeight=height/this.selectScale,itemLeft=left+((width-itemWidth)/2),itemTop=top+((height-itemHeight)/2);this.image=paper.image(image,itemLeft,itemTop,itemWidth,itemHeight);this.box=paper.rect(itemLeft,itemTop,itemWidth,itemHeight);this.text=paper.text(itemLeft+(itemWidth/2),itemTop+(itemHeight/2),text);this.box.attr(textAttr?textAttr:defaultBox);this.text.attr(boxAttr?boxAttr:defaultText);this.elements.push(this.image);this.elements.push(this.box);this.elements.push(this.text);this.selectItem=function(){this.box.attr({opacity:0});this.text.attr({"font-size":this.fontSize});this.elements.scale(this.selectScale,this.selectScale);};this.deselectItem=function(){this.box.attr(defaultBox);this.text.attr(defaultText);this.elements.scale(1,1);};};var selectItem=function(selIndex){rollItems[selected].deselectItem();rollItems[selIndex].selectItem();selected=selIndex;};var leftSpacer=left*0.25,topSpacer=top*0.25,itemLeft=left+leftSpacer,itemTop=top+topSpacer;for(var i=0;i<items.length;i++){var item=new RollItem(paper,items[i].src,items[i].text,fontSize,itemLeft,itemTop,itemWidth,itemHeight,textAttr,boxAttr,selectScale);itemLeft=itemLeft+itemWidth+leftSpacer;if(items[i].selected){selected=i;};rollItems.push(item);roller.push(item.elements);};selectItem(selected);roller.translate(left-rollItems[selected].left+itemWidth,0);chart.push(paper.rect(left,top,width-(left*2),height-(top*2)));var scrollMid=height/2,scrollTop=scrollMid-left,scrollBot=scrollMid+left,scrollWidth=left,leftScroll=paper.path(["M",0,scrollMid,"L",scrollWidth,scrollTop,"L",scrollWidth,scrollBot,"z"]),rightScroll=paper.path(["M",width,scrollMid,"L",width-scrollWidth,scrollTop,"L",width-scrollWidth,scrollBot,"z"]);leftScroll.attr({fill:"#cccccc"});rightScroll.attr({fill:"#cccccc"});rightScroll.click(function(event){this.attr({fill:"red"});if(selected<rollItems.length-1){selectItem(selected+1);roller.animate({translation:"-"+itemWidth+",0"},500,"elastic");};});leftScroll.click(function(event){this.attr({fill:"red"});if(selected>0){selectItem(selected-1);roller.animate({translation:itemWidth+",0"},500,"elastic");};});chart.push(roller);chart.push(leftScroll);chart.push(rightScroll);return chart;},drawCircleChart:function(paper,cx,cy,width,height,cHeight,values){var chart=paper.set(),icons=this.config.circles,textAttr=this.config.textAttr,drawCircle=function(paper,left,top,radius,image,text,bgColor,textAttr){var circle=paper.set(),centerX=left+radius,centerY=top+radius,iwidth=radius*2*0.7,iheight=iwidth,ix=centerX-(iwidth*0.5)+1,iy=centerY-(iheight*0.5)+1;circle.push(paper.circle(centerX,centerY,radius).attr({fill:bgColor,stroke:"","stroke-width":0}));if(image){circle.push(paper.image(image,ix,iy,iwidth,iheight));};var circleText=paper.text(centerX,top,text).attr(textAttr);var textHeight=circleText.getBBox().height||10;circleText.translate(0,-(textHeight*0.8));circle.push(circleText);return circle;},getIcon=function(name){if(icons&&icons.length>0){for(var i=0;i<icons.length;i++){if(icons[i].name==name){return icons[i];}}}
return null;},totalSize=0,cLeft=cx,spacer=width*0.14;for(var xx=0;xx<values.length;xx++){totalSize+=parseInt(values[xx].size);};for(var ii=0;ii<values.length;ii++){var icon=getIcon(values[ii].name),cWidth=(parseInt(values[ii].size)/totalSize)*cHeight*values.length*0.4,radius=parseInt(values[ii].size),cTop=cy+(height*0.5)-radius;if(icon&&icon.bgColor){chart.push(drawCircle(paper,cLeft,cTop,radius,icon.icon,values[ii].value,icon.bgColor,textAttr));}
cLeft+=cWidth+spacer;};if(cLeft<width){chart.translate((width-cLeft)/2,0);};return chart;},drawDotNav:function(paper,cx,cy,width,height,values,selDefault){var chart=paper.set(),bgColor=this.config.bgColor,selColor=this.config.selColor,selRadius=this.config.selDotRadius,radius=this.config.dotRadius,space=this.config.dotSpace,dotWidth=radius*2,dotHeight=radius*2,dotX=cx,dotY=height*0.5,drawDot=function(paper,left,top,callBack,title,id){var dot=paper.set();dot.push(paper.circle(left,top,radius).attr({fill:bgColor,stroke:"","stroke-width":0,href:callBack,title:title}).click(function(){selDot(id);}));dot.push(paper.circle(left,top,selRadius).attr({fill:selColor,stroke:"","stroke-width":0,href:callBack,title:title}));return dot;};function selectDot(dot){dot[0].hide();dot[1].show();};function deselectDot(dot){dot[0].show();dot[1].hide();};function selDot(id){for(var ii=0;ii<chart.length;ii++){if(id==ii){selectDot(chart[ii]);}else{deselectDot(chart[ii]);};};};for(var i=0;i<values.length;i++){chart.push(drawDot(paper,dotX,dotY,values[i].callBack,values[i].title,i));dotX+=dotWidth+space;if(values[i].selected&&values[i].selected=="Y"){selDefault=i;};};chart.translate((width-chart.getBBox().width)*0.1,0);selDot(selDefault);return chart;},drawPie:function(paper,cx,cy,r,bgColors,stroke,strokeWidth,tilt,values,icons,distMod){var rad=Math.PI/180,chart=paper.set();var radialShade=(paper.circle(cx,cy,r)).attr({gradient:"r#999999-#999999:85-#000000",stroke:stroke,"stroke-width":0,opacity:1});var sector=this.drawSector;var angle=tilt?tilt:0,total=0,start=0,process=function(j){var value=values[j],angleplus=360*value/total,popangle=angle+(angleplus/2),bcolor=bgColors?bgColors[j]:"#ffffff",p=sector(paper,cx,cy,r,angle,angle+angleplus,{fill:bcolor,stroke:stroke,"stroke-width":strokeWidth,opacity:0.8});p.toFront();if(icons){var icon=paper.image(icons[j].src,cx-(icons[j].w/2)+(r/distMod)*Math.cos(-popangle*rad),cy-(icons[j].h/2)+(r/distMod)*Math.sin(-popangle*rad),icons[j].w,icons[j].h);icon.toFront();}
angle+=angleplus;chart.push(p);start+=.1;};for(var i=0,ii=values.length;i<ii;i++){total+=values[i];}
for(var i=0;i<ii;i++){process(i);}
chart.push(radialShade);return chart;},drawSector:function(paper,cx,cy,r,startAngle,endAngle,params){var rad=Math.PI/180;var x1=cx+r*Math.cos(-startAngle*rad),x2=cx+r*Math.cos(-endAngle*rad),y1=cy+r*Math.sin(-startAngle*rad),y2=cy+r*Math.sin(-endAngle*rad);return paper.path(["M",cx,cy,"L",x1,y1,"A",r,r,0,+(endAngle-startAngle>180),0,x2,y2,"z"]).attr(params);},drawStatus:function(paper,cx,cy,width,height,value,units,unitText,baseColor,valueColor,lineColor,title){var chart=paper.set(),textAttr=this.config.textAttr,textY=this.config.textY,baseBack=paper.rect(cx,cy,width,height,height*.5),baseBar=paper.rect(cx,cy,width,height,height*.5),valueBack=paper.rect(cx,cy,width,height,height*.5),valueBar=paper.rect(cx,cy,width,height,height*.5).attr({title:title||""}),drawUnits=function(paper,cx,cy,width,height,units,unitText){var unitSet=paper.set(),unit=width/units,currX=cx+unit,unitOff=unit*0.20,textX=cx+unitOff,lineHeight=height*1.1,topY=cy+((height-lineHeight)/2),botY=cy+(lineHeight+(height-lineHeight)/2);while(currX<(cx+width-2)){unitSet.push(paper.path(["M",currX,topY,"L",currX,botY]).attr({stroke:lineColor,"stroke-width":2,opacity:0.8}));currX+=unit;};for(x=0;x<unitText.length;x++){var uText=paper.text(textX,(textY?textY:(cy+height*0.75)),unitText[x]).attr(textAttr);uText.translate(uText.getBBox().width*0.5,0);textX+=unit;}
return unitSet;},unitLines=drawUnits(paper,cx,cy,width,height,units,unitText);if(!isNaN(value)&&DeltaUtils.exists(value)&&value!==""){value=parseInt(value,10);valueBack.attr({"clip-rect":cx+","+cy+","+(width*(value/100))+","+height});valueBar.attr({"clip-rect":cx+","+cy+","+(width*(value/100))+","+height});}else{valueBack.attr({"clip-rect":cx+","+cy+","+(width*(100/100))+","+height});valueBar.attr({"clip-rect":cx+","+cy+","+(width*(100/100))+","+height});}
chart.push(baseBack.attr({fill:"90-#666666-#000000",stroke:"","stroke-width":0}));chart.push(baseBar.attr({fill:baseColor,"stroke-width":2,stroke:baseColor,opacity:0.8}));chart.push(valueBack.attr({fill:"90-#000000-#ffffff",stroke:"","stroke-width":0}));chart.push(valueBar.attr({fill:valueColor,stroke:"","stroke-width":0,opacity:0.8}));return chart;},drawText:function(paper,cx,cy,r,values,labels,maxLength,params,tilt){var rad=Math.PI/180,chart=paper.set();var angle=tilt?tilt:0,total=0,start=0,process=function(j){var value=values[j],angleplus=360*value/total,popangle=angle+(angleplus/2),rotate=angle-((popangle*2)-angleplus/2);var text=paper.text(cx,cy,(labels[j].length>maxLength?labels[j].substring(0,maxLength):labels[j]));text.attr(params);if(popangle>90&&popangle<270){text.translate(-(Math.round(r/1.6)),Math.round(text.getBBox().height*0.1));text.rotate(rotate+180,cx,cy);}else{text.translate(Math.round(r/1.6),Math.round(text.getBBox().height*0.05));text.rotate(rotate,cx,cy);}
text.toFront();angle+=angleplus;chart.push(text);start+=.1;};for(var i=0,ii=values.length;i<ii;i++){total+=values[i];}
for(var i=0;i<ii;i++){process(i);}
return chart;},drawTextBubble:function(paper,text,radius,color){var chart=paper.set(),colors=this.config.colors,defaultStyle={fill:"#ffffff",stroke:"","stroke-width":0,"font-family":"whitney-book","font-size":"31px","font-weight":"bold","letter-spacing":"-25px"},textStyle=this.config.textStyle||defaultStyle,hexColor="#003399",outline=this.config.outline,lineColor="#ffffff",lineThick=2,process=function(paper,text,radius,color,lineColor,lineThick){var bubble=paper.set(),shadowOff=.98,center=radius*shadowOff,shadowRadius=radius,outRadius=radius*shadowOff,innRadius=outRadius-(lineThick*2),dText=text.replace("\\n","\n");bubble.push(paper.circle(radius,radius,shadowRadius).attr({fill:"#cccccc",stroke:"","stroke-width":0,opacity:0.75}));bubble.push(paper.circle(center,center,outRadius).attr({fill:lineColor,stroke:"","stroke-width":0,opacity:0.25}));bubble.push(paper.circle(center,center,innRadius).attr({fill:"r#ffffff-"+color,stroke:"","stroke-width":0}));bubble.push(paper.circle(center,center,innRadius).attr({fill:color,stroke:"","stroke-width":0,opacity:0.5}));bubble.push(paper.text(center,center,dText).attr(textStyle).attr({fill:"#cccccc",opacity:0.5}));bubble.push(paper.text(center*shadowOff,center*shadowOff,dText).attr(textStyle).attr({title:dText}));return bubble;};if(colors){for(var i=0;i<colors.length;i++){if(colors[i].name==color){hexColor=colors[i].hex;};};};if(outline){if(outline.color){lineColor=outline.color;};if(outline.thickness){lineThick=outline.thickness;};}
chart.push(process(paper,text,radius,hexColor,lineColor,lineThick));return chart;},emptyHolder:function(){if(this.config.holder){$("#"+this.config.holder).empty();};},formatData:function($obj,$sub){var data=[];$($obj).each(function(){var g={};g.label=$.trim($("[title='label']",this).text());g.value=$.trim($("[title='value']",this).text());g.name=$.trim($("[title='name']",this).text());g.size=$.trim($("[title='size']",this).text());g.title=$.trim($("[title='title']",this).text());g.callBack=$.trim($("[title='callBack']",this).text());g.selected=$.trim($("[title='selected']",this).text());g.text=$.trim($("[title='text']",this).text());g.color=$.trim($("[title='color']",this).text());g.radius=parseInt($("[title='radius']",this).text());if(g.value||g.name||g.title||g.label||g.size||g.text){data.push(g);};});if($sub!=null&&$sub.length>0){for(var i=0;i<$sub.length;i++){data[i].sub=this.formatData($("tr, ul",$sub[i]));};};return data;},formatPageData:function($obj){var $data=$("[class='graphData']",$obj),$subData=$("[class='subData']",$obj),newDef={};newDef.data=this.formatData($data,$subData);this.definition=newDef;},getData:function(){if(this.definition!=null){if(this.definition.data!=null){return this.definition.data;}else if(this.definition.dataSource!=null){this.formatPageData(this.getDataSourcePage(this.definition.dataSourceId));}}},getDataFromPage:function(){var $pageData=$("#"+this.definition);this.definition.data=this.formatPageData($pageData);},getDefinition:function(){if(this.definition!=null){return this.definition;}},getInstance:function(){var copy=DeltaGraph.copy(DeltaGraph);copy.config=DeltaGraph.copy(this.config);copy.definition=DeltaGraph.copy(this.definition);copy.graph=DeltaGraph.copy(this.graph);return copy;},getLabels:function(data){var labels=[];for(var i=0;i<data.length;i++){labels.push(data[i].label);};return labels;},getSubLabels:function(data){var subLabels=[];for(var i=0;i<data.length;i++){var sub=data[i].sub;for(var ii=0;ii<sub.length;ii++){subLabels.push(sub[ii].value+" "+sub[ii].label);};};return subLabels;},getSubValues:function(data){var subValues=[];for(var i=0;i<data.length;i++){var value=data[i].value,val=[],total=0,subs=data[i].sub;for(var ii=0;ii<subs.length;ii++){val.push(subs[ii].value);total+=subs[ii].value;};for(var x=0;x<val.length;x++){subValues.push(Math.round(value*val[x]/total));};};return subValues;},getValues:function(data){var values=[];for(var i=0;i<data.length;i++){values.push(data[i].value);};return values;},makeBarGraph:function(){var config=this.config,paper=Raphael(config.holder,config.hWidth,config.hHeight),values=this.getValues(this.definition.data);this.graph.paper=paper;this.graph.bar=this.drawBar(paper,config.gLeft,config.gTop,config.gWidth,config.gHeight,config.maxUnits,config.bgColors,values,config.icons);},makeCarousel:function(){var config=this.config,paper=Raphael(config.holder,config.gWidth,config.gHeight),values=this.definition.data;this.graph.paper=paper;this.graph.carousel=this.drawCarousel(paper,config.gLeft,config.gTop,config.gWidth,config.gHeight,values,config.iWidth,config.iHeight,config.fontSize);},makeCircleChart:function(){var config=this.config,paper=Raphael(config.holder,config.width,config.height),values=this.definition.data;this.graph.paper=paper;this.graph.circleChart=this.drawCircleChart(paper,config.xPos,config.yPos,config.width,config.height,config.cHeight,values);},makeDotNav:function(){var config=this.config,paper=Raphael(config.holder,config.width,config.height),values=this.definition.data;this.graph.paper=paper;this.graph.dotNav=this.drawDotNav(paper,config.xPos,config.yPos,config.width,config.height,values,config.selDefault);},makeGraph:function(definition){this.setDefinition(definition);this.emptyHolder();if(this.config.graphType=="iconPie"){this.makeIconPie();}else if(this.config.graphType=="pizzaPie"){this.makePizzaPie();}else if(this.config.graphType=="barGraph"){this.makeBarGraph();}else if(this.config.graphType=="statusBar"){this.makeStatus();}else if(this.config.graphType=="carousel"){this.makeCarousel();}else if(this.config.graphType=="circleChart"){this.makeCircleChart();}else if(this.config.graphType=="dotNav"){this.makeDotNav();}else if(this.config.graphType=="textBubble"){this.makeTextBubble();}
return this;},makeIconPie:function(){var config=this.config,paper=Raphael(config.holder,config.hWidth,config.hHeight),values=this.getValues(this.definition.data);this.graph.paper=paper;this.graph.pie=this.drawPie(paper,config.xpos,config.ypos,config.radius,config.bgColors,"#cccccc",1,-45,values,config.icons,1.6);},makePizzaPie:function(){var config=this.config,data=this.definition.data,paper=Raphael(config.holder,config.hWidth,config.hHeight),tilt=-45,values=this.getValues(data),labels=this.getLabels(data),subLabels=this.getSubLabels(data),subValues=this.getSubValues(data),stroke="#cccccc";var chart=this.drawPie(paper,config.xpos,config.ypos,config.radius,config.bgColors,stroke,1,tilt,values,config.icons,1.05);chart.push(this.drawPie(paper,config.xpos,config.ypos,config.radius*0.9,null,stroke,1,tilt,values,null,null));chart.push(this.drawPie(paper,config.xpos,config.ypos,config.radius*0.35,config.bgColors,stroke,1,tilt,values,null,null));chart.push(this.drawText(paper,config.xpos,config.ypos,Math.round(config.radius*0.30),values,labels,15,{"font-family":"Arial, Verdana, Times New Roman","font-size":"14px","fill":"#ffffff",stroke:"#ffffff","stroke-width":0,"font-weight":"bold"},tilt));chart.push(this.drawText(paper,config.xpos,config.ypos,config.radius,subValues,subLabels,25,{"font-family":"Arial, Verdana, Times New Roman","font-size":"11px","fill":"#003366",stroke:"#003366","stroke-width":0,"font-weight":"bold"},tilt));this.graph.paper=paper;this.graph.pizza=chart;},makeStatus:function(){var config=this.config,data=this.definition.data,paper=Raphael(config.holder,config.hWidth,config.hHeight);this.graph.status=this.drawStatus(paper,config.xPos,config.yPos,config.width,config.height,this.getValues(data)[0],config.units,config.unitText,config.baseColor,config.valueColor,config.unitColor,config.title);},makeTextBubble:function(){var config=this.config,data=this.definition.data;if(data&&data.length>0){var width=data[0].radius*2,height=width,paper=Raphael(config.holder,width,height);this.config.paper=paper;this.graph.textBubble=this.drawTextBubble(this.config.paper,data[0].text,data[0].radius,data[0].color);}},renderGraph:function(dataId){var graphs=[];$("[id^="+dataId+"]").each(function(){var $configObj=$("ul[class='graphConfig']",this);if($configObj){var $config=$.trim($configObj.text());DeltaGraph.setConfig(window[$config]);DeltaGraph.config.holder=this.id;}
DeltaGraph.makeGraph(this.id);graphs.push(DeltaGraph.getInstance());});return graphs;},redraw:function(graph){DeltaGraph.setConfig(graph.config);DeltaGraph.makeGraph(graph.definition);},setConfig:function(config){this.config=config;},setDefinition:function(definition){this.definition=definition;if(definition.data==null){this.getDataFromPage();}}};var MyDeltaOmnitureTracking={trackErrors:function(error){s.linkTrackEvents="event28";s.linkTrackVars="prop19, prop20";s.events="event28";s.prop19=error.errorCode;s.tl(true,"o",error.linkName);},trackClickedLinks:function(clickedLink){UserTracking.doCustomLinkTrack(s,{linkName:'btnGoToMyDel'});}};var loadingPosition={top:"myDeltaSummaryTracker",bottom:"myDeltaSummaryUpcomingTrips"};var UserMyDeltaSummary={customerId:"",skymilesNumber:"",isIROP:false,isCheckinElig:false,origin:"",destination:"",departureDate:"",departureTime:"",confirmationNumber:"",tripView:""};if(typeof(CustomerInfo)!="undefined"){CustomerInfo.setData(UserMyDeltaSummary,"myDelta");}
var mqmStatusConfig={graphType:"statusBar",holder:"statusHolder",title:"Medallion Qualification Miles",hWidth:280,hHeight:20,xPos:5,yPos:5,width:272,height:12,units:5,baseColor:"#b4c4d4",valueColor:"#3399cc",unitColor:"#ffffff",textAttr:{fill:"#ffffff","font-size":"8px","stroke-width":0}};var mqsStatusConfig={graphType:"statusBar",holder:"statusHolder",title:"Medallion Qualification Segments",hWidth:280,hHeight:20,xPos:5,yPos:5,width:272,height:12,units:5,baseColor:"#b4c4d4",valueColor:"#3399cc",unitColor:"#ffffff",textAttr:{fill:"#ffffff","font-size":"8px","stroke-width":0}};var graphConfig={mqm:"",container:"mqm_status_bar",threshold:""};var mqsGraphConfig={mqs:"",container:"mqs_status_bar",threshold:""};var MyDeltaSummaryWidget=function(){var pub={};var _self=this;var storedData={};var UpcomingTripJSONData=null;var upcomingTripsContainer="myDeltaSummaryUpcomingTrips";var trackerContainer="myDeltaSummaryTracker";var hasInit=false;var hasUpcomingTripJSON=false;var msgObj={responseText:""};pub.initMyDeltaSummaryJSON=function(){if(!hasInit){$.post("/mydelta/displayMyDeltaSummary",function(data){$("#mydelta_summary_widget_container").html(data);displayWidgetTracker(displayUpcomingTripSummary);});}};function initButtons(){var objs=$('button.ui-button, input.ui-button, a.ui-button');if(objs.length){objs.each(function(ind,ele){var icons={},hasicons=false;icons.primary=$(ele).data('icon-left');icons.secondary=$(ele).data('icon-right');hasIcons=!!icons.primary||!!icons.secondary;if(hasIcons){$(ele).button({text:true,icons:icons});}else{$(ele).button();}});}};function renderSummaryContent(container,template,response){var renderData=response;$("#"+container).html($("#"+template).render(renderData));};pub.isLoginException=function(message){if($.trim(message)=="Error 500: Customer Login exception encountered."){return true;}
return false;};function displayTracker(callback){$.ajax({url:"/mydelta/summaryTrackerJSRender",type:'POST',cache:false,timeout:90000,headers:{"cache-control":"no-cache"},success:function(response){storeTrackerData(response);getTrackerJSON(callback);},error:function(jqXHR,textStatus,errorThrown){hasInit=false;if(errorThrown!=""&&errorThrown!=null&&errorThrown!="undefined"){msgObj.responseText="We're sorry. We can't show your medallion tracker right now. Please try again later.";renderSummaryContent(trackerContainer,"deltaSummaryErrorTemplate",msgObj);setErrorDefinition("Load Failure","My Delta Summary");}}});}
function getTrackerJSON(callback){$.ajax({url:"/mydelta/json/getDeltaTrackerSummaryJSON",dataType:'json',type:'POST',cache:false,timeout:90000,headers:{"cache-control":"no-cache"},success:function(response){renderTracker(response);if(callback){callback();}},error:function(jqXHR,textStatus,errorThrown){hasUpcomingTripJSON=false;if(errorThrown!=""&&errorThrown!=null&&errorThrown!="undefined"){msgObj.responseText="We're sorry. We can't show your medallion tracker right now. Please try again later.";renderSummaryContent(trackerContainer,"deltaSummaryErrorTemplate",msgObj);setErrorDefinition("Load Failure","My Delta Summary");}}});}
function renderTracker(response){graphConfig.mqm=response.tracker.currentMqmBalance;mqsGraphConfig.mqs=response.tracker.mqSegmentBalance;var flags={};if(graphConfig.mqm==null){flags.showMqm=false;}else{flags.showMqm=true;}
response.flags=flags;handleTrackerJSONResponse(response);}
function handleTrackerJSONResponse(response){$("#"+trackerContainer).empty();$("#"+trackerContainer).html(storedData.tracker);if(response.tracker){renderSummaryContent(trackerContainer,"TrackerSummaryTemplate",response);loadTrackerSummary();}else{msgObj.responseText="We're sorry. We can't show your medallion tracker right now. Please try again later.";renderSummaryContent(trackerContainer,"deltaSummaryErrorTemplate",msgObj);setErrorDefinition("Load Failure","My Delta Summary");}};function displayUpcomingTripSummary(){if(!hasInit){$.ajax({url:"/mydelta/summaryUpcomingTripsJSRender",type:'POST',cache:false,timeout:90000,headers:{"cache-control":"no-cache"},success:function(response){storeUpcomingTripsData(response);getUpcomingTripJSON();hasInit=true;},error:function(jqXHR,textStatus,errorThrown){hasInit=false;if(errorThrown!=""&&errorThrown!=null&&errorThrown!="undefined"){msgObj.responseText="We're sorry. We can't show your upcoming trips right now. Please try again later.";renderSummaryContent(upcomingTripsContainer,"deltaSummaryErrorTemplate",msgObj);setErrorDefinition("Load Failure","My Delta Summary");}}});}}
function storeUpcomingTripsResponse(response){UpcomingTripJSONData=response;};function handleGetUpcomingTripJSONResponse(response){storeUpcomingTripsResponse(response);$("#"+upcomingTripsContainer).empty();$("#"+upcomingTripsContainer).html(storedData.upcomingTrips);if(UpcomingTripJSONData.trips){setUserData();setUpcomingTripFlags();renderSummaryContent(upcomingTripsContainer,"UpcomingTripSummaryTemplate",response);loadTripSummary();}else{msgObj.responseText="We're sorry. We can't show your upcoming trips right now. Please try again later.";renderSummaryContent(upcomingTripsContainer,"deltaSummaryErrorTemplate",msgObj);setErrorDefinition("Load Failure","My Delta Summary");}};function setUserData(){UserMyDeltaSummary.skymilesNumber=UpcomingTripJSONData.trips.skymilesNumber;UserMyDeltaSummary.isIROP=UpcomingTripJSONData.trips.iropAlert;UserMyDeltaSummary.isCheckinElig=UpcomingTripJSONData.trips.checkinEligible;UserMyDeltaSummary.origin=UpcomingTripJSONData.trips.flightOrigin;UserMyDeltaSummary.destination=UpcomingTripJSONData.trips.flightDestination;UserMyDeltaSummary.departureDate=UpcomingTripJSONData.trips.flightDate;UserMyDeltaSummary.departureTime=UpcomingTripJSONData.trips.flightTime;UserMyDeltaSummary.confirmationNumber=UpcomingTripJSONData.trips.confirmationNumber;UserMyDeltaSummary.tripView="plane";if(UpcomingTripJSONData.trips.showFlight){UserMyDeltaSummary.tripView="plane";}else if(UpcomingTripJSONData.trips.showCar){UserMyDeltaSummary.tripView="car";}else if(UpcomingTripJSONData.trips.showHotel){UserMyDeltaSummary.tripView="hotel";}};function setUpcomingTripFlags(){var flags={};if(!UpcomingTripJSONData.trips.noUpcomingTrips){flags.showTripSummary=true;}else{flags.showTripSummary=false;}
if(UpcomingTripJSONData.trips.additionalTrips>0){flags.hasAdditionalTrips=true;if(UpcomingTripJSONData.trips.additionalTrips==1){flags.multipleAdditionalTrips=false;}else{flags.multipleAdditionalTrips=true;}}else{flags.hasAdditionalTrips=false;flags.multipleAdditionalTrips=false;};if(UpcomingTripJSONData.trips.cars.length>0){flags.carSize=UpcomingTripJSONData.trips.cars.length-1;if(UpcomingTripJSONData.trips.cars.length>=1){flags.singleCar=true;}}
if(UpcomingTripJSONData.trips.hotels.length>0){flags.hotelSize=UpcomingTripJSONData.trips.hotels.length;flags.hotelSizeLessFour=UpcomingTripJSONData.trips.hotels.length-4;if(UpcomingTripJSONData.trips.hotels.length==1){flags.singleHotel=true;}
else if(UpcomingTripJSONData.trips.hotels.length>1){if(UpcomingTripJSONData.trips.hotels.length>4){flags.showAdditionalHotel=true;}
if(UpcomingTripJSONData.trips.hotels.length>=6){flags.hotelOthers=true;}
flags.hotel1=UpcomingTripJSONData.trips.hotels[0];flags.hotel2=UpcomingTripJSONData.trips.hotels[1];flags.hotel3=UpcomingTripJSONData.trips.hotels[2];flags.hotel4=UpcomingTripJSONData.trips.hotels[3];}}
UpcomingTripJSONData.flags=flags;};function getUpcomingTripJSON(){try{$.views.allowCode=true;}catch(e){}
if(hasUpcomingTripJSON){return;}
hasUpcomingTripJSON=true;$.ajax({url:"/mydelta/json/getDeltaUpcomingTripsSummaryJSON",dataType:'json',type:'POST',timeout:90000,cache:false,headers:{"cache-control":"no-cache"},success:function(response){handleGetUpcomingTripJSONResponse(response);},error:function(jqXHR,textStatus,errorThrown){hasUpcomingTripJSON=false;if(textStatus==="timeout"||(errorThrown!=""&&errorThrown!=null&&errorThrown!="undefined")){msgObj.responseText="We're sorry. We can't show your upcoming trips right now. Please try again later.";renderSummaryContent(upcomingTripsContainer,"deltaSummaryErrorTemplate",msgObj);setErrorDefinition("Load Failure","My Delta Summary");}}});};function storeUpcomingTripsData(data){storedData.upcomingTrips=data;};function storeTrackerData(data){storedData.tracker=data;};pub.gotoMyTrips=function(){location.href="/mytrips/findPnrList?skyMilesNo="+UserMyDeltaSummary.skymilesNumber+"&loggedInMyDelta=Y";};pub.gotoDashboard=function(){location.href="/mydelta/dashboard";};pub.gotoMySkymiles=function(){location.href="/acctactvty/myskymiles.action";};pub.selectDetails=function(tripView){MyDeltaSummaryWidget.resetFocusIcon();MyDeltaSummaryWidget.focusIcon(tripView);MyDeltaSummaryWidget.switchTripView(tripView);};function getSummaryHigherTierLevel(mqm,mqs){var higher=null;if(mqm>mqs){higher=mqm;}else if(mqs>mqm){higher=mqs;}else{higher=mqm;}
return higher;}
function getSummaryLevelThreshold(mqm,mqs){var silver=1;var gold=2;var platinum=3;var diamond=4;var diamondUp=5;var mqmtier=null;var mqstier=null;if(mqm<=25000){mqmtier=silver;}else if(mqm<=50000){mqmtier=gold;}else if(mqm<=75000){mqmtier=platinum;}else if(mqm<=125000){mqmtier=diamond;}else if(mqm>125000){mqmtier=diamondUp;}
if(mqs<=30){mqstier=silver;}else if(mqs<=60){mqstier=gold;}else if(mqs<=100){mqstier=platinum;}else if(mqs<=140){mqstier=diamond;}else if(mqs>140){mqstier=diamondUp;}
var higherLevel=getSummaryHigherTierLevel(mqmtier,mqstier);var medallionLevel=higherLevel;this.graphConfig.threshold=medallionLevel;this.mqsGraphConfig.threshold=medallionLevel;return medallionLevel;}
function loadTrackerSummary(){var mqmNonFormatted=$("#current_miles").html();var mqsNonFormatted=$("#current_mqSegment").html();var mqmFormatted=MyDeltaSummaryWidget.addCommas(mqmNonFormatted);var mqsFormatted=MyDeltaSummaryWidget.addCommas(mqsNonFormatted);$("#current_miles").html(mqmFormatted);$("#current_mqSegment").html(mqsFormatted);var mqmBal=mqmNonFormatted;var mqsBal=mqsNonFormatted;var level=getSummaryLevelThreshold(mqmBal,mqsBal);var silverLvl="SILVER";var goldLvl="GOLD";var platinumLvl="PLATINUM";var diamondLvl="DIAMOND";var mqmSilThreshold=25000;var mqmGoldThreshold=50000;var mqmPlatThreshold=75000;var mqmDiaThreshold=125000;var mqsSilThreshold=30;var mqsGoldThreshold=60;var mqsPlatThreshold=100;var mqsDiaThreshold=140;if(level==1){var mqmDiff=mqmSilThreshold-mqmBal;mqmDiff=MyDeltaSummaryWidget.addCommas(mqmDiff);$("#mqm_summary").append(mqmDiff);$("#mqm_nxtLevel").append(silverLvl);var mqsDiff=mqsSilThreshold-mqsBal;mqsDiff=MyDeltaSummaryWidget.addCommas(mqsDiff);$("#mqs_summary").append(mqsDiff);$("#mqs_nxtLevel").append(silverLvl);}else if(level==2){var mqmDiff=mqmGoldThreshold-mqmBal;mqmDiff=MyDeltaSummaryWidget.addCommas(mqmDiff);$("#mqm_summary").append(mqmDiff);$("#mqm_nxtLevel").append(goldLvl);var mqsDiff=mqsGoldThreshold-mqsBal;mqsDiff=MyDeltaSummaryWidget.addCommas(mqsDiff);$("#mqs_summary").append(mqsDiff);$("#mqs_nxtLevel").append(goldLvl);}else if(level==3){var mqmDiff=mqmPlatThreshold-mqmBal;mqmDiff=MyDeltaSummaryWidget.addCommas(mqmDiff);$("#mqm_summary").append(mqmDiff);$("#mqm_nxtLevel").append(platinumLvl);var mqsDiff=mqsPlatThreshold-mqsBal;mqsDiff=MyDeltaSummaryWidget.addCommas(mqsDiff);$("#mqs_summary").append(mqsDiff);$("#mqs_nxtLevel").append(platinumLvl);}else if(level==4){var mqmDiff=mqmDiaThreshold-mqmBal;mqmDiff=MyDeltaSummaryWidget.addCommas(mqmDiff);$("#mqm_summary").append(mqmDiff);$("#mqm_nxtLevel").append(diamondLvl);var mqsDiff=mqsDiaThreshold-mqsBal;mqsDiff=MyDeltaSummaryWidget.addCommas(mqsDiff);$("#mqs_summary").append(mqsDiff);$("#mqs_nxtLevel").append(diamondLvl);}else{$("#mqm_summary, #mqs_summary").append("0");$("#mqm_nxtLevel, #mqs_nxtLevel").append(diamondLvl);}
mqmGraph.initGraph(graphConfig,true);mqsSegmentGraph.initGraph(mqsGraphConfig,true);initButtons();MyDeltaSummaryWidget.setCustomerInfo(UserMyDeltaSummary);MyDeltaSummaryWidget.statusBarTextHeight();var counter=0,classes=$(".mqmGraphShow, .mqsGraphShow");function showDiv(){classes.hide().filter(function(index){return index==counter%2;}).fadeIn();counter++;};showDiv();var timerId=setInterval(function(){showDiv();},5*1000);$("#mqs_status_bar, #mqm_status_bar").click(function(){showDiv();clearInterval(timerId);timerId=setInterval(function(){showDiv();},5*1000);});}
function loadTripSummary(){$("#loadingImage").hide();try{MyDeltaSummaryWidget.switchTripView(UserMyDeltaSummary.tripView);}catch(error){}};pub.setCustomerInfo=function(UserMyDeltaSummary){try{if(parent.CustomerInfo){parent.CustomerInfo.setIropState(UserMyDeltaSummary.isIROP);}}catch(error){}};pub.switchTripView=function(showTrip){MyDeltaSummaryWidget.switchTripContents(showTrip);MyDeltaSummaryWidget.focusIcon(showTrip);};pub.switchTripContents=function(showTrip){$("[id^='trip_content_']").each(function(){if(showTrip&&$(this).attr("id")=="trip_content_"+showTrip){$(this).show();}else{$(this).hide();};});};pub.focusIcon=function(icon){element=($("#"+icon));$(element).addClass("selected");};pub.resetFocusIcon=function(){$(".tripIconDiv").each(function(){$(this).removeClass("selected");});};pub.statusBarTextHeight=function(){var $text=$('#mqm_status_bar').find("text");var $text_mqs=$('#mqs_status_bar').find("text");$text.each(function(i){xAttr=$(this).attr('x');yAttr=$(this).attr('y');xAttr=parseInt(xAttr,10);yAttr=parseInt(yAttr,10)-2;$(this).attr('x',xAttr);$(this).attr('y',yAttr);});$text_mqs.each(function(i){xAttr=$(this).attr('x');yAttr=$(this).attr('y');xAttr=parseInt(xAttr,10);yAttr=parseInt(yAttr,10)-2;$(this).attr('x',xAttr);$(this).attr('y',yAttr);});};pub.addCommas=function(nStr){nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;};return pub;}();var mqmGraph={graphConfig:{},mqmPercentage:null,mqmLabel:null,graphUnits:{general:[0,5,10,15,20],silver:[25,30,35,40,45],gold:[50,55,60,65,70],platinum:[75,85,95,105,115],diamond:[125]},altGraphUnits:{general:[0,5,10,15,20],silver:[0,10,20,30,40],gold:[0,15,30,45,60],platinum:[0,25,50,75,100],diamond:[125]},initGraph:function(graphConfig,showMembership){this.graphConfig=graphConfig;this.setProgressBarUnits(showMembership);this.generateProgressBar();DeltaGraph.renderGraph(graphConfig.container);},setGraphConfig:function(){var mqm=this.graphConfig.mqm/1000;var graph={};if(mqm>=this.graphUnits.general[0]&&mqm<this.graphUnits.silver[0]){graph.label="silver";graph.unitText=this.graphUnits.general;}
else if(mqm>=this.graphUnits.silver[0]&&mqm<this.graphUnits.gold[0]){graph.label="gold";graph.unitText=this.graphUnits.silver;}
else if(mqm>=this.graphUnits.gold[0]&&mqm<this.graphUnits.platinum[0]){graph.label="platinum";graph.unitText=this.graphUnits.gold;}
else if(mqm>=this.graphUnits.platinum[0]&&mqm<this.graphUnits.diamond[0]){graph.label="diamond";graph.unitText=this.graphUnits.platinum;}
else if(mqm>=this.graphUnits.diamond[0]){graph.label="115";graph.unitText=this.graphUnits.platinum;this.generateMessage();}
this.graphConfig.unitText=graph.unitText;this.graphConfig.units=graph.unitText.length;this.mqmLabel=graph.label;},setAltGraphConfig:function(){var graphUnits=this.altGraphUnits;var levelThreshold=this.graphConfig.threshold;var graph={};if(levelThreshold==1){graph.label="silver";graph.unitText=graphUnits.general;}
else if(levelThreshold==2){graph.label="gold";graph.unitText=graphUnits.silver;}
else if(levelThreshold==3){graph.label="platinum";graph.unitText=graphUnits.gold;}
else if(levelThreshold==4){graph.label="diamond";graph.unitText=graphUnits.platinum;}
else{graph.label="diamond";graph.unitText=graphUnits.platinum;this.generateMessage();}
this.graphConfig.unitText=graph.unitText;this.graphConfig.units=graph.unitText.length;this.mqmLabel=graph.label;},setMqmPercentage:function(){var lastIndex=this.graphConfig.unitText.length-1;var milesPerLevel=this.graphConfig.unitText[1]-this.graphConfig.unitText[0];if(this.graphConfig.mqm>=(this.graphUnits.diamond[0]*1000)){this.mqmPercentage=100;}else{var totalMqmRequiredInThisLevel=(this.graphConfig.unitText[lastIndex]+milesPerLevel)*1000;var mqmAcquiredInThisLevel=this.graphConfig.mqm-(this.graphConfig.unitText[0]*1000);var actualMqmRequiredInThisLevel=totalMqmRequiredInThisLevel-(this.graphConfig.unitText[0]*1000);var mqmPercentage=mqmAcquiredInThisLevel/actualMqmRequiredInThisLevel*100;this.mqmPercentage=mqmPercentage;}},setProgressBarUnits:function(showMembership){var mqmLevel=getMQMLevel(this.graphConfig.mqm);if(mqmLevel==this.graphConfig.threshold){this.setGraphConfig();}else{this.setAltGraphConfig();}
this.setMqmPercentage();if(showMembership){this.showLabelAsUnitText();}
mqmStatusConfig.unitText=this.graphConfig.unitText;mqmStatusConfig.units=this.graphConfig.unitText.length;},showLabelAsUnitText:function(){var index=this.graphConfig.unitText.length-1;this.graphConfig.unitText[index]=this.mqmLabel.toUpperCase();},generateProgressBar:function(){$container=$("#"+this.graphConfig.container);$container.children(".graphData").children("li").html(this.mqmPercentage);},generateMessage:function(){}};var mqsSegmentGraph={graphConfig:{},mqsPercentage:null,mqsLabel:null,graphUnits:{mqsGeneral:[0,5,10,15,20,25],mqsSilver:[30,35,40,45,50,55],mqsGold:[60,65,70,75,80,85,90,95],mqsPlatinum:[100,105,110,115,120,125,130,135],mqsDiamond:[140]},altGraphUnits:{mqsGeneral:[0,5,10,15,20,25],mqsSilver:[0,10,20,30,40,50],mqsGold:[0,20,40,60,80],mqsPlatinum:[0,20,40,60,80,100,120],mqsDiamond:[140]},initGraph:function(graphConfig,showMembership){this.graphConfig=graphConfig;this.setProgressBarUnits(showMembership);this.generateProgressBar();DeltaGraph.renderGraph(graphConfig.container);},setGraphConfig:function(){var mqs=this.graphConfig.mqs;var graph={};if(mqs<30){graph.unitText=this.graphUnits.mqsGeneral;}else if(mqs>=this.graphUnits.mqsSilver[0]&&mqs<this.graphUnits.mqsGold[0]){graph.unitText=this.graphUnits.mqsSilver;}else if(mqs>=this.graphUnits.mqsGold[0]&&mqs<this.graphUnits.mqsPlatinum[0]){graph.unitText=this.graphUnits.mqsGold;}else if(mqs>=this.graphUnits.mqsPlatinum[0]&&mqs<this.graphUnits.mqsDiamond[0]){graph.unitText=this.graphUnits.mqsPlatinum;}else if(mqs>this.graphUnits.mqsDiamond[0]){graph.unitText=this.graphUnits.mqsPlatinum;}
this.graphConfig.unitText=graph.unitText;this.graphConfig.units=graph.unitText.length;this.mqsLabel=graph.label;},setAltGraphConfig:function(){var graphUnits=this.altGraphUnits;var levelThreshold=this.graphConfig.threshold;var graph={};if(levelThreshold==1){graph.unitText=graphUnits.mqsGeneral;}else if(levelThreshold==2){graph.unitText=graphUnits.mqsSilver;}else if(levelThreshold==3){graph.unitText=graphUnits.mqsGold;}else if(levelThreshold==4){graph.unitText=graphUnits.mqsPlatinum;}else{graph.unitText=graphUnits.mqsPlatinum;}
this.graphConfig.unitText=graph.unitText;this.graphConfig.units=graph.unitText.length;this.mqsLabel=graph.label;},getLastUnitValue:function(arrayOfUnits){var lastIndex=arrayOfUnits.length-1;return arrayOfUnits[lastIndex];},setMqsPercentage:function(){if(this.graphConfig.mqs>140){this.mqsPercentage=100;}else{var mqsTotalInThisLevel=this.graphConfig.unitText[0]-(this.graphConfig.unitText[this.graphConfig.units-1]+5);var mqsAcquiredInThisLevel=this.graphConfig.unitText[0]-this.graphConfig.mqs;this.mqsPercentage=(mqsAcquiredInThisLevel/mqsTotalInThisLevel)*100;}},setProgressBarUnits:function(showMembership){var mqsLevel=getMQSLevel(this.graphConfig.mqs);if(mqsLevel==this.graphConfig.threshold){this.setGraphConfig();}else{this.setAltGraphConfig();}
this.setMqsPercentage();mqsStatusConfig.unitText=this.graphConfig.unitText;mqsStatusConfig.units=this.graphConfig.unitText.length;},showLabelAsUnitText:function(){var index=this.graphConfig.unitText.length-1;this.graphConfig.unitText[index]=this.mqsLabel.toUpperCase();},generateProgressBar:function(){$container=$("#"+this.graphConfig.container);$container.children(".graphData").children("li").html(this.mqsPercentage);},generateMessage:function(){}};function mydeltaLinksTracking(clicked){try{var pageName=$("title").text();var linkClick=pageName+": "+$(clicked).attr('id');MyDeltaOmnitureTracking.trackClickedLinks(linkClick);}catch(e){}};function setErrorDefinition(errorCode,linkName){try{var error={errorCode:errorCode,linkName:linkName};MyDeltaOmnitureTracking.trackErrors(error);}catch(e){}};function getMQMLevel(mqm){if(mqm<25000){mqmtier=SkymilesLevel.silver.value;}else if(mqm<50000){mqmtier=SkymilesLevel.gold.value;}else if(mqm<75000){mqmtier=SkymilesLevel.platinum.value;}else if(mqm<125000){mqmtier=SkymilesLevel.diamond.value;}else if(mqm>=125000){mqmtier=SkymilesLevel.diamondUp.value;}
return mqmtier;};function getMQSLevel(mqs){if(mqs<30){mqstier=SkymilesLevel.silver.value;}else if(mqs<60){mqstier=SkymilesLevel.gold.value;}else if(mqs<100){mqstier=SkymilesLevel.platinum.value;}else if(mqs<140){mqstier=SkymilesLevel.diamond.value;}else if(mqs>=140){mqstier=SkymilesLevel.diamondUp.value;}
return mqstier;};var SkymilesLevel={silver:{value:1,label:"SILVER",mqsthreshold:30,mqmthreshold:25000},gold:{value:2,label:"GOLD",mqsthreshold:60,mqmthreshold:50000},platinum:{value:3,label:"PLATINUM",mqsthreshold:100,mqmthreshold:75000},diamond:{value:4,label:"DIAMOND",mqsthreshold:140,mqmthreshold:125000},diamondUp:{value:5,label:"DIAMOND",mqsthreshold:140,mqmthreshold:125000},getByLevel:function(level){for(var key in SkymilesLevel){var object=SkymilesLevel[key];if(object&&object.value&&object.value==level){return object;}}}};function adjustMyDeltaSummaryWidgetHeight(isTrackerLoaded){if(isTrackerLoaded){if(!delta.navwidget.isDockedState()){$('#widget-mydelta').css('height','285px');}}else{if($('#myDeltaSummary_trip').size()>0){if(delta.navwidget.isDockedState()){$('#widget-mydelta').css('height','');$('#widget-mydelta').css('min-height','415px');}else{$('#widget-mydelta').css('height','');$('#widget-mydelta').css('min-height','350px');}}}};var trackerFontFamilyVar="'Lucida Grande','Lucida Sans Unicode'";var trackerUserIE=$.browser.msie&&$.browser.version<9;function stripedRect(paper,x1,y1,width,height,options){options=options||{};var boxEl=paper.rect(x1,y1,width,height);boxEl.attr({"stroke-width":"0"});var xShift=options.lineSpacing||10;var angle=options.angle||45;var radians=(90-angle)*(Math.PI/180);var yShift=xShift/Math.tan(radians);var moveX=x1,moveY=y1,finalX=x1+width,finalY=y1+height,lineX=x1,lineY=y1,pathString=[];while(moveX<finalX){moveX+=xShift;lineY+=yShift;if(lineY>finalY){lineX+=xShift;lineY=finalY;}
if(moveX>finalX){moveY+=yShift;moveX=finalX;}
pathString=pathString.concat(['M',moveX,moveY,'L',lineX,lineY]);}
while(moveY<finalY){moveY+=yShift;lineX+=xShift;if(lineX>finalX){lineY+=yShift;lineX=finalX;}
if(lineX>x1&&lineY<finalY){lineY+=yShift;lineX=x1;}
if(lineY>finalY){lineY=finalY;}
pathString=pathString.concat(['M',moveX,moveY,'L',lineX,lineY]);if(moveY+yShift>finalY){break;}}
var stripe=paper.path(pathString);var collection=paper.set();collection.push(boxEl,stripe);return collection;}
var widgetGraphData=null;function mockWidgetData(){return{"faultDO":{"alerts":[],"status":"SUCCESS"},"loyaltyAccount":{"corporateAgreementInfos":[],"lifetimeMQM":1389178,"membershipStatusInfo":{"currentProgramYear":"2013","currentYearMqm":{"availableBalance":85931,"maxForCurrentTier":125000,"minForCurrentTier":75000,"neededForNextTier":39069,"percentTowardsHighestTier":82.85714285714286,"percentTowardsNextTier":68.7448},"currentYearMqs":{"availableBalance":116,"maxForCurrentTier":140,"minForCurrentTier":100,"neededForNextTier":24,"percentTowardsNextTier":82.85714285714286},"currentYearMqd":{"availableBalance":25000,"maxForCurrentTier":25000,"minForCurrentTier":100,"neededForNextTier":25,"percentTowardsNextTier":100},"currentYearCardSpend":{"availableBalance":25000,"maxForCurrentTier":25000,"neededForNextTier":25000,"percentTowardsNextTier":100},"currentYearTierCode":"PM","currentYearTierDesc":"Platinum","currentYearTierDiscontinueDate":"2014-02-28T00:00:00","currentYearTierEffectiveDate":"2013-03-01T00:00:00","enrolledForCoBrandCard":true,"futureProgramYear":"2014","futureYearTierCode":"PM","futureYearTierDesc":"Platinum","futureYearTierDiscontinueDate":"2015-02-28T00:00:00","futureYearTierEffectiveDate":"2014-03-01T00:00:00","internationalCustomer":false,"satisfiedCurrYearMileageCriteria":false,"satisfiedCurrYearSpendCriteria":false,"satisfiedPrevYearMileageCriteria":false,"satisfiedPrevYearSpendCriteria":false,"spendReqApplicableForCurrentYear":false,"spendReqApplicableForPrevYear":false,"trackingTowardsTierCode":"DM","trackingTowardsTierDesc":"Diamond"},"millionMilerMemberTier":"01","millionMilerTierEffectiveDate":"2010-01-12T00:00:00","partnerAnnualCobrands":[],"rolloverMQM":0,"tierLevelInfos":[]},"mySkyMilesTracker":"success","widgetTracker":"success"};}
function setWidgetGraphFlags(){if(widgetGraphData.loyaltyAccount.membershipStatusInfo.spendReqApplicableForCurrentYear&&!widgetGraphData.loyaltyAccount.membershipStatusInfo.internationalCustomer){widgetGraphData.showSpendRequirement=true;}
if(widgetGraphData.loyaltyAccount.membershipStatusInfo.satisfiedCurrYearMileageCriteria){widgetGraphData.mileageReqChecked=true;}
if(widgetGraphData.loyaltyAccount.membershipStatusInfo.satisfiedCurrYearSpendCriteria){widgetGraphData.spendReqChecked=true;}}
function generateCardSpendRange(value,isNeeded,isMax){var cardSpendRange="";if(!widgetGraphData.loyaltyAccount.membershipStatusInfo.enrolledForCoBrandCard&&!isMax){cardSpendRange="--";return cardSpendRange.toString();}
if(isNeeded&&value==0){cardSpendRange="0";}else if(value<1000){cardSpendRange="0-1";}else if(isNeeded&&value>=25000){cardSpendRange="24-25";}else if(value>=25000){cardSpendRange="25";}else{var rangeStart=parseInt(value)/1000;var rangeEnd=parseInt(rangeStart)+1;if(isNeeded&&(parseInt(value)%1000==0)){rangeStart--;rangeEnd--;}
cardSpendRange=parseInt(rangeStart)+"-"+parseInt(rangeEnd);}
cardSpendRange=cardSpendRange+"K";if(value>=25000&&!isNeeded&&!isMax){cardSpendRange=cardSpendRange+"+";}
return cardSpendRange;}
function displayWidgetTracker(callback){if(widgetGraphData==null){$.get("/acctactvty/getTrackerData.action",function(response){widgetGraphData=response;if(widgetGraphData!=null&&widgetGraphData.faultDO.status=="SUCCESS"){setWidgetGraphFlags();barGraph.render();updateTrackerValues(widgetGraphData.loyaltyAccount.membershipStatusInfo.futureYearTierDesc,widgetGraphData.loyaltyAccount.membershipStatusInfo.futureProgramYear);}else{$("#skymilestracker-section").css({display:"none"});$("#miles_message").show();}
if(callback){callback();}}).error(function(){handleTrackerError(callback);});;}}
function handleTrackerError(callback){var messageObject={responseText:"We're sorry. We can't show your medallion tracker right now. Please try again later."};$("#skymilestracker-section").html($("#deltaSummaryErrorTemplate").render(messageObject));$("#skymilestracker-section").css("margin-left","0px");$("#skymilestracker-section").show();if(callback){callback();}}
function display2014Banner(){var currentYear=new Date().getFullYear();var $bannerObj=$('#banner-canvas');var showBanner=false;if(!showBanner){$bannerObj.hide();}}
function updateTrackerValues(trackerLevel,trackerYear){$("#nextTrackerYear").html(trackerYear+' Status: ');if(widgetGraphData.loyaltyAccount.membershipStatusInfo.futureYearTierCode=="FF"){trackerLevel="SkyMiles Member";$("#nextTrackerLevel").unwrap();$("#nextTrackerLevel").css("color","#333333");}else{trackerLevel=trackerLevel+" Medallion";}
$("#nextTrackerLevel").html(trackerLevel);}
function isSameProgramAndFutureYear(){if(widgetGraphData.loyaltyAccount.membershipStatusInfo.nextProgramYear!=null){return true;}else{return false;}}
function isDiamond(){if(widgetGraphData.loyaltyAccount.membershipStatusInfo.futureYearTierCode=="DM"){return true;}else{return false;}}
var trackerCanvas="skymilestracker-section";var containerWidth=293;var barGraph={createTrackerCanvas:function(){var paperwidth=containerWidth;var paperheight=110;if(widgetGraphData.showSpendRequirement){paperheight=185;}
if(!widgetGraphData.mileageReqChecked||(widgetGraphData.showSpendRequirement&&!widgetGraphData.spendReqChecked)){paperheight=paperheight+15;}
return Raphael("tracker-canvas",paperwidth,paperheight);},createToCompleteMessage:function(paper){var texts=paper.set();if(isSameProgramAndFutureYear()){var textMessage="Start tracking toward "+widgetGraphData.loyaltyAccount.membershipStatusInfo.nextProgramYear+" Medallion status.";var text5=paper.text(20,16,textMessage);texts.push(text5);}else if(isDiamond()){var text4=paper.text(20,16,"Congratulations on achieving Diamond Medallion.");texts.push(text4);}else if(!widgetGraphData.mileageReqChecked||(!widgetGraphData.spendReqChecked&&widgetGraphData.showSpendRequirement)){var text1=(trackerUserIE)?paper.text(20,14,"Complete one "):paper.text(20,11,"Complete one ");if(widgetGraphData.showSpendRequirement&&!widgetGraphData.mileageReqChecked&&!widgetGraphData.spendReqChecked){if(trackerUserIE){this.renderIcon(paper,95,16,"plane","#278BD1");}else{this.renderIcon(paper,97,16,"plane","#278BD1");}
var text2=(trackerUserIE)?paper.text(106,14," and one "):paper.text(108,11," and one ");if(trackerUserIE){this.renderIcon(paper,155,16,"dollar","#15B162");}else{this.renderIcon(paper,156,16,"dollar","#15B162");}
var text3=(trackerUserIE)?paper.text(162,14," for "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" Medallion."):paper.text(165,11," for "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" Medallion.");texts.push(text1,text2,text3);}else{if(!widgetGraphData.mileageReqChecked){var paperXPos=(trackerUserIE)?94:96;this.renderIcon(paper,paperXPos,16,"plane","#278BD1");}else{var paperXPos=(trackerUserIE)?93:95;this.renderIcon(paper,paperXPos,16,"dollar","#15B162");}
var text2xPos=(trackerUserIE)?102:106;var text2=(trackerUserIE)?paper.text(text2xPos,14," for "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" Medallion."):paper.text(text2xPos,11," for "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" Medallion.");texts.push(text1,text2);}}
texts.attr({'fill':'#333333','text-anchor':'start',"font-size":10,"font-family":trackerFontFamilyVar});},render:function(){$("#skymilestracker-section").css("display","block");var barwidth=containerWidth-21;var barheight=27;var barleft=20;var yGraphPositions=[10,50,90,130];var paper=this.createTrackerCanvas();var yOffset=15;for(var i=0;i<yGraphPositions.length;i++){yGraphPositions[i]=yGraphPositions[i]+yOffset;}
var barset=paper.set();var mqmBar=barGraph.renderBar(paper,barleft,yGraphPositions[0],barheight,"light-blue",{"max":barwidth,"current":this.computeBarDisplay(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.percentTowardsNextTier,barwidth)});var mqsBar=barGraph.renderBar(paper,barleft,yGraphPositions[1],barheight,"light-blue",{"max":barwidth,"current":this.computeBarDisplay(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.percentTowardsNextTier,barwidth)});barset.push(mqmBar,mqsBar);if(widgetGraphData.showSpendRequirement){var mqdBar=barGraph.renderBar(paper,barleft,yGraphPositions[2],barheight,"green",{"max":barwidth,"current":this.computeBarDisplay(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.percentTowardsNextTier,barwidth)});var cardSpentBar=null;if(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend){cardSpentBar=barGraph.renderBar(paper,barleft,yGraphPositions[3],barheight,"green",{"max":barwidth,"current":this.computeBarDisplay(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend.percentTowardsNextTier,barwidth)});}else{cardSpentBar=barGraph.renderBar(paper,barleft,yGraphPositions[3],barheight,"green",{"max":barwidth,"current":0});}
barset.push(mqdBar,cardSpentBar);}
barGraph.renderCircleIcons(paper,yGraphPositions);var barTexts;var cardSpendRange=null;if(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend){cardSpendRange=barGraph.addCommas(generateCardSpendRange(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend.availableBalance,false,false));}else{cardSpendRange=barGraph.addCommas(generateCardSpendRange(0,false,false));}
if(widgetGraphData.showSpendRequirement&&widgetGraphData.loyaltyAccount.membershipStatusInfo.enrolledForCoBrandCard){barTexts={current:["MQMs: "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.availableBalance),"MQSs: "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.availableBalance),"MQDs: $"+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.availableBalance),"CARD SPEND: $"+cardSpendRange],needed:[barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,"$"+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,"$"+barGraph.addCommas(generateCardSpendRange(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend.neededForNextTier,true,false))+" to go"],max:[widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQMs = "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.maxForCurrentTier),widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQSs = "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.maxForCurrentTier),widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQDs = $"+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.maxForCurrentTier),"= $"+generateCardSpendRange(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend.maxForCurrentTier,false,true)]};}else if(widgetGraphData.showSpendRequirement&&!widgetGraphData.loyaltyAccount.membershipStatusInfo.enrolledForCoBrandCard){barTexts={current:["MQMs: "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.availableBalance),"MQSs: "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.availableBalance),"MQDs: $"+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.availableBalance),"CARD SPEND: $"+cardSpendRange],needed:[barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,"$"+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,""],max:[widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQMs = "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.maxForCurrentTier),widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQSs = "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.maxForCurrentTier),widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQDs = $"+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqd.maxForCurrentTier),"= $"+generateCardSpendRange(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearCardSpend.maxForCurrentTier,false,true)]};}else{barTexts={current:["MQMs: "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.availableBalance),"MQSs: "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.availableBalance),],needed:[barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.neededForNextTier)+" to "+widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc,],max:[widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQMs = "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqm.maxForCurrentTier),widgetGraphData.loyaltyAccount.membershipStatusInfo.trackingTowardsTierDesc+" MQSs = "+barGraph.addCommas(widgetGraphData.loyaltyAccount.membershipStatusInfo.currentYearMqs.maxForCurrentTier),]};}
if(isSameProgramAndFutureYear()){$.each(barTexts.max,function(i){barTexts.needed[i]="";});}
barGraph.renderTexts(paper,barTexts,yGraphPositions);},renderToCompleteMessage:function(paper){},renderBar:function(paper,x,y,height,color,graphData){var max=graphData.max;var current=graphData.current;var colorset={"light-blue":["#278BD1",'#1F70A7'],"green":["#15B162","#0F914F"]};var barBackColor="#052F4D";var status=(max-current);var bar=paper.set();var baseBar=paper.rect(x,y,max,height);baseBar.attr({stroke:'#EEEEEE',fill:colorset[color][0]});var stripedBar=stripedRect(paper,x,y,max,height,{lineSpacing:5,angle:45});stripedBar.attr({stroke:colorset[color][1],"stroke-width":"1","stroke-linecap":"round"});var shrinkingBar=paper.rect(x,y-.4,max,height+.7);shrinkingBar.attr({"fill":barBackColor,"stroke-width":"1"});shrinkingBar.animate({"width":status,x:x+max-status},2000,">");bar.push(baseBar,shrinkingBar);bar.attr({"stroke-width":"0"});bar.push(stripedBar);return bar;},addCommas:function(nStr){nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;},renderCircleIcons:function(paper,yGraphPositions){var xCirclePositionModifier=8;var yCirclePositionModifier=yGraphPositions[0]+23;var circleSize=18;var barleft=20;var xCircle=barleft+xCirclePositionModifier;var yCircle1=yCirclePositionModifier+10;var yCircle2=yCirclePositionModifier+90;var xIcon=xCircle;var yIcon1=yGraphPositions[0]+38;var yIcon2=yGraphPositions[0]+118;if(widgetGraphData.mileageReqChecked){this.renderCircle(paper,xCircle,yCircle1,circleSize,"#278BD1");this.renderIcon(paper,xIcon,yIcon1,"check","#FFFFFF");}else{this.renderCircle(paper,xCircle,yCircle1,circleSize);this.renderIcon(paper,xIcon,yIcon1,"plane");}
if(widgetGraphData.showSpendRequirement){if(widgetGraphData.spendReqChecked){this.renderCircle(paper,xCircle,yCircle2,circleSize,"#15B162");this.renderIcon(paper,xIcon,yIcon2,"check","#FFFFFF");}else{this.renderCircle(paper,xCircle,yCircle2,circleSize);this.renderIcon(paper,xIcon,yIcon2,"dollar","");}}},renderCircle:function(paper,x,y,circleSize,color){var background=paper.circle(x,y,circleSize);if(color){background.attr({fill:color,stroke:"#EEEEEE","stroke-width":"3"});}else{background.attr({fill:"#EEEEEE",stroke:"#EEEEEE","stroke-width":"3"});}},renderIcon:function(paper,x,y,icon,color){x=x-256;y=y-260;var stringPath="";if(icon=="plane"){stringPath="M 384.00,319.984l-91.41-91.411L 512.00,63.998L 447.995,0.00l-274.26,109.721L 87.385,23.368C 62.495-1.521, 27.734-7.485, 10.134,10.114  C-7.465,27.713-1.50,62.477, 23.389,87.364l 86.343,86.342L0.00,447.997L 63.995,512.00L 228.59,292.566l 91.413,91.414l0.00,127.99 L 384.00,511.97   l 31.996-95.994l 95.994-31.998l0.00-63.996 L 384.00,319.982 L 384.00,319.984 z";}else if(icon=="dollar"){stringPath="M245.928,201.576c-26.987-13.494-24.12-42.729,15.911-44.978 c32.402-1.821,66.144,10.462,86.789,17.485c0,0,12.925-56.687,15.918-69.75c-29.897-9.35-55.788-14.038-81.168-15.781V50h-59.225 v42.012c-65.233,14.239-91.493,62.386-91.493,97.42c0,84.558,101.107,98.352,130.492,111.545 c34.783,14.993,27.338,41.527-2.221,47.978c-33.792,7.374-79.485-7.985-110.803-20.204l-19.595,68.252 c27.656,15.242,65.194,25.543,93.62,27.977V462h59.225v-41.391c53.217-7.485,98.167-40.343,98.088-98.042 C381.466,247.904,301.289,226.614,245.928,201.576z";y=y-1;}else{stringPath="M 96.00,192.00L0.00,288.00L 192.00,480.00L 512.00,160.00L 416.00,64.00L 192.00,288.00 z";y=y-15;}
var iconSVG=paper.path(stringPath);iconSVG.translate(x,y);if(color){iconSVG.attr({fill:color,stroke:"none"});}else{iconSVG.attr({fill:"#333333",stroke:"none"});}
if(icon=="plane"){iconSVG.rotate(90);iconSVG.scale(0.027);}else if(icon=="dollar"){iconSVG.scale(0.038);}else{iconSVG.scale(0.028);}},renderTexts:function(paper,barTexts,yGraphPositions){var barright=containerWidth-10;var xTextNeededMaxPositionModifier=containerWidth-1;var xTextPositionModifier=50;var yTextPositionModifier=(trackerUserIE)?17:14;var yTextCurrentLevelMaxPositionModifier=(trackerUserIE||$.browser.msie&&$.browser.version<11)?35:32;var yTextNeededMaxPositionModifier=(trackerUserIE)?17:14;var barNameAndValue=paper.set();var neededUnits=paper.set();var currentMaxUnits=paper.set();var linkText=paper.set();var mqm=paper.text(xTextPositionModifier,yGraphPositions[0]+yTextPositionModifier,barTexts.current[0]);var mqs=paper.text(xTextPositionModifier,yGraphPositions[1]+yTextPositionModifier,barTexts.current[1]);var currentMaxMqm=paper.text(xTextNeededMaxPositionModifier,yGraphPositions[0]+yTextCurrentLevelMaxPositionModifier,barTexts.max[0]);var currentMaxMqs=paper.text(xTextNeededMaxPositionModifier,yGraphPositions[1]+yTextCurrentLevelMaxPositionModifier,barTexts.max[1]);if(!widgetGraphData.mileageReqChecked){var neededMqm=paper.text(barright,yGraphPositions[0]+yTextNeededMaxPositionModifier,barTexts.needed[0]);neededUnits.push(neededMqm);var neededMqs=paper.text(barright,yGraphPositions[1]+yTextNeededMaxPositionModifier,barTexts.needed[1]);neededUnits.push(neededMqs);}
barNameAndValue.push(mqm,mqs);currentMaxUnits.push(currentMaxMqm,currentMaxMqs);if(widgetGraphData.showSpendRequirement){var mqd=paper.text(xTextPositionModifier,yGraphPositions[2]+yTextPositionModifier,barTexts.current[2]);var cardSpend=paper.text(xTextPositionModifier,yGraphPositions[3]+yTextPositionModifier,barTexts.current[3]);var currentMaxMqd=paper.text(xTextNeededMaxPositionModifier,yGraphPositions[2]+yTextCurrentLevelMaxPositionModifier,barTexts.max[2]);var currentMaxCardspend=paper.text(xTextNeededMaxPositionModifier,yGraphPositions[3]+yTextCurrentLevelMaxPositionModifier,barTexts.max[3]);var currentMaxCardspendLink=paper.text(xTextNeededMaxPositionModifier-currentMaxCardspend.getBBox().width,yGraphPositions[3]+yTextCurrentLevelMaxPositionModifier,"MQD Waiver");var clickArea="";if(trackerUserIE){clickArea=paper.rect().attr(currentMaxCardspendLink.getBBox()).attr({'x':(currentMaxCardspendLink.attr('x')-55),fill:"#000",opacity:0,cursor:"pointer"}).click(function(){window.open("/content/www/en_US/skymiles/about-skymiles/medallion-program/medallion-qualification-dollars.html");});linkText.push(clickArea);}else{currentMaxCardspendLink.click(function(){window.open("/content/www/en_US/skymiles/about-skymiles/medallion-program/medallion-qualification-dollars.html");});}
if(!widgetGraphData.spendReqChecked){var neededMqd=paper.text(barright,yGraphPositions[2]+yTextNeededMaxPositionModifier,barTexts.needed[2]);neededUnits.push(neededMqd);var neededCardspend=paper.text(barright,yGraphPositions[3]+yTextNeededMaxPositionModifier,barTexts.needed[3]);neededUnits.push(neededCardspend);}
linkText.push(currentMaxCardspendLink);barNameAndValue.push(mqd,cardSpend);currentMaxUnits.push(currentMaxMqd,currentMaxCardspend,currentMaxCardspendLink);}
barNameAndValue.attr({"fill":"#FFFFFF","font-weight":"bold","stroke":"none","font-size":12,"text-anchor":"start","font-family":trackerFontFamilyVar});neededUnits.attr({'fill':'#FFFFFF','text-anchor':'end',"font-size":11,"font-family":trackerFontFamilyVar});currentMaxUnits.attr({'fill':'#343434','text-anchor':'end',"font-size":9,"font-weight":"normal","font-family":trackerFontFamilyVar});linkText.attr({'fill':'#0253a4','cursor':'pointer',"font-family":trackerFontFamilyVar});},computeBarDisplay:function(percentage,barwidth){return(percentage/100)*barwidth;}};
var FlightStatusWidget=function(){var pub={};var errorMessageSameCities="Please enter different arrival and departure cities.";var errorFlightNumberRequired="Please enter a valid flight number to continue.";var errorCityRequired="We're sorry. No cities or airport codes matched that entry. Please try again.";var errorFlightCity="Please enter either a valid flight number or arrival and departure cities to continue.";var isInitialized=false;var searchByFlightNumber="FLIGHTNUMBER";var searchByCityPair="CITYPAIR";var placeHolderFlightNumber="ex. 2049";var placeHolderCityPair="City or Airport";function addValidator(){$.validator.addMethod("FLIFO_notEqual",function(value,element,param){if(!($("#FLIFO_flightNumber").val()!=""&&$("#FLIFO_flightNumber").val().toUpperCase()!=placeHolderFlightNumber.toUpperCase()))
return value.toUpperCase()!=$(param).val().toUpperCase()||value.toUpperCase()==placeHolderCityPair.toUpperCase();else
return true;},errorMessageSameCities);$.validator.addMethod("FLIFO_notPlaceHolder",function(value,element,param){return value.toUpperCase()!=param.toUpperCase();});$.validator.addMethod("FLIFO_flightCityPairValidate",function(value,element,param){if($("#FLIFO_flightNumber").val()!=""&&$("#FLIFO_flightNumber").val().toUpperCase()!=placeHolderFlightNumber.toUpperCase()){$('#FLIFO_searchOption').val(searchByFlightNumber);return true;}
else if($("#FLIFO_arrivalAirport").val()!=""&&$("#FLIFO_arrivalAirport").val().toUpperCase()!=placeHolderCityPair.toUpperCase()&&$("#FLIFO_departureAirport").val()!=""&&$("#FLIFO_departureAirport").val().toUpperCase()!=placeHolderCityPair.toUpperCase()){$('#FLIFO_searchOption').val(searchByCityPair);return true;}
else
return false;});$("#FLIFO_flight_status").validate({onkeyup:false,onclick:false,onfocusout:function(element){if(element.id==="FLIFO_flightNumber"){if($("#FLIFO_flightNumber").val()!=""&&$("#FLIFO_flightNumber").val().toUpperCase()!=placeHolderFlightNumber.toUpperCase()){$("#FLIFO_arrivalAirport").val("");$("#FLIFO_departureAirport").val("");}}else if(element.id==="FLIFO_arrivalAirport"||element.id==="FLIFO_departureAirport"){if($("#FLIFO_arrivalAirport").val()!=""&&$("#FLIFO_arrivalAirport").val().toUpperCase()!=placeHolderCityPair.toUpperCase()&&$("#FLIFO_departureAirport").val()!=""&&$("#FLIFO_departureAirport").val().toUpperCase()!=placeHolderCityPair.toUpperCase()){$("#FLIFO_flightNumber").val("");}}},groups:{citypair:"flightNumber departureAirport arrivalAirport"},submitHandler:function(form){FlightStatusWidget.setOmnitureTracking();form.submit();},showErrors:function(errorMap,errorList){this.defaultShowErrors();FlightStatusWidget.setPlaceholderTextIE();delta.navwidget.adjustWidgetHeight('status');},errorLabelContainer:$("#FLIFO_errorList"),errorElement:"li",errorClass:"error",rules:{flightNumber:{FLIFO_flightCityPairValidate:""},departureAirport:{FLIFO_flightCityPairValidate:"",FLIFO_notEqual:"#FLIFO_arrivalAirport"},arrivalAirport:{FLIFO_flightCityPairValidate:"",FLIFO_notEqual:"#FLIFO_departureAirport"}},messages:{flightNumber:{FLIFO_flightCityPairValidate:errorFlightCity},departureAirport:{FLIFO_flightCityPairValidate:errorFlightCity},arrivalAirport:{FLIFO_flightCityPairValidate:errorFlightCity}}});};pub.setOmnitureTracking=function(){try{if($("#FLIFO_searchOption").val()==searchByFlightNumber){var searchValue="delta "+$("#FLIFO_flightNumber").val();s.linkTrackVars='prop17';s.prop17=searchValue;s.tl(this,'o','flight status search: flight number');s.prop17='';}else{var searchValue=$("#FLIFO_departureAirport").val()+"-"+$("#FLIFO_arrivalAirport").val();s.linkTrackVars='prop18';s.prop18=searchValue;s.tl(this,'o','flight status search: O&D');s.prop18='';}}catch(e){DeltaUtils.logMessage("FlightStatusSearchWidget setOmnitureTracking error "+e);}};pub.setPlaceholderTextIE=function(){if($.browser.msie){var inputFlightNumber=$("#FLIFO_flightNumber");var inputDepartureAirport=$("#FLIFO_departureAirport");var inputArrivalAirport=$("#FLIFO_arrivalAirport");if(inputFlightNumber.val()==""){inputFlightNumber.val(placeHolderFlightNumber);inputFlightNumber.addClass('placeholder');}
if(inputDepartureAirport.val()==""){inputDepartureAirport.val(placeHolderCityPair);inputDepartureAirport.addClass('placeholder');}
if(inputArrivalAirport.val()==""){inputArrivalAirport.val(placeHolderCityPair);inputArrivalAirport.addClass('placeholder');}}};pub.resetField=function(obj,checkValue){var inputObj=$(obj);if(inputObj.val()==checkValue){inputObj.val("");}};pub.init=function(){try{var dropDownFields=$("#FLIFO_flight_status select");if($.browser.msie){var inputFlightNumber=$("#FLIFO_flightNumber");var inputDepartureAirport=$("#FLIFO_departureAirport");var inputArrivalAirport=$("#FLIFO_arrivalAirport");dropDownFields.change(function(){this.blur();});inputFlightNumber.val(placeHolderFlightNumber);inputDepartureAirport.val(placeHolderCityPair);inputArrivalAirport.val(placeHolderCityPair);$(document).on('click.flightStatusFlightNum focus.flightStatusFlightNum','#FLIFO_flightNumber',function(){FlightStatusWidget.resetField(this,placeHolderFlightNumber);});$(document).on('click.flightStatusCityPair focus.flightStatusCityPair','#FLIFO_departureAirport, #FLIFO_arrivalAirport',function(){FlightStatusWidget.resetField(this,placeHolderCityPair);});$(document).on('blur.flightStatusFields','#FLIFO_flightNumber, #FLIFO_departureAirport, #FLIFO_arrivalAirport',function(){FlightStatusWidget.setPlaceholderTextIE();});}
var currentTime=new Date();initDates(currentTime);FlightStatusWidget.optionChanged(false);addValidator();DeltaUtils.addAutocomplete("#FLIFO_departureAirport","airportCode");DeltaUtils.addAutocomplete("#FLIFO_arrivalAirport","airportCode");$(document).on('change.flightStatusFields','#FLIFO_flightNumber, #FLIFO_departureAirport,#FLIFO_arrivalAirport',function(){var inputObj=$(this);inputObj.val($.trim(inputObj.val().toUpperCase()));});$(document).on('change.searchOption','#FLIFO_searchOption',function(){FlightStatusWidget.resetValidation();FlightStatusWidget.optionChanged(true);});if(!isInitialized){createAirportBubble();isInitialized=true;}
setTimeout('$(\'#FLIFO_flight-status-form select\').focus().blur();',2);}catch(e){DeltaUtils.logMessage("FlightStatusSearchWidget init error "+e);}};function createAirportBubble(){try{var departuretLookup=new AirportLookup({targetInp:'#FLIFO_departureAirport',displayTitle:placeHolderCityPair,serverUrl:window.location.host});departuretLookup.attachEventHandlers();var arrivalLookup=new AirportLookup({targetInp:'#FLIFO_arrivalAirport',displayTitle:placeHolderCityPair,serverUrl:window.location.host});arrivalLookup.attachEventHandlers();}catch(e1){}}
pub.optionChanged=function(isResize){var cityPairSpan=$("#FLIFO_cityPairWrapper");var flightNumberSpan=$("#FLIFO_flightNumberWrapper");if(!DeltaUtils.exists(isResize)||isResize===true){delta.navwidget.adjustWidgetHeight('status');}};function initDates(currentTime){var currentTime=new Date();var yesterdayTime=new Date();yesterdayTime.setDate(currentTime.getDate()-1);var tomorrowTime=new Date();tomorrowTime.setDate(currentTime.getDate()+1);var dateValueFormat="yy-mm-dd";var dateLabelFormat="MM dd yy";var yesterday=$.datepicker.formatDate(dateValueFormat,yesterdayTime);var today=$.datepicker.formatDate(dateValueFormat,currentTime);var tomorrow=$.datepicker.formatDate(dateValueFormat,tomorrowTime);var yesterdayLabel="Yesterday, "+$.datepicker.formatDate(dateLabelFormat,yesterdayTime);var todayLabel="Today, "+$.datepicker.formatDate(dateLabelFormat,currentTime);var tomorrowLabel="Tomorrow, "+$.datepicker.formatDate(dateLabelFormat,tomorrowTime);var flightDateDropdown=$("#FLIFO_flightDate");flightDateDropdown.empty();$('<option />',{value:yesterday,text:yesterdayLabel}).appendTo(flightDateDropdown);$('<option />',{value:today,text:todayLabel}).attr("selected","selected").appendTo(flightDateDropdown);$('<option />',{value:tomorrow,text:tomorrowLabel}).appendTo(flightDateDropdown);};pub.resetValidation=function(){var flightStatusFormObj=$("#FLIFO_flight_status");flightStatusFormObj.validate().resetForm();flightStatusFormObj.find("input").removeClass("error");};return pub;}();$(document).ready(function(){DeltaUtils.setPlaceholderText("#FLIFO_flight_status input[placeholder]");});
if(dwr==null)var dwr={};if(dwr.engine==null)dwr.engine={};if(DWREngine==null)var DWREngine=dwr.engine;if(CartDwr==null)var CartDwr={};CartDwr._path='/mymerch/dwr';CartDwr.addToCart=function(p0,callback){dwr.engine._execute(CartDwr._path,'CartDwr','addToCart',p0,false,false,callback);}
CartDwr.addToCartInsurance=function(p0,callback){dwr.engine._execute(CartDwr._path,'CartDwr','addToCartInsurance',p0,false,false,callback);}
CartDwr.getCartCount=function(callback){dwr.engine._execute(CartDwr._path,'CartDwr','getCartCount',false,false,callback);}
CartDwr.retrieveInCartProducts=function(callback){dwr.engine._execute(CartDwr._path,'CartDwr','retrieveInCartProducts',false,false,callback);}
CartDwr.hasPnrRelatedItemsInCart=function(p0,callback){dwr.engine._execute(CartDwr._path,'CartDwr','hasPnrRelatedItemsInCart',p0,false,false,callback);}
var TripsWidgetOmnitureTracking={trackSearchType:function(searchType){s.linkTrackVars="prop32";s.events="";s.prop32=searchType;s.pageName='My Trips';s.tl(true,"o","my trips: search type");s.events=s.prop45=s.prop32="";}};var myTripsWidget=function(){var FindMyTripWidget={first_name:"",last_name:"",form_name:"#widgetSearchUsingConfirmationNo"};var pub={};var alphanumericTest=new RegExp(/^[A-Za-z0-9]*$/),numbersTest=new RegExp(/^[0-9]+$/),$invalidRecLocFormat=$("#invalidRecLocFormat").val(),$recLocReqd=$("#recLocReqd").val(),$firstNameReqd=$("#firstNameReqd").val(),$lastNameReqd=$("#lastNameReqd").val(),$ticketNumReqd=$("#ticketNumReqd").val(),$ccNumberReqd=$("#ccNumberReqd").val(),$invalidTicketNumber=$("#invalidTicketNumber").val(),$invalidCCNumber=$("#invalidCCNumber").val(),isDataValid=null,$fName='',$lName='',accessNumber='',errorContainer='',hasCartContent=false,cartModal,isVerifiedToResume=true,currentHostServer=window.location.hostname;currentContext=window.location.pathname;pub.init=function(){FindMyTripWidget.first_name="";FindMyTripWidget.last_name="";FindMyTripWidget.form_name="#widgetSearchUsingConfirmationNo"
if(currentHostServer!=mytripswidHostServer){if((currentHostServer.indexOf("delta.com")>=0&&currentContext.indexOf("sd")!=1)||currentHostServer.indexOf("localhost")>=0){document.forms['widgetSearchUsingETicketNo'].action="https://"+currentHostServer+"/mytrips/findPnr.action";document.forms['widgetSearchUsingConfirmationNo'].action="https://"+currentHostServer+"/mytrips/findPnr.action";document.forms['widgetSearchUsingCreditDebitNo'].action="https://"+currentHostServer+"/mytrips/findPnrList.action";}}
hideAllForm();if($('.myTripsWidgetStrutsErrorBox').length){if($('#selectedOption').length){hideAllForm();if($('#selectedOption').val()==='ticketNo'){$("#widgetSearchUsingETicketNo").show();$('select#searchOption').removeAttr('selected').find('#ticketNumber').attr('selected','selected');}else if($('#selectedOption').val()==='creditCardNo'){$("#widgetSearchUsingCreditDebitNo").show();$('select#searchOption').removeAttr('selected').find('#creditCardNumber').attr('selected','selected');}}}
if($("#cartCountNotification").length<1){$('body').append('<div id="cartCountNotification"></div>');}
initializeCartDialog();addBindings();$("select#searchOption").trigger('change');try{DeltaUtils.showToolTip('confNoWidgetTooltip',$('#confTooltip').val(),-13,13,'',250,'','');DeltaUtils.showToolTip('eTicketWidgetTooltip',$('#ticketTooltip').val(),-13,13,'',250,'','');}catch(e){DeltaUtils.logMessage("jquery.atooltip.js was not included in the page");}
pub.setFormToDefault();};pub.adjustForm=function(){var adsHeight=$('.widget-topper').height()+$('.infoContainer').height();$('.advertisements').css('top',adsHeight+"px");$('div#findMyTripsFormContainer, #widget-mydelta').animate({height:adsHeight+"px"},50);};pub.setFormToDefault=function(){$inputSearch=FindMyTripWidget.form_name+" .inputFieldClass";$($inputSearch).each(function(index,elm){if($(this).attr('name')=="firstName"){FindMyTripWidget.first_name=$(this).val();}else if($(this).attr('name')=="lastName"){FindMyTripWidget.last_name=$(this).val();}else{$(this).val("");}});if($('.inputFieldClass').hasClass('redBorder')){$('.inputFieldClass').removeClass('redBorder');}
$('.myTripsWidgetErrorBox').html('');$('.myTripsWidgetErrorBox').hide();if($('.myTripsWidgetErrorBox').hasClass('error')){$('.myTripsWidgetErrorBox').removeClass('error');}
$('.myTripsWidgetStrutsErrorBox').html('');if($('#aToolTip').is(':visible')){$('#aToolTipCloseBtn').trigger('click');}
if($.browser.msie||($.browser.mozilla&&parseInt($.browser.version,10)<8)){$('#findMyTripsFormContainer [placeholder]').trigger('blur');}
if($.browser.chrome||$.browser.safari||$.browser.webkit){if($('#searchOption').hasClass('searchOptionWebkit')){$('#searchOption').removeClass('searchOptionWebkit').addClass('searchOptionWebkit');}else{$('#searchOption').addClass('searchOptionWebkit');}}};function addBindings(){$("select#searchOption").bind('change',selectChangeEvent);$("select#searchOption").bind('click',pub.setFormToDefault).bind('click',pub.adjustForm);$('#confNoButton').bind('click',confButtonClickEvent);$('#creditCardButton').bind('click',ccButtonClickEvent);$('#ticketButton').bind('click',ticketButtonClickEvent);$('.ui-dialog-titlebar-close').bind('click',closeCartDialog);if($.browser.msie||($.browser.mozilla&&parseInt($.browser.version,10)<8)){$('[placeholder]').bind('focus',placeHolderFocus);$('[placeholder]').bind('blur',placeHolderBlur);}};function closeCartDialog(){cartModal.dialog('close');};function adjustWidget(){if($('section#nav-widget-mydelta').hasClass('active')){setTimeout(function(){pub.adjustForm();},900);}}
function selectChangeEvent(){$("select#searchOption option:selected").each(function(){var formname=$(this).val();formname="#"+formname;hideAllForm();FindMyTripWidget.form_name=formname;$(formname).show();$('.myTripsWidgetErrorBox').html('');if($('.myTripsWidgetErrorBox').hasClass('error')){$('.myTripsWidgetErrorBox').removeClass('error');}
if($('.myTripsWidgetStrutsErrorBox').length&&$('#selectedOption').length){$(formname).find('.inputFieldClass').addClass('redBorder');}else{if($(formname).find('.inputFieldClass').hasClass('redBorder')){$(formname).find('.inputFieldClass').removeClass('redBorder');}}
$('.inputFieldClass').each(function(index,elm){if($(this).attr('name')=='firstName'){$(this).val(FindMyTripWidget.first_name);}else if($(this).attr('name')=='lastName'){$(this).val(FindMyTripWidget.last_name);}});});};function placeHolderFocus(){var $textArea=$('#findMyTripsFormContainer input[placeholder]');if($textArea.val()==$textArea.attr('placeholder')){$textArea.val('');}};function placeHolderBlur(){var $textArea=$('#findMyTripsFormContainer input[placeholder]');if($textArea.val()==''||$textArea.val()==$textArea.attr('placeholder')){$textArea.val($textArea.attr('placeholder'));}}
function ticketButtonClickEvent(){$fName='ticketFName';$lName='ticketLName';accessNumber='eticketNumber';errorContainer='ticketError';isDataValid=isEnteredDetailsValid({'firstName':$fName,'lastName':$lName,'accessNum':accessNumber,'accLength':13,'accReqdError':$ticketNumReqd,'invalidAccError':$invalidTicketNumber,'accTest':numbersTest,'errorBox':errorContainer});if(isDataValid){TripsWidgetOmnitureTracking.trackSearchType("ticket number");}
return isDataValid;};function ccButtonClickEvent(){$fName='ccFName';$lName='ccLName';accessNumber='cardNo';errorContainer='ccError';isDataValid=isEnteredDetailsValid({firstName:$fName,lastName:$lName,accessNum:accessNumber,accLength:13,accReqdError:$ccNumberReqd,invalidAccError:$invalidCCNumber,accTest:numbersTest,errorBox:errorContainer});if(isDataValid){TripsWidgetOmnitureTracking.trackSearchType("credit card");}
return isDataValid;};function confButtonClickEvent(){var $textArea=$('#findMyTripsFormContainer input[placeholder]');if(($.browser.msie||($.browser.mozilla&&parseInt($.browser.version,10)<8))&&($textArea.val()==$textArea.attr('placeholder'))){$textArea.val('');}
$fName='confFName';$lName='confLName';accessNumber='confNo';errorContainer='confError';isDataValid=isEnteredDetailsValid({firstName:$fName,lastName:$lName,accessNum:accessNumber,accLength:4,accReqdError:$recLocReqd,invalidAccError:$invalidRecLocFormat,accTest:alphanumericTest,errorBox:errorContainer});if(isDataValid){TripsWidgetOmnitureTracking.trackSearchType("confirmation");}
return isDataValid;};function setCartContentCurrentCount(confirmationNumber){var request={recordLocator:confirmationNumber};CartDwr.hasPnrRelatedItemsInCart(request,{async:false,callback:cartContentCurrentCallBack,errorHandler:cartErrorHandlerCallback});}
function cartErrorHandlerCallback(){DeltaUtils.logMessage("Not verified if the record locator has PNR related items in cart");}
function cartContentCurrentCallBack(hasCartCountContent){hasCartContent=hasCartCountContent;}
function initializeCartDialog(){$('#cartCountNotification').html('You have pending purchase within your cart!\n\nIf you navigate away from this page, data that you have entered may not be saved.');cartModal=$("#cartCountNotification").dialog({autoOpen:false,modal:true,width:400,height:200,resizable:false,position:'center',create:function(event,ui){var ele=$(event.target).parent();if(ele.find('.ui-dialog-title').html()===' '){ele.find('.ui-dialog-titlebar').addClass('ui-dialog-title');}
var deltaLogoMarkup='<div class="socialDeltaLogo">'+'<img src="//content.delta.com/content/dam/delta-applications/common/logos/delta/Delta_st_color.png" id="myNewImage" class="deltaImage"/>'+'</div>';if(!(ele.find('.ui-dialog-titlebar').children().hasClass('socialDeltaLogo'))){ele.find('.ui-dialog-titlebar').append(deltaLogoMarkup);}},buttons:{'OK':{text:'OK','class':'ui-button-primary',click:function(event){$(this).dialog('close');isVerifiedToResume=false;$('#confNoButton').trigger('click');}},"Cancel":{text:'Cancel','class':'ui-button-secondary',click:function(){$(this).dialog('close');window.location="/cart/activity/reviewcart";}}}});$('.ui-widget-overlay').css('zIndex','1001');}
function isEnteredDetailsValid(params){var prm_fName=params.firstName,prm_lName=params.lastName,prm_accessNum=params.accessNum,prm_accLength=params.accLength,prm_errBox=params.errorBox,prm_accTest=params.accTest,isPassed,isPreventDefault=false,firstName=$.trim($('#'+prm_fName).val()),lastName=$.trim($('#'+prm_lName).val()),accessNumber=$.trim($('#'+prm_accessNum).val());$('.myTripsWidgetStrutsErrorBox, .myTripsStrutsErrorBox').hide();if($('.inputFieldClass').hasClass('redBorder')){$('.inputFieldClass').removeClass('redBorder');}
if($('#'+prm_errBox).hasClass('error')){$('#'+prm_errBox).removeClass('error');}
$('#'+prm_errBox).html('');filterWidgetInput('#'+prm_fName,firstName);filterWidgetInput('#'+prm_lName,lastName);filterWidgetAccessNum('#'+prm_accessNum,accessNumber);accessNumber=accessNumber.replace(/\s/g,'');if(firstName==''||numbersTest.test(firstName)||($('#'+prm_fName).val().length<1)){addToMyTripsWidgetError(prm_errBox,$firstNameReqd);$('#'+prm_fName).addClass('redBorder');isPreventDefault=true;}
if(lastName==''||numbersTest.test(lastName)||($('#'+prm_lName).val().length<1)){addToMyTripsWidgetError(prm_errBox,$lastNameReqd);$('#'+prm_lName).addClass('redBorder');isPreventDefault=true;}
if(accessNumber==''){addToMyTripsWidgetError(prm_errBox,params.accReqdError);$('#'+prm_accessNum).addClass('redBorder');isPreventDefault=true;}else if(!(prm_accTest.test(accessNumber))||accessNumber.length<prm_accLength){addToMyTripsWidgetError(prm_errBox,params.invalidAccError);$('#'+prm_accessNum).addClass('redBorder');isPreventDefault=true;}
if(isPreventDefault){isPassed=false;}else{$('#'+prm_errBox).html('');if(prm_accessNum=='confNo'&&isVerifiedToResume){setCartContentCurrentCount(accessNumber);if(hasCartContent){isPassed=false;cartModal.dialog('open');}else{isPassed=true;}}else{isPassed=true;}}
callLoader(isPassed);return isPassed;};function callLoader(isInputValid){if(isInputValid){}else{pub.adjustForm();}};function hideAllForm(){$("#widgetSearchUsingConfirmationNo").hide();$("#widgetSearchUsingCreditDebitNo").hide();$("#widgetSearchUsingETicketNo").hide();};function addToMyTripsWidgetError(errBoxId,errMsg){if(errMsg.indexOf('<br/>')>-1){errMsg=errMsg.replace('<br/>',"");}
$errElem=$('<li />',{'class':'error','text':errMsg});if($('#'+errBoxId+':not(:empty)').length){$('#'+errBoxId).append($errElem);$('#'+errBoxId).show();}else{$('#'+errBoxId).html($errElem);$('#'+errBoxId).show();}
if(!$('#'+errBoxId).hasClass('error')){$('#'+errBoxId).addClass('error');}};function filterWidgetAccessNum(inputId,inputTemp){inputTemp=inputTemp.replace(/\s/g,'');$.trim(inputTemp);$(inputId).val(inputTemp.replace(/[^A-Za-z0-9\s]+/g,''));};function filterWidgetInput(inputId,inputTemp){inputTemp=inputTemp.replace(/\s{2,}/g,' ');$.trim(inputTemp);$(inputId).val(inputTemp.replace(/[^A-Za-z\x2D\xC0-\xFF\s]+/g,''));};return pub;}();
if(typeof Exception!="function"){function Exception(){this.javaClassName=null;this.message=null;this.cause=null;this.stackTrace=[];}}
if(dwr==null)var dwr={};if(dwr.engine==null)dwr.engine={};if(DWREngine==null)var DWREngine=dwr.engine;if(GetGeocodeDwr==null)var GetGeocodeDwr={};GetGeocodeDwr._path='/merch/dwr';GetGeocodeDwr.getGeoCodes=function(p0,p1,callback){dwr.engine._execute(GetGeocodeDwr._path,'GetGeocodeDwr','getGeoCodes',p0,p1,callback);}
var CarWidget={needsInit:true,isAdvancedSearch:false,isCarPrefillCallRequired:true,init:function(){CarWidget.hideCarValidateMessage();if(this.needsInit){this.needsInit=false;CarWidget.uiBehaviours();$('#pickUpTime').val('10:00 AM');$('#dropOffTime').val('10:00 AM');}
$(document).on('click','#CarWidgetContainer #pickUpDateCallIcon',function(){$("#pickUpWidgetDate").trigger("focus");});$(document).on('click','#CarWidgetContainer #dropOffDateCallIcon',function(){$("#dropOffWidgetDate").trigger("focus");});},loadRecentSearches:function(key){try{var myPrefillData={prefillAttribute:key};var callMetaData={callback:this.populateSearchCriteria};prefill.retrievePrefillData(myPrefillData,callMetaData);}catch(error){prefillError(error);}},populateSearchCriteria:function(attributeList){if(attributeList!=undefined&&attributeList!=null&&attributeList!=""){$("#WidgetCarPreferredTrips").removeClass("hideElementForFuture");$("#WidgetCarPreferredTrips").show();$("#carRecentSearches").val(attributeList);var recentSearches=attributeList.split("|");if(recentSearches.length>0){var options=[];options.push("<option value='-1'>Recent Searches</option>");var recentSearchesCarCounter=0;for(var i=0;((i<recentSearches.length)&&(recentSearchesCarCounter<4));i++){var searchCriteria=recentSearches[i].split("-");if((searchCriteria[4]=="mm/dd/yyyy"||searchCriteria[4]==undefined)&&(searchCriteria[5]=="mm/dd/yyyy"||searchCriteria[5]==undefined)){continue;}else if(searchCriteria.length>0){var display=MerchandisingWidget.getDateForRecentSearch(searchCriteria[4])+'-'+
MerchandisingWidget.getDateForRecentSearch(searchCriteria[5])+'-'+
searchCriteria[0]+'-'+
searchCriteria[2]+'-'+
searchCriteria[6]+'-'+
searchCriteria[7];display=MerchandisingWidget.truncate(display,33);options.push("<option value='"+searchCriteria[0]+"-"+
searchCriteria[1]+'-'+
searchCriteria[2]+'-'+
searchCriteria[3]+'-'+
searchCriteria[4]+'-'+
searchCriteria[5]+'-'+
searchCriteria[6]+'-'+
searchCriteria[7]+'-'+
searchCriteria[8]+"'>"+
display+"</option>");recentSearchesCarCounter++;}}
$("#selectCarWidget").html(options.join(''));}}
$("#carWidgetBottomDiv").addClass("hideElementForFuture");delta.navwidget.adjustWidgetHeight("booking");},setRecentSearchCriteria:function(){var recentSearchCriteria="";var currentSearch=$("#carLocation").val()+"-"+$("#predictiveLocationCode").val()+"-"+
$("#dropLocationWidget").val()+"-"+$("#dropOffWidgetLocationCode").val()+"-"+
$("#pickUpWidgetDate").val()+"-"+$("#dropOffWidgetDate").val()+"-"+$("#pickUpTime").val()+"-"
+$("#dropOffTime").val()+"-"+$("#ageWidget").val();if($("#carRecentSearches").val()!=null&&$("#carRecentSearches").val()!=""){var recentSearchVal=$("#carRecentSearches").val().split("|");if(recentSearchVal!=undefined&&$("#carRecentSearches").val().indexOf(currentSearch)!=-1)
return;if(recentSearchVal.length>3){recentSearchCriteria=recentSearchVal[0];for(var k=1;k<3;k++){recentSearchCriteria=recentSearchCriteria+"|"+recentSearchVal[k];}
recentSearchCriteria=currentSearch+"|"+recentSearchCriteria;}else{recentSearchCriteria=currentSearch+"|"+$("#carRecentSearches").val();}}else{recentSearchCriteria=currentSearch;}
saveSingleAttributeValuePair('searchCarForm',recentSearchCriteria);},showAgePopUp:function(hoverId,toolTipUrl,xOffset,yOffset,height,width,toolTipTheme,title,position){$("<div id='"+hoverId+"Content' class='topContentLoader'></div>").appendTo(document.body).load(toolTipUrl,function(response,status,xhr){if(status=="success"){DeltaUtils.showToolTip(hoverId,response,xOffset,yOffset,height,width,toolTipTheme,title,position);}});},submitAction:function(actionPath){$("form#searchCarWidgetForm").attr("action",actionPath);},submitActionForAdvSearch:function(actionPath){isAdvancedSearch=true;$("#carWidgetSearchType").val("showAdvancedCarSearch");$("#searchCarWidgetForm").validate().cancelSubmit=true;var actionURL="https://"+window.location.hostname+"/merch/advancedSearchAction.action";$("#searchCarWidgetForm").attr("action",actionURL);$("#carModuleName").val('car');$("#searchCarWidgetForm").submit();},hideCarValidateMessage:function(){if($('#pickupWidgetLocationError').css('display')!="none"){$("#pickupWidgetLocationError").css('display','none');$("#carLocation").val("Airport or Metro City").addClass('auto-hint').removeClass('error');}
if($('#carSearchDropLocationWidgetError').css('display')!="none"){$("#carSearchDropLocationWidgetError").css('display','none');$("#dropLocationWidget").val("Airport or Metro City").addClass('auto-hint').removeClass('error');}
if($('#pickupDateWidgetError').css('display')!="none"){$("#pickupDateWidgetError").css('display','none');$("#pickUpWidgetDate").val("mm/dd/yyyy").addClass('auto-hint').removeClass('error');}
if($('#dropOffDateWidgetError').css('display')!="none"){$("#dropOffDateWidgetError").css('display','none');$("#dropOffWidgetDate").val("mm/dd/yyyy").addClass('auto-hint').removeClass('error');}
if($('#widget_ageError').css('display')!="none"){$("#widget_ageError").css('display','none');$("#ageWidget").val("SELECT").addClass('auto-hint').removeClass('error');}
if($('#dropOffTimeWidgetError').css('display')!="none"){$("#dropOffTimeWidgetError").css('display','none');$('#pickUpTime').val('10:00 AM');$('#dropOffTime').val('10:00 AM').removeClass('error');}
$("div#CarWidgetContainer label.error").css('display','none');delta.navwidget.adjustWidgetHeight("booking");},uiBehaviours:function(){if(CarWidget.isCarPrefillCallRequired){CarWidget.loadRecentSearches('searchCarForm');CarWidget.isCarPrefillCallRequired=false;}
MerchandisingWidget.setCarCalendarControl("pickUpWidgetDate","dropOffWidgetDate","Pick-Up Date","Drop-Off Date");var ageToolTipTxt="Minimum age requirements vary by vehicle and renting location. In most countries, age differential surcharges will generally apply for renters under age 25. Exceptions do apply. Providing your age range enables us to quote the appropriate fees and display appropriate fleet.";DeltaUtils.showToolTip('ageHoverWidgetId',ageToolTipTxt,0,6,'',250,'','');DeltaUtils.setPlaceholderText("#CarWidgetContainer input[placeholder]");$("#pickUpWidgetDate, #dropOffWidgetDate, #carLocation, #dropLocationWidget").blur(function(){if($(this).val()==''){if($(this).attr('id')=='carLocation'||$(this).attr('id')=='dropLocationWidget'){$(this).val('Airport or Metro City');$(this).addClass('auto-hint');}else{$(this).val("mm/dd/yyyy");$(this).addClass('auto-hint');}}});$("#selectCarWidget").change(function(){if($("#selectCarWidget option:selected").text().indexOf("-")!=-1){var $selectedCriteria=$("#selectCarWidget").val().split("-");$("#carLocation").val($selectedCriteria[0]);$("#predictiveLocationCode").val($selectedCriteria[1]);if($selectedCriteria[0]!=$selectedCriteria[2]){$("#dropOffWidgetLocationChk").attr("checked",true);$("#dropOffLocation").show();}else{$("#dropOffWidgetLocationChk").attr("checked",false);$("#dropOffLocation").hide();}
$("#dropLocationWidget").val($selectedCriteria[2]);$("#dropOffWidgetLocationCode").val($selectedCriteria[3]);$("#pickUpWidgetDate").val($selectedCriteria[4]);$("#dropOffWidgetDate").val($selectedCriteria[5]);$("#pickUpTime").val($selectedCriteria[6]);$("#dropOffTime").val($selectedCriteria[7]);$("#ageWidget").val($selectedCriteria[8]);delta.navwidget.adjustWidgetHeight("booking");}});$('.ui-modal-link').click(function(e){e.preventDefault();$($(this).attr('href')).dialog('open');});$("#dropOffWidgetLocationChk").click(function(){if($(this).attr("checked")=="checked"){$("#dropOffLocation").show();$("#dropOfLocationText").hide();}else{$("#dropOffLocation").hide();}
delta.navwidget.adjustWidgetHeight("booking");});$("#closeDropOffLocation").click(function(){$("#dropOffWidgetLocationChk").removeAttr("checked");$("#dropOfLocationText").show();$("#dropOffLocation").hide();delta.navwidget.adjustWidgetHeight("booking");});$('div.ui-modal').dialog({autoOpen:false,modal:true,width:499,minHeight:150,create:function(event,ui){var ele=$(event.target).parent();if(ele.find('.ui-dialog-title').html()==='&nbsp;'){ele.find('.ui-dialog-titlebar').addClass('ui-dialog-no-title');}}});$("#carLocation").autocomplete({source:CarWidgetLocationPrediction.carWidgetLocationPredictionHandler,select:function(event,ui){$("#predictiveLocationCode").val(ui.item.id);}});$("#dropLocationWidget").autocomplete({source:CarWidgetLocationPrediction.carWidgetLocationPredictionHandler,select:function(event,ui){$("#dropOffWidgetLocationCode").val(ui.item.id);}});$("#carLocation,#dropLocationWidget,#pickUpWidgetDate,#dropOffWidgetDate").focus(function(){if($(this).attr('id')=='carLocation'||$(this).attr('id')=='dropLocationWidget'){var carLocationCodes=[];carLocationCodes[0]="A";CarWidgetLocationPrediction.widgetLocationCodes=carLocationCodes;}
if($(this).attr('id')=='pickUpWidgetDate'||$(this).attr('id')=='dropOffWidgetDate'){if($(this).val()=="mm/dd/yyyy"){$(this).val('');$(this).removeClass('auto-hint');}}else{if($(this).val()=='Airport or Metro City'){$(this).val('');$(this).removeClass('auto-hint');}}});$("#carTripSubmit").click(function(){$("#carLocation").attr("isCarPickUpPredictiveText","#predictiveLocationCode");$("#dropLocationWidget").attr("isCarDropOffPredictiveText","#dropOffWidgetLocationCode");});$("#carLocation").focusin(function(){$("#carLocation").removeAttr("isCarPickUpPredictiveText");});$("#pickUpWidgetDate, #dropOffWidgetDate").keyup(function(event){var v=$(this).val();if((event.keyCode>47&&event.keyCode<58)||(event.keyCode>95&&event.keyCode<106)){if(v.match(/^\d{2}$/)!==null){$(this).val(v+'/');}else if(v.match(/^\d{2}\/\d{2}$/)!==null||v.match(/^\d{1}\/\d{2}$/)!==null){$(this).val(v+'/');}}else if(event.keyCode==191){v=v.replace("//","/");$(this).val(v);}else if(event.keyCode==37||event.keyCode==39||event.keyCode==36||event.keyCode==35||event.keyCode==9||event.keyCode==8||event.keyCode==46||event.keyCode==16){}else{v=v.replace(/[^0-9\/]/g,"");$(this).val(v);}});$("#dropLocationWidget").focusin(function(){$("#dropLocationWidget").removeAttr("isCarDropOffPredictiveText");});$("#CarWidgetContainer #selectCarWidget,"+"#CarWidgetContainer #carLocation,"+"#CarWidgetContainer #dropOffWidgetLocationChk,"+"#CarWidgetContainer #dropLocationWidget,"+"#CarWidgetContainer #closeDropOffLocation,"+"#CarWidgetContainer #pickUpTime,"+"#CarWidgetContainer #dropOffTime,"+"#CarWidgetContainer #ageWidget,"+"#CarWidgetContainer #ageHoverWidgetId,"+"#CarWidgetContainer #carTripSubmit,"+"#CarWidgetContainer #advancedWidgetSearch").click(function(){if($(".delta2UpCal").is(":visible")){delta.deltaPolCalendarMgr.closeAll();}});$("#searchCarWidgetForm").validate({rules:{pickUpDate:{carWidgetDate:true,carWidgetPastDate:true},dropOffDate:{carWidgetDate:true,carWidgetPastDate:true},carLocation:{pickupLocation:true,required:true},destinationCityCodeforCarWidget:{destinationCityCodeforCarWidget:true,required:true},dropOffLocationCodeCarWidget:{dropOffLocationCodeCarWidget:true,required:true},age:{required:true},dropOffTime:{timeGreaterThanWidget:"#pickUpTime"}},messages:{pickUpDate:{carWidgetDate:function(element){$("#pickupDateWidgetError").css('display','block');var message="Please enter a valid date in mm/dd/yyyy format";if($("#pickUpWidgetDate").val()=="mm/dd/yyyy"||$("#pickUpWidgetDate").val()==""){$("#pickUpWidgetDate").addClass('auto-hint');message="Please enter a valid Pick-up Date";}
return message;},carWidgetPastDate:function(element){$("#pickupDateWidgetError").css('display','block');var message="Please select future date"
return message;}},dropOffDate:{carWidgetDate:function(element){$("#dropOffDateWidgetError").css('display','block');var message="Please enter a valid date in mm/dd/yyyy format";if($("#dropOffWidgetDate").val()=="mm/dd/yyyy"||$("#dropOffWidgetDate").val()==""){$("#dropOffWidgetDate").addClass('auto-hint');message="Please enter a valid drop-off Date";}
return message;},carWidgetPastDate:function(element){$("#dropOffDateWidgetError").css('display','block');var message="Please select future date"
return message;}},pickupLocation:{required:"Please enter Pick-Up Location"},age:{required:function(element){$("#widget_ageError").css('display','block');var message="Please select an age range to continue.";resizeCarWidget.resize();return message;}},dropOffTime:{timeGreaterThanWidget:function(element){$("#dropOffTimeWidgetError").css('display','block');var message="Please select an earlier pick-up date/time or a later drop-off date/time."
resizeCarWidget.resize();return message;}}},submitHandler:function(form){if($("#predictiveLocationCode").val()=="")
$("#predictiveLocationCode").val($("#carLocation").val());if(!$("#dropOffWidgetLocationChk").is(":checked")){$("#dropLocationWidget").val($("#carLocation").val());if($("#predictiveLocationCode").val()!=""){$("#dropOffWidgetLocationCode").val($("#predictiveLocationCode").val());}else{$("#dropOffWidgetLocationCode").val($("#carLocation").val());}
$("#dropLocationWidget").val($("#carLocation").val());}else{if($("#dropOffWidgetLocationCode").val()=="")
$("#dropOffWidgetLocationCode").val($("#dropLocation").val());}
CarWidget.setRecentSearchCriteria();setTimeout(function(){MerchandisingWidget.submitDelayedForm(form);},MerchandisingWidget.delayForFormSubmission);},success:function(label){if(label.attr('for')=="pickUpWidgetDate"){$("#pickupDateWidgetError").css('display','none');$("#pickUpWidgetDate").removeClass('auto-hint');}else if(label.attr('for')=="dropOffWidgetDate"){$("#dropOffDateWidgetError").css('display','none');$("#dropOffWidgetDate").removeClass('auto-hint');}else if(label.attr('for')=="dropLocationWidget"){$("#carSearchDropLocationWidgetError").css('display','none');}else if(label.attr('for')=="carLocation"){$("#pickupWidgetLocationError").css('display','none');}else if(label.attr('for')=="dropOffTime"){$("#dropOffTimeWidgetError").css('display','none');}else if(label.attr('for')=="ageWidget"){$("#widget_ageError").css('display','none');}
resizeCarWidget.resize();},errorPlacement:function(error,element){if(element.is("#pickUpWidgetDate")){if(element.val()=="mm/dd/yyyy"){error.html("Please enter a valid Pick-up Date");}
error.appendTo($("#pickupDateWidgetError"));}else if(element.is("#dropOffWidgetDate")){if(element.val()=="mm/dd/yyyy"){error.html("Please enter a valid drop-off Date");}
error.appendTo($("#dropOffDateWidgetError"));}else if(element.is("#dropLocationWidget")){error.appendTo($("#carSearchDropLocationWidgetError"));}else if(element.is("#carLocation")){if(element.val()=="Airport or Metro City"){error.html("We're sorry. No cities or airport codes matched that entry. Please try again.");}
error.appendTo($("#pickupWidgetLocationError"));}else if(element.is("#ageWidget")){if($.browser.webkit&&!!window.chrome){}else if($.browser.webkit&&!!window.safari){}
$("#ageWidget").attr("style","display: inline-block");error.appendTo($("#widget_ageError"));}else if(element.is("#dropOffTime")){error.appendTo($("#dropOffTimeWidgetError"));}
delta.navwidget.adjustWidgetHeight("booking");}});}};var resizeCarWidget={resize:function(){setTimeout(function(){var widgetContainer=$("#widget-booking");widgetContainer.css("height",resizeCarWidget.getWidgetHeight());},1);},getWidgetHeight:function(){var carContainer=$("#book-tabs");return carContainer.height()+carContainer.position().top+(!delta.navwidget.isDockedState()?0:33);}};var HotelWidget={recentSearchHeight:0,needsInit:true,multiRoomFlag:false,isHotelPrefillCallRequired:true,isAdvancedSearch:false,init:function(){HotelWidget.hideHotelValidateMessage();if(this.needsInit){this.needsInit=false;$("#multiRoomFlag").val(false);HotelWidget.uiBehaviours();}
$(document).on('click','#hotelWidgetSearchContainer #checkInDateCallIcon',function(){$("#checkInDateWidget").trigger("focus");});$(document).on('click','#hotelWidgetSearchContainer #checkOutDateCallIcon',function(){$("#checkInDateWidget").trigger("focus");});},loadRecentSearches:function(key){try{var myPrefillData={prefillAttribute:key};var callMetaData={callback:this.populateSearchCriteria};prefill.retrievePrefillData(myPrefillData,callMetaData);}catch(error){prefillError(error);}},populateSearchCriteria:function(attributeList){if(attributeList!=undefined&&attributeList!=null&&attributeList!=""){$("#WidgetPreferredTrips").removeClass("hideElementForFuture");$("#WidgetPreferredTrips").show();$("#widgetRecentSearches").val(attributeList);var recentSearches=attributeList.split("|");if(recentSearches.length>0){var options=[];var recentSearchesHotelCounter=0;options.push("<option value='-1'>Recent Searches</option>");for(var i=0;((i<recentSearches.length)&&(recentSearchesHotelCounter<4));i++){var searchCriteria=recentSearches[i].split(":");if((searchCriteria[3]=="mm/dd/yyyy"||searchCriteria[3]==undefined)&&(searchCriteria[4]=="mm/dd/yyyy"||searchCriteria[4]==undefined)){continue;}else if(searchCriteria.length>0){var display=MerchandisingWidget.getDateForRecentSearch(searchCriteria[3])+'-'+
MerchandisingWidget.getDateForRecentSearch(searchCriteria[4])+'-'+
searchCriteria[1];display=MerchandisingWidget.truncate(display,38);options.push("<option value='"+searchCriteria[0]+':'+
searchCriteria[1]+':'+
searchCriteria[2]+':'+
searchCriteria[3]+':'+
searchCriteria[4]+':'+
searchCriteria[5]+':'+
searchCriteria[6]+':'+
searchCriteria[7]+"'>"+
display+"</option>");recentSearchesHotelCounter++;}}
$("#selecthotelWidget").html(options.join(''));HotelWidget.recentSearchHeight=15;}else{HotelWidget.recentSearchHeight=0;}}
$("#hotelWidgetBottomDiv").addClass("hideElementForFuture");delta.navwidget.adjustWidgetHeight("booking");},setRecentSearchCriteria:function(isFromGoogle){if($("#widgetRecentSearches").val()!=undefined){var recentSearchCriteria="";var locationId="";var locationTypeCode="";if(isFromGoogle){locationId=$("#hotelPositionsWidget").val();}else{locationId=$("#locationCodeWidget").val();locationTypeCode=$("#locationTypeCodeWidget").val();}
var currentSearch=locationId+":"+$("#hotelLocation").val()+":"+locationTypeCode+":"
+$("#checkInDateWidget").val()+":"+$("#checkOutDateWidget").val()
+":"+$("#numberOfRoomsWidget").val()+":"+$("#numberOfAdultsWidget").val()+":"+$("#numberOfChildrenWidget").val();if($("#widgetRecentSearches").val()==""){recentSearchCriteria=currentSearch;}else{var recentSearchVal=$("#widgetRecentSearches").val().split("|");if(recentSearchVal!=undefined&&$("#widgetRecentSearches").val().indexOf(currentSearch)!=-1)
return;if(recentSearchVal.length>3){recentSearchCriteria=recentSearchVal[0];for(var k=1;k<3;k++){recentSearchCriteria=recentSearchCriteria+"|"+recentSearchVal[k];}
recentSearchCriteria=currentSearch+"|"+recentSearchCriteria;}else{recentSearchCriteria=currentSearch+"|"+$("#widgetRecentSearches").val();}}}
saveSingleAttributeValuePair('searchHotelForm',recentSearchCriteria);},showChildPopUp:function(hoverId,toolTipUrl,xOffset,yOffset,height,width,toolTipTheme,title,position){$("<div id='"+hoverId+"Content' class='topContentLoader'></div>").appendTo(document.body).load(toolTipUrl,function(response,status,xhr){if(status=="success"){DeltaUtils.showToolTip(hoverId,response,xOffset,yOffset,height,width,toolTipTheme,title,position);}});},hideMultipleRooms:function(){var index=parseInt(requestURL.indexOf("merch"));if(index>0){var parentURL=requestURL.substring(0,index);}
var redirectURL=parentURL+"#book-hotel-content";$("#searchHotelRoomForm").attr("action",redirectURL);$("#searchHotelRoomForm").submit();},multipleRoomSubmit:function(){$("#hotelWidgetSearchType").val("showHotelResult");var actionURL="https://"+window.location.hostname+'/merch/searchHotelAction.action';$("form#searchHotelRoomForm").attr("action",actionURL);$("form#searchHotelRoomForm").submit();},submitAction:function(actionPath){$("form#searchHotelWidgetForm").attr("action",actionPath);},submitActionAdvSearch:function(actionPath){$("#hotelWidgetSearchType").val("showAdvancedHotelSearch");$("#searchHotelWidgetForm").validate().cancelSubmit=true;HotelWidget.isAdvancedSearch=true;var actionURL="https://"+window.location.hostname+"/merch/advancedSearchAction.action";$("#searchHotelWidgetForm").attr("action",actionURL);$("#searchHotelWidgetForm").submit();},showMultipleRoomsOptions:function(){var noOfRoomsSelected=$("#multipleNumberOfRooms").val();var hotelOptions=null;if(noOfRoomsSelected>1){$("#selectedNoOfRooms").html(noOfRoomsSelected);hotelOptions=new Array();for(var i=0;i<noOfRoomsSelected;i++){var roomOptions={"Counter":i,"ProductNo":(i+1)};hotelOptions[i]=roomOptions;}
$("#roomSelectionContainer").css('display','block');$("#hotelRoomsContainer").html($("#roomSelectionTemplate").render(hotelOptions));}},hideHotelValidateMessage:function(){if($('#locationWidgetError').css('display')!="none"){$("#locationWidgetError").css('display','none');$("#hotelLocation").val("Airport, City, Attraction or Address").addClass('auto-hint').removeClass('error');}
if($('#checkinDateErrorWidget').css('display')!="none"){$("#checkinDateErrorWidget").css('display','none');$("#checkInDateWidget").val("mm/dd/yyyy").addClass('auto-hint').removeClass('error');}
if($('#checkOutDateErrorWidget').css('display')!="none"){$("#checkOutDateErrorWidget").css('display','none');$("#checkOutDateWidget").val("mm/dd/yyyy").addClass('auto-hint').removeClass('error');$("#checkInDateWidget").addClass('auto-hint').removeClass('error');}
$("div#hotelWidgetSearchContainer label.error").css('display','none');delta.navwidget.adjustWidgetHeight("booking");},updateAdultChildValue:function(){if($("#numberOfRoomsWidget").val()>1){$('#numberOfAdultsWidget').val("2");$("#numberOfChildrenWidget").val("-");$("#fsHotelWidgetNumberOfAdults").addClass('hideElement');$("#fsHotelWidgetNumberOfChild").addClass('hideElement');}else{$("#fsHotelWidgetNumberOfAdults").removeClass('hideElement');$("#fsHotelWidgetNumberOfChild").removeClass('hideElement');}},uiBehaviours:function(){if(HotelWidget.isHotelPrefillCallRequired){HotelWidget.loadRecentSearches('searchHotelForm');HotelWidget.isHotelPrefillCallRequired=false;}
MerchandisingWidget.setHotelCalendarControl("checkInDateWidget","checkOutDateWidget","Check-In Date","Check-Out Date");var childrenToolTipTxt="Discounts may apply to children depending on age. Age requirements vary by property.";DeltaUtils.showToolTip('hotelWidgetHelpIcon',childrenToolTipTxt,0,6,'',250,'','');DeltaUtils.setPlaceholderText("#hotelWidgetSearchContainer input[placeholder]");$("#selecthotelWidget").change(function(){if($("#selecthotelWidget option:selected").text().indexOf("-")!=-1){var $selectedCriteria=$("#selecthotelWidget").val().split(":");var location=$selectedCriteria[0];if(location.indexOf(",")!=-1){$("#hotelLocation").val($selectedCriteria[1]);$("#locationCodeWidget").val("");$("#locationTypeCodeWidget").val("");}else{$("#locationCodeWidget").val($selectedCriteria[0]);$("#hotelLocation").val($selectedCriteria[1]);$("#locationTypeCodeWidget").val($selectedCriteria[2]);}
$("#checkInDateWidget").val($selectedCriteria[3]);$("#checkOutDateWidget").val($selectedCriteria[4]);$("#numberOfRoomsWidget").val($selectedCriteria[5]);$("#numberOfAdultsWidget").val($selectedCriteria[6]);$("#numberOfChildrenWidget").val($selectedCriteria[7]);HotelWidget.updateAdultChildValue();}});$("#checkInDateWidget, #checkOutDateWidget, #hotelLocation").blur(function(){if($(this).val()==''){if($(this).attr('id')=='hotelLocation'){$(this).val('Airport, City, Attraction or Address');$(this).addClass('auto-hint');}else{$(this).val("mm/dd/yyyy");$(this).addClass('auto-hint');}}});$("#checkInDateWidget, #checkOutDateWidget").change(function(){if($("#searchHotelWidgetForm").validate()!=undefined){if($.trim($("#checkInDateWidget").val())!=""&&$("#checkInDateWidget").val()!="mm/dd/yyyy")
$("#searchHotelWidgetForm").validate().element("#checkInDateWidget");if($.trim($("#checkOutDateWidget").val())!=""&&$("#checkOutDateWidget").val()!="mm/dd/yyyy")
$("#searchHotelWidgetForm").validate().element("#checkOutDateWidget");}});$("#checkInDateWidget, #checkOutDateWidget").focusout(function(){if($("#searchHotelWidgetForm").validate()!=undefined){if($.trim($("#checkOutDateWidget").val())!=""&&$("#checkOutDateWidget").val()!="mm/dd/yyyy")
$("#searchHotelWidgetForm").validate().element("#checkOutDateWidget");}});$("#checkInDateWidget, #checkOutDateWidget").keyup(function(event){var v=$(this).val();if((event.keyCode>47&&event.keyCode<58)||(event.keyCode>95&&event.keyCode<106)){if(v.match(/^\d{2}$/)!==null){$(this).val(v+'/');}else if(v.match(/^\d{2}\/\d{2}$/)!==null||v.match(/^\d{1}\/\d{2}$/)!==null){$(this).val(v+'/');}}else if(event.keyCode==191){v=v.replace("//","/");$(this).val(v);}else if(event.keyCode==37||event.keyCode==39||event.keyCode==36||event.keyCode==35||event.keyCode==9||event.keyCode==8||event.keyCode==46||event.keyCode==16){}else{v=v.replace(/[^0-9\/]/g,"");$(this).val(v);}});$("#hotelLocation").focusout(function(){if($("#searchHotelWidgetForm").validate()!=undefined){if($.trim($("#hotelLocation").val())!="")
$("#searchHotelWidgetForm").validate().element("#hotelLocation");}});$("#numberOfRoomsWidget").change(function(){HotelWidget.updateAdultChildValue();});$("#hotelLocation").autocomplete({source:HotelWidgetLocationPrediction.hotelWidgetLocationPredictionHandler,select:function(event,ui){$("#locationCodeWidget").val(ui.item.id);$("#locationTypeCodeWidget").val(ui.item.type);}});$("#checkInDateWidget, #checkOutDateWidget, #hotelLocation").focus(function(){if($(this).attr('id')=='checkInDateWidget'||$(this).attr('id')=='checkOutDateWidget'){if($(this).val()=="mm/dd/yyyy"){$(this).val('');$(this).removeClass('auto-hint');}}else{if($(this).val()=='Airport, City, Attraction or Address'){$(this).val('');$(this).removeClass('auto-hint');}}});$('div.ui-modal').dialog({autoOpen:false,modal:true,width:499,minHeight:150,create:function(event,ui){var ele=$(event.target).parent();if(ele.find('.ui-dialog-title').html()==='&nbsp;'){ele.find('.ui-dialog-titlebar').addClass('ui-dialog-no-title');}}});$('.ui-modal-link').click(function(e){e.preventDefault();$($(this).attr('href')).dialog('open');});$("#nav-widget-booking").click(function(){var linkId=$("#book-tabs li.ui-state-active a").attr('id');if(linkId.toLowerCase()==="book-hotel-content-trigger"){HotelWidget.hideHotelValidateMessage();}else if(linkId.toLowerCase()==="book-car-content-trigger"){CarWidget.hideCarValidateMessage();}});$("#hotelWidgetSearchContainer #selecthotelWidget,"+"#hotelWidgetSearchContainer #hotelLocation,"+"#hotelWidgetSearchContainer #numberOfRoomsWidget,"+"#hotelWidgetSearchContainer #numberOfAdultsWidget,"+"#hotelWidgetSearchContainer #numberOfChildrenWidget,"+"#hotelWidgetSearchContainer #hotelWidgetHelpIcon,"+"#hotelWidgetSearchContainer #hotelTripSubmit,"+"#hotelWidgetSearchContainer #advancedSearchHotelWidget").click(function(){if($(".delta2UpCal").is(":visible")){delta.deltaPolCalendarMgr.closeAll();}});$("#searchHotelWidgetForm").validate({rules:{destinationCityCodeForWidget:{destinationCityCodeForWidget:true,required:true},checkInDate:{hotelWidgetDate:true,hotelWidgetPastDate:true},checkOutDate:{hotelWidgetDate:true,hotelWidgetPastDate:true,greaterThan:"#checkInDateWidget"}},messages:{checkInDate:{hotelWidgetDate:function(element){$("#checkinDateErrorWidget").css('display','block');var message="Please enter a valid date in mm/dd/yyyy format";if($("#checkInDateWidget").val()=="mm/dd/yyyy"||$("#checkInDateWidget").val()==""){$("#checkInDateWidget").addClass('auto-hint');message="Please enter a valid Check-in Date";}
return message;},hotelWidgetPastDate:function(element){$("#checkinDateErrorWidget").css('display','block');var message="Please select future date";return message;}},checkOutDate:{hotelWidgetDate:function(element){$("#checkOutDateErrorWidget").css('display','block');var message="Please enter a valid date in mm/dd/yyyy format";if($("#checkOutDateWidget").val()=="mm/dd/yyyy"||$("#checkOutDateWidget").val()==""){$("#checkOutDateWidget").addClass('auto-hint');message="Please enter a valid Check-out Date";}
return message;},hotelWidgetPastDate:function(element){$("#checkOutDateErrorWidget").css('display','block');var message="Please select future date";return message;},greaterThan:function(element){$("#checkOutDateErrorWidget").css('display','block');$("#checkInDateWidget").addClass('error').removeClass('auto-hint');var message="Please select an earlier check-in date or a later check-out date.";return message;}}},errorPlacement:function(error,element){if(element.is("#checkInDateWidget")){if(element.val()=="mm/dd/yyyy"){error.html("Please enter a valid Check-in Date");}
error.appendTo($("#checkinDateErrorWidget"));}else if(element.is("#checkOutDateWidget")){if(element.val()=="mm/dd/yyyy"){error.html("Please enter a valid Check-out Date");}
error.appendTo($("#checkOutDateErrorWidget"));}else if(element.is("#hotelLocation")){$("#widgetGoogleLocationError").css('display','none');error.appendTo($("#locationWidgetError"));}
delta.navwidget.adjustWidgetHeight("booking");},success:function(label){if(label.attr('for')=="checkInDateWidget"){$("#checkinDateErrorWidget").css('display','none');$("#checkInDateWidget").removeClass('auto-hint');}else if(label.attr('for')=="checkOutDateWidget"){$("#checkOutDateErrorWidget").css('display','none');$("#checkOutDateWidget").removeClass('auto-hint');}else if(label.attr('for')=="hotelLocation"){$("#locationWidgetError").css('display','none');}
resizeHotelWidget.resize();},onkeyup:false,onfocusout:false,submitHandler:function(searchHotelWidgetForm){if($("#numberOfRoomsWidget").val()>1){$("#hwNumberOfAdultsSelected").val("2");$("#hwNumberOfChildSelected").val("0");}else{$("#hwNumberOfAdultsSelected").val($("#numberOfAdultsWidget").val());$("#hwNumberOfChildSelected").val($("#numberOfChildrenWidget").val());}
if(HotelWidget.isAdvancedSearch){setTimeout(function(){MerchandisingWidget.submitDelayedForm(searchHotelWidgetForm);},MerchandisingWidget.delayForFormSubmission);}else{var noOfRooms=1;var noOfAdults=1;var noOfChildren=0;noOfRooms=$("#numberOfRoomsWidget").val();var noOfRoomsSelected=$("#numberOfRoomsWidget").val();$("#hotelWidgetSearchType").val("showHotelResult");noOfAdults=$("#numberOfAdultsWidget").val();noOfChildren=$("#numberOfChildrenWidget").val();widgetDWRView.noOfRooms=noOfRoomsSelected;widgetDWRView.noOfChildren=noOfChildren;widgetDWRView.form=searchHotelWidgetForm;var googleGeoCodeFlag=false;var $locationCode=$("#locationCodeWidget").val();var address=($locationCode=="")?$("#hotelLocation").val():$locationCode;if(($locationCode.length==0)&&$("#hotelLocation").val()!="Airport, City, Attraction or Address"){googleGeoCodeFlag=true;if($locationCode.length==0&&$("#hotelLocation").val().length>=3){widgetDWRView.requestGeocoder('getGeoCodes',address);}}else{$("#locationErrorMsg").hide();}
if((noOfRoomsSelected==1&&!HotelWidget.multiRoomFlag)&&noOfChildren>0){if(googleGeoCodeFlag!=true){HotelWidget.multiRoomFlag=true;HotelWidget.setRecentSearchCriteria(false);$("#hotelWidgetSearchType").val("showHotelWidgetRoom");var actionURL="https://"+window.location.hostname+"/merch/hotelWidgetAction.action";$("#searchHotelWidgetForm").attr("action",actionURL);setTimeout(function(){MerchandisingWidget.submitDelayedForm(searchHotelWidgetForm);},MerchandisingWidget.delayForFormSubmission);}}else{if(googleGeoCodeFlag!=true){HotelWidget.setRecentSearchCriteria(false);setTimeout(function(){MerchandisingWidget.submitDelayedForm(searchHotelWidgetForm);},MerchandisingWidget.delayForFormSubmission);}}}}});}};var resizeHotelWidget={resize:function(){setTimeout(function(){var widgetContainer=$("#widget-booking");widgetContainer.css("height",resizeHotelWidget.getWidgetHeight());},1);},getWidgetHeight:function(){var hotelContainer=$("#book-tabs");var adjustHeight=15;if(HotelWidget.recentSearchHeight===15){adjustHeight=0;}
return adjustHeight+hotelContainer.height()+hotelContainer.position().top+(!delta.navwidget.isDockedState()?0:33);}};var HotelWidgetLocationPrediction={hotelWidgetLocationPredictionHandler:function(request,response){var userInput=request.term.replace(/^\s+/g,"");$("#locationCodeWidget").val("");$("#locationTypeCodeWidget").val("");if(userInput.length<3){var array=new Array();response(array);}else{var locationCodes=new Array();locationCodes.push("ACX");locationCodes.push("CITY");if(userInput.length>=3&&locationCodes!=null){var searchKey=userInput.length>3?userInput.substring(0,3):userInput;var queryCode=new Array();var cachedRecordsMatched=new Array();var cachedRecords=null;var tempArray=null;for(var i=0;i<locationCodes.length;i++){if(!LocationsCacheUtil.existsInCache(userInput,locationCodes[i])){queryCode.push(locationCodes[i]);}else{cachedRecords=LocationsCacheUtil.getFromCache(userInput,locationCodes[i]);tempArray=new Array();$.each(cachedRecords,function(index,value){if(userInput.toLowerCase()==searchKey.toLowerCase()){tempArray.push(value);}else if(LocationsCacheUtil.isLocationMatching(userInput,locationCodes[i],value)){tempArray.push(value);}});if(tempArray.length>0){cachedRecordsMatched=cachedRecordsMatched.concat(tempArray);}}}
if(queryCode.length==0){response($.map(cachedRecordsMatched,function(item){return{label:item.locationName,value:item.locationName,id:item.locationCode,type:item.locationTypeCode}}));}else{response(Predictive.getPredictiveLocations(searchKey,queryCode,{callback:function(nameList){var matchedRecords=new Array();if(nameList.locationDWR!=null){LocationsCacheUtil.putToCache(searchKey,queryCode,nameList);for(var i=0;i<queryCode.length;i++){$.each(nameList.locationDWR,function(index,value){if(value.locationTypeCode.toLowerCase()==queryCode[i].toLowerCase()){if(userInput.toLowerCase()==searchKey.toLowerCase()){matchedRecords.push(value);}else if(LocationsCacheUtil.isLocationMatching(userInput,queryCode[i],value)){matchedRecords.push(value);}}});}}
if(cachedRecordsMatched.length>0){matchedRecords=matchedRecords.concat(cachedRecordsMatched);}
response($.map(matchedRecords,function(item){return{label:item.locationName,value:item.locationName,id:item.locationCode,type:item.locationTypeCode}}));}}));}}}}};(function($){var map=new Array();$.Watermark={ShowAll:function(){for(var i=0;i<map.length;i++){if(map[i].obj.val()==""){map[i].obj.val(map[i].text);map[i].obj.css("color",map[i].WatermarkColor);}else{map[i].obj.css("color",map[i].DefaultColor);}}},HideAll:function(){for(var i=0;i<map.length;i++){if(map[i].obj.val()==map[i].text)
map[i].obj.val("");}}}
$.fn.Watermark=function(text,color){if(!color)
color="#aaa";return this.each(function(){var input=$(this);var defaultColor=input.css("color");map[map.length]={text:text,obj:input,DefaultColor:defaultColor,WatermarkColor:color};function clearMessage(){if(input.val()==text)
input.val("");input.css("color",defaultColor);}
function insertMessage(){if(input.val().length==0||input.val()==text){input.val(text);input.css("color",color);}else
input.css("color",defaultColor);}
input.focus(clearMessage);input.blur(insertMessage);input.change(insertMessage);insertMessage();});};})(jQuery);jQuery.validator.messages.destinationCityCodeForWidget="We're sorry. No cities or airport codes matched that entry. Please try again.";jQuery.validator.classRuleSettings.destinationCityCodeForWidget={destinationCityCodeForWidget:true};jQuery.validator.addMethod("destinationCityCodeForWidget",function(value,element,param){$("#widgetGoogleLocationError").css('display','none');if(value.length>=3&&value!="Airport, City, Attraction or Address"){var iChars="&!#@$%^*+{}";for(var i=0;i<value.length;i++){if(iChars.indexOf(value.charAt(i))!=-1){$("#locationWidgetError").css('display','block');resizeHotelWidget.resize();return false;}}
$("#locationWidgetError").css('display','none');resizeHotelWidget.resize();return true;}else{$("#locationWidgetError").css('display','block');resizeHotelWidget.resize();return false;}},jQuery.validator.messages.destinationCityCodeForWidget);jQuery.validator.messages.destinationCityCodeforCarWidget="We're sorry. No cities or airport codes matched that entry. Please try again.";jQuery.validator.classRuleSettings.destinationCityCodeforCarWidget={destinationCityCodeforCarWidget:true};jQuery.validator.addMethod("destinationCityCodeforCarWidget",function(value,element,param){if(value.length>=3&&value!="Airport or Metro City"){$("#pickupWidgetLocationError").css('display','none');resizeCarWidget.resize();return true;}else{$("#pickupWidgetLocationError").css('display','block');resizeCarWidget.resize();return false;}},jQuery.validator.messages.destinationCityCodeforCarWidget);jQuery.validator.messages.dropOffLocationCodeCarWidget="We're sorry. No cities or airport codes matched that entry. Please try again.";jQuery.validator.classRuleSettings.dropOffLocationCodeCarWidget={dropOffLocationCodeCarWidget:true};jQuery.validator.addMethod("dropOffLocationCodeCarWidget",function(value,element,param){if(value.length>=3&&value!="Airport or Metro City"){$("#carSearchDropLocationWidgetError").css('display','none');resizeCarWidget.resize();return true;}else{$("#carSearchDropLocationWidgetError").css('display','block');resizeCarWidget.resize();return false;}},jQuery.validator.messages.dropOffLocationCodeCarWidget);jQuery.validator.messages.isCarPickUpPredictiveText="We're sorry. No cities or airport codes matched that entry. Please try again.";jQuery.validator.addMethod("isCarPickUpPredictiveText",function(value,element,param){if($(param).val().length==3){$("#pickupWidgetLocationError").css('display','none');resizeCarWidget.resize();return true;}
else{$("#pickupWidgetLocationError").css('display','block');resizeCarWidget.resize();return false;}},jQuery.validator.messages.isCarPickUpPredictiveText);jQuery.validator.messages.isCarDropOffPredictiveText="We're sorry. No cities or airport codes matched that entry. Please try again.";jQuery.validator.addMethod("isCarDropOffPredictiveText",function(value,element,param){if($(param).val().length==3){$("#carSearchDropLocationWidgetError").css('display','none');resizeCarWidget.resize();return true;}
else{$("#carSearchDropLocationWidgetError").css('display','block');resizeCarWidget.resize();return false;}},jQuery.validator.messages.isCarDropOffPredictiveText);jQuery.validator.messages.pickupLocation="Please enter the valid Pick-up City/Airport";jQuery.validator.classRuleSettings.pickupLocation={pickupLocation:true};jQuery.validator.addMethod("pickupLocation",function(value,element,param){if(value.length>0&&value.match(/^[a-zA-Z][a-zA-Z,\s]+$/)){return true;}else{return false;}},jQuery.validator.messages.pickupLocation);jQuery.validator.messages.dropOffCity="Please enter the valid Drop-up City/Airport";jQuery.validator.classRuleSettings.dropOffCity={dropOffCity:true};jQuery.validator.addMethod("dropOffCity",function(value,element,param){if(value.length>0&&value.match(/^[a-zA-Z][a-zA-Z,\s]+$/)){return true;}else{return false;}},jQuery.validator.messages.dropOffCity);jQuery.validator.messages.greaterThan="To Date Must be greater than or equal to From Date.";jQuery.validator.addMethod("greaterThan",function(value,element,params){if($(params).val()==""||$(params).val()=="mm/dd/yyyy"){return true;}
if(!/Invalid|NaN/.test(new Date(value))){return new Date(value)>new Date($(params).val());}
return isNaN(value)&&isNaN($(params).val())||(parseFloat(value)>parseFloat($(params).val()));},jQuery.validator.messages.greaterThan);jQuery.validator.messages.greaterThanEqual="To Date Must be greater than or equal to From Date.";jQuery.validator.addMethod("greaterThanEqual",function(value,element,params){if($(params).val()==""||$(params).val()=="mm/dd/yyyy"){return true;}
if(!/Invalid|NaN/.test(new Date(value))){return new Date(value)>=new Date($(params).val());}
return isNaN(value)&&isNaN($(params).val())||(parseFloat(value)>parseFloat($(params).val()));},jQuery.validator.messages.greaterThanEqual);jQuery.validator.messages.timeGreaterThanWidget="To Time Must be greater than From Time.";jQuery.validator.addMethod("timeGreaterThanWidget",function(value,element,params){var flag=true;var fromTimeWithAMOrPM=$(params).val().split(" ");fromTime=fromTimeWithAMOrPM[0];fromTimeAmOrPm=fromTimeWithAMOrPM[1];var toTimeWithAMOrPM=value.split(" ");toTime=toTimeWithAMOrPM[0];toTimeAmOrPm=toTimeWithAMOrPM[1];var fromTimeArr=fromTime.split(":");var fromTimeHour=fromTimeArr[0];var toTimeArr=toTime.split(":");var toTimeHour=toTimeArr[0];var pickUpDt=$('#pickUpWidgetDate').val();var dropOffDt=$('#dropOffWidgetDate').val();if(pickUpDt=="mm/dd/yyyy"||dropOffDt=="mm/dd/yyyy"){flag=true;}
if(pickUpDt==dropOffDt&&pickUpDt!="mm/dd/yyyy"&&dropOffDt!="mm/dd/yyyy"){flag=Date.parse(pickUpDt+" "+fromTime+" "+fromTimeAmOrPm)<Date.parse(dropOffDt+" "+toTime+" "+toTimeAmOrPm);}
return flag;},jQuery.validator.messages.timeGreaterThanWidget);jQuery.validator.messages.hotelWidgetDate="Please enter a valid date in mm/dd/yyyy format";jQuery.validator.classRuleSettings.hotelWidgetDate={hotelWidgetDate:true};jQuery.validator.addMethod("hotelWidgetDate",function(value,element,param){value=DeltaUtils.removeSpaces(value);try{var re=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(value.match(re)){jQuery.datepicker.parseDate('mm/dd/yy',value);resizeHotelWidget.resize();return true;}else{resizeHotelWidget.resize();return false;}}
catch(exception){resizeHotelWidget.resize();return false;}},jQuery.validator.messages.hotelWidgetDate);jQuery.validator.messages.carWidgetDate="Please enter a valid date in mm/dd/yyyy format";jQuery.validator.classRuleSettings.carWidgetDate={carWidgetDate:true};jQuery.validator.addMethod("carWidgetDate",function(value,element,param){value=DeltaUtils.removeSpaces(value);try{var re=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(value.match(re)){jQuery.datepicker.parseDate('mm/dd/yy',value);resizeCarWidget.resize();return true;}else{resizeCarWidget.resize();return false;}}
catch(exception){resizeCarWidget.resize();return false;}},jQuery.validator.messages.carWidgetDate);jQuery.validator.messages.hotelWidgetPastDate="Please select future date";jQuery.validator.addMethod("hotelWidgetPastDate",function(value,element){var today=new Date().toDateString();var dateValue=new Date(value).toDateString();if(today!=dateValue){if(new Date().getTime()>new Date(value).getTime()){resizeHotelWidget.resize();return false;}}
resizeHotelWidget.resize();return true;},jQuery.validator.messages.hotelWidgetPastDate);jQuery.validator.messages.carWidgetPastDate="Please select future date";jQuery.validator.addMethod("carWidgetPastDate",function(value,element){var today=new Date().toDateString();var dateValue=new Date(value).toDateString();if(today!=dateValue){if(new Date().getTime()>new Date(value).getTime()){resizeCarWidget.resize();return false;}}
resizeCarWidget.resize();return true;},jQuery.validator.messages.carWidgetPastDate);var MerchandisingWidget={delayForFormSubmission:100,submitDelayedForm:function(form){form.submit();},setErrorCodes:function(formName,exception,errorCodes,actionName){$("#errorCodes").val(errorCodes);$("#"+formName).attr("action",actionName);$("#"+formName).submit();},errorTracker:function(pageName,errorType,errorCodes){merchErrorTracker(pageName,errorType,errorCodes);},errorHandling:function(){$(".javaErrorDiv").hide();var errorCodes=$("#errorCodes").val();if(errorCodes!=undefined&&errorCodes!='null'&&errorCodes!=null&&errorCodes!=""){var index=errorCodes.indexOf("[");if(index>-1){errorCodes=errorCodes.substring(index+1,errorCodes.length-1);}
$(".javaErrorDiv").show();var errors=errorCodes.split(",");if(errors.length>0){for(var i=0;i<errors.length;i++){var errorCode=errors[i];if(errorCode!=""){var errCd={"error":{"errorCode":errorCode,"errorMsg":null}};if(errorCode.indexOf("MST")>=0){InLineError.displayInlineError("json",errCd,".javaErrorDiv","","merch");}}}}}},setHotelCalendarControl:function(fromFieldId,toFieldId,fromFieldName,toFieldName){var language="en";var country="US";var displayFormat="MM/dd/yyyy";var langcntryRegEx=/^[a-zA-Z]{2}$/;var locationObj=window.location;var protocol=locationObj.protocol;var host=locationObj.host;var ctx=protocol+"//"+host;delta.calendar.globalConfiguration();delta.calendar.create({calendarElement:$('.hotelDateFieldWrap'),daysInFutureToShow:331,daysInPastToShow:0,startDateTitle:fromFieldName,endDateTitle:toFieldName,onSelect:MerchandisingWidget.triggerCheckInDateEvent,showDropDown:true});},triggerCheckInDateEvent:function(){$("#checkInDateWidget").trigger("change");},setCarCalendarControl:function(fromFieldId,toFieldId,fromFieldName,toFieldName){var language="en";var country="US";var displayFormat="MM/dd/yyyy";var langcntryRegEx=/^[a-zA-Z]{2}$/;var locationObj=window.location;var protocol=locationObj.protocol;var host=locationObj.host;var ctx=protocol+"//"+host;delta.calendar.create({calendarElement:$('.carRentalDateFieldWrap'),daysInFutureToShow:331,daysInPastToShow:0,startDateTitle:fromFieldName,endDateTitle:toFieldName,showDropDown:true});},getDateForRecentSearch:function(date){if(date!=""&&date!="mm/dd/yyyy"){var originalDateArray=date.split("/");var formatedDate=originalDateArray[0]+"/"+originalDateArray[1]+"/"+originalDateArray[2].substring(2);return formatedDate;}else
return date;},truncate:function(val,limit){var lim=limit;var criteria=val;if(criteria.length>limit){return criteria=criteria.substring(0,lim)+"...";}else{return criteria;}}};var merchTabs={removeTabClass:function(productId){$(productId).removeClass("ui-widget");$(productId).removeClass("ui-widget-content");$(productId).removeClass("ui-corner-all");},removeTabHeadingClass:function(productId){$(productId).removeClass("ui-widget-header");$(productId).removeClass("ui-corner-all");},removeFirstTabClass:function(productId){$(productId).removeClass("ui-widget-content");$(productId).removeClass("ui-corner-bottom");$(productId).removeClass("ui-corner-top");},removeSecondTabClass:function(productId){$(productId).removeClass("ui-widget-content");$(productId).removeClass("ui-corner-bottom");$(productId).removeClass("ui-corner-top");},removeThirdTabClass:function(productId){$(productId).removeClass("ui-widget-content");$(productId).removeClass("ui-corner-bottom");$(productId).removeClass("ui-corner-top");},removeFirstTabLinkClass:function(productId){$(productId).removeClass("ui-tabs-panel");$(productId).removeClass("ui-widget-content");},removeSecondTabLinkClass:function(productId){$(productId).removeClass("ui-tabs-panel");$(productId).removeClass("ui-widget-content");},removeThirdTabLinkClass:function(productId){$(productId).removeClass("ui-tabs-panel");$(productId).removeClass("ui-widget-content");}};var widgetDWRController={requestGeocoder:function(fnName,address){var methodName=fnName;GetGeocodeDwr[methodName](address,"",widgetDWRModel.processGeoCodeResponse);}};var widgetDWRModel={processGeoCodeResponse:function(jsonObject){widgetDWRView.processGeocoderResponse(jsonObject);}};var widgetDWRView={noOfRooms:null,noOfChildren:null,form:null,requestGeocoder:function(methodName,address){widgetDWRController.requestGeocoder(methodName,address);},processGeocoderResponse:function(jsonObject){if(jsonObject!=null&&jsonObject[0].status!=null&&jsonObject[0].status=='OK'){var locationCoordinates=new Array();$("#locationWidgetError").css('display','none');var results=jsonObject[0].results;var resultsLength=results.length;for(var i=0;i<resultsLength;i++){if(results[i].addressComponents!=null&&results[i].addressComponents.length>0){for(var j=0;j<results[i].addressComponents.length;j++){if(results[i].addressComponents[j].types!=null&&results[i].addressComponents[j].types.length>0){for(var k=0;k<results[i].addressComponents[j].types.length;k++){if(results[i].addressComponents[j].types[k]=="locality"){$("#hotelLocation").val(results[i].addressComponents[j].longName);break;}}}}}
var temp=[];temp[0]=results[i].geometry.location.lat;temp[1]=results[i].geometry.location.lng;locationCoordinates[i]="("+temp+")";$("#hotelPositionsWidget").val(locationCoordinates);}
if(this.noOfRooms==1&&this.noOfChildren>0){HotelWidget.multiRoomFlag=true;$("#hotelWidgetSearchType").val("showHotelWidgetRoom");$("#searchHotelWidgetForm").attr("action","/merch/hotelWidgetAction.action");HotelWidget.setRecentSearchCriteria(true);setTimeout(function(){MerchandisingWidget.submitDelayedForm(widgetDWRView.form);},MerchandisingWidget.delayForFormSubmission);}else{if($("#hotelPositionsWidget").val().length>0){HotelWidget.setRecentSearchCriteria(true);setTimeout(function(){MerchandisingWidget.submitDelayedForm(widgetDWRView.form);},MerchandisingWidget.delayForFormSubmission);}}}else{$("#widgetGoogleLocationError").css('display','block');$("#widgetGeoCoderErrorLabel").css('display','block');$("#hotelLocation").addClass('error');resizeHotelWidget.resize();}}};var CarWidgetLocationPrediction={widgetLocationCodes:[],carWidgetLocationPredictionHandler:function(request,response){var userInput=request.term.replace(/^\s+/g,"");if(this.element.attr('id')=="carLocation"){$("#predictiveLocationCode").val("");}else{$("#dropOffWidgetLocationCode").val("");}
if(userInput.length<3){var array=new Array();response(array);}else{if(RentalCarsCacheUtil.existsInCache(userInput)){var nameList=RentalCarsCacheUtil.getFromCache(userInput);var array=new Array();if(nameList.rentalCarDWR!=null){$.each(nameList.rentalCarDWR,function(index,value){if(RentalCarsCacheUtil.isRentalCarMatching(userInput,value)){array.push(value);}});}
response($.map(array,function(item){return{label:item.locationCode+" ("+item.city+")",value:item.city,id:item.locationCode,airportName:item.description}}));}else{var searchKey=userInput.length>3?userInput.substring(0,3):userInput;response(Predictive.getPredictiveRentalCars(searchKey,{callback:function(nameList){array=new Array();if(nameList.rentalCarDWR!=null){RentalCarsCacheUtil.putToCache(searchKey,nameList);$.each(nameList.rentalCarDWR,function(index,value){if(RentalCarsCacheUtil.isRentalCarMatching(userInput,value)){array.push(value);}});}
response($.map(array,function(item){return{label:item.locationCode+" ("+item.city+")",value:item.city,id:item.locationCode,airportName:item.description}}));}}));}}}};
var needHelpcontactinformation={"res_sky":[{"contactid":"res_skymiles"}],"res_dom":[{"contactid":"res_dom"}],"res_inter":[{"contactid":"res_inter"}],"sky":[{"contactid":"skymilesaccsupport"}],"tec":[{"contactid":"techsupportapp"}],"cus":[{"contactid":"customercare"}],"bag":[{"contactid":"baggageservice"}],"car":[{"contactid":"deltacargo"}],"grp":[{"contactid":"grp_information"}],"lan":[{"contactid":"res_ass_lang"}],"burkinafaso":[{"contactid":"burkinafaso"}],"cameroon":[{"contactid":"cameroon"}],"cotedivoire":[{"contactid":"cotedivoire"}],"egypt":[{"contactid":"egypt"}],"ghana":[{"contactid":"ghana"}],"kenya":[{"contactid":"kenya"}],"liberia":[{"contactid":"liberia"}],"mali":[{"contactid":"mali"}],"mauritania":[{"contactid":"mauritania"}],"morocco":[{"contactid":"morocco"}],"namibia":[{"contactid":"namibia"}],"nigeria":[{"contactid":"nigeria"}],"senegal":[{"contactid":"senegal"}],"south_africa":[{"contactid":"south_africa"}],"togo":[{"contactid":"togo"}],"cambodia":[{"contactid":"cambodia"}],"china":[{"contactid":"china"}],"india":[{"contactid":"india"}],"indonesia":[{"contactid":"indonesia"}],"japan":[{"contactid":"japan"}],"malaysia":[{"contactid":"malaysia"}],"philippines":[{"contactid":"philippines"}],"singapore":[{"contactid":"singapore"}],"southkorea":[{"contactid":"southkorea"}],"srilanka":[{"contactid":"srilanka"}],"taiwan":[{"contactid":"taiwan"}],"thailand":[{"contactid":"thailand"}],"vietnam":[{"contactid":"vietnam"}],"antigua":[{"contactid":"antigua"}],"aruba":[{"contactid":"aruba"}],"bahamas":[{"contactid":"bahamas"}],"barbados":[{"contactid":"barbados"}],"bermuda":[{"contactid":"bermuda"}],"bonaire_curacao":[{"contactid":"bonaire_curacao"}],"cayman_islands":[{"contactid":"cayman_islands"}],"dominican_republic":[{"contactid":"dominican_republic"}],"grenada":[{"contactid":"grenada"}],"haiti":[{"contactid":"haiti"}],"jamaica":[{"contactid":"jamaica"}],"puerto_rico":[{"contactid":"puerto_rico"}],"kitts":[{"contactid":"kitts"}],"lucia":[{"contactid":"lucia"}],"maarten":[{"contactid":"maarten"}],"trinidad_tobago":[{"contactid":"trinidad_tobago"}],"turks_caicos":[{"contactid":"turks_caicos"}],"virgin_islands":[{"contactid":"virgin_islands"}],"austria":[{"contactid":"austria"}],"belgium":[{"contactid":"belgium"}],"bosnia_herzegovina":[{"contactid":"bosnia_herzegovina"}],"croatia":[{"contactid":"croatia"}],"czech_republic":[{"contactid":"czech_republic"}],"denmark":[{"contactid":"denmark"}],"england":[{"contactid":"england"}],"finland":[{"contactid":"finland"}],"france":[{"contactid":"france"}],"germany":[{"contactid":"germany"}],"great_britain":[{"contactid":"great_britain"}],"greece":[{"contactid":"greece"}],"hungary":[{"contactid":"hungary"}],"iceland":[{"contactid":"iceland"}],"ireland":[{"contactid":"ireland"}],"italy":[{"contactid":"italy"}],"macedonia":[{"contactid":"macedonia"}],"montenegro":[{"contactid":"montenegro"}],"netherlands":[{"contactid":"netherlands"}],"norway":[{"contactid":"norway"}],"poland":[{"contactid":"poland"}],"portugal":[{"contactid":"portugal"}],"romania":[{"contactid":"romania"}],"russian_federation":[{"contactid":"russian_federation"}],"all_other_cities":[{"contactid":"all_other_cities"}],"serbia":[{"contactid":"serbia"}],"slovak_republic":[{"contactid":"slovak_republic"}],"slovenia":[{"contactid":"slovenia"}],"spain":[{"contactid":"spain"}],"sweden":[{"contactid":"sweden"}],"switzerland":[{"contactid":"switzerland"}],"turkey":[{"contactid":"turkey"}],"ukraine":[{"contactid":"ukraine"}],"united_kingdom":[{"contactid":"united_kingdom"}],"belize":[{"contactid":"belize"}],"costa_rica":[{"contactid":"costa_rica"}],"el_salvador":[{"contactid":"el_salvador"}],"guatemala":[{"contactid":"guatemala"}],"honduras":[{"contactid":"honduras"}],"mexico":[{"contactid":"mexico"}],"nicaragua":[{"contactid":"nicaragua"}],"panama":[{"contactid":"panama"}],"bahrain":[{"contactid":"bahrain"}],"israel":[{"contactid":"israel"}],"jordan":[{"contactid":"jordan"}],"kuwait":[{"contactid":"kuwait"}],"palestine":[{"contactid":"palestine"}],"qatar":[{"contactid":"qatar"}],"saudi_arabia":[{"contactid":"saudi_arabia"}],"united_arab_emirates":[{"contactid":"united_arab_emirates"}],"australia":[{"contactid":"australia"}],"new_zealand":[{"contactid":"new_zealand"}],"argentina":[{"contactid":"argentina"}],"brazil":[{"contactid":"brazil"}],"chile":[{"contactid":"chile"}],"colombia":[{"contactid":"colombia"}],"ecuador":[{"contactid":"ecuador"}],"guyana":[{"contactid":"guyana"}],"peru":[{"contactid":"peru"}],"uruguay":[{"contactid":"uruguay"}],"venezuela":[{"contactid":"venezuela"}],"res_skymiles_true":[{"contactid":"res_skymiles_true_div"}]};var allneedHelpContactInfo={"allDivName":[{"divname":"res_skymiles"},{"divname":"res_dom"},{"divname":"res_inter"},{"divname":"skymilesaccsupport"},{"divname":"techsupportapp"},{"divname":"customercare"},{"divname":"baggageservice"},{"divname":"deltacargo"},{"divname":"grp_information"},{"divname":"res_ass_lang"},{"divname":"burkinafaso"},{"divname":"cameroon"},{"divname":"cotedivoire"},{"divname":"egypt"},{"divname":"ghana"},{"divname":"kenya"},{"divname":"liberia"},{"divname":"mali"},{"divname":"mauritania"},{"divname":"morocco"},{"divname":"namibia"},{"divname":"nigeria"},{"divname":"senegal"},{"divname":"south_africa"},{"divname":"togo"},{"divname":"cambodia"},{"divname":"china"},{"divname":"india"},{"divname":"indonesia"},{"divname":"japan"},{"divname":"malaysia"},{"divname":"philippines"},{"divname":"singapore"},{"divname":"southkorea"},{"divname":"srilanka"},{"divname":"taiwan"},{"divname":"thailand"},{"divname":"vietnam"},{"divname":"antigua"},{"divname":"aruba"},{"divname":"bahamas"},{"divname":"barbados"},{"divname":"bermuda"},{"divname":"bonaire_curacao"},{"divname":"cayman_islands"},{"divname":"dominican_republic"},{"divname":"grenada"},{"divname":"haiti"},{"divname":"jamaica"},{"divname":"puerto_rico"},{"divname":"kitts"},{"divname":"lucia"},{"divname":"maarten"},{"divname":"trinidad_tobago"},{"divname":"turks_caicos"},{"divname":"virgin_islands"},{"divname":"austria"},{"divname":"belgium"},{"divname":"bosnia_herzegovina"},{"divname":"croatia"},{"divname":"czech_republic"},{"divname":"denmark"},{"divname":"england"},{"divname":"finland"},{"divname":"france"},{"divname":"germany"},{"divname":"great_britain"},{"divname":"greece"},{"divname":"hungary"},{"divname":"iceland"},{"divname":"ireland"},{"divname":"italy"},{"divname":"macedonia"},{"divname":"montenegro"},{"divname":"netherlands"},{"divname":"norway"},{"divname":"poland"},{"divname":"portugal"},{"divname":"romania"},{"divname":"russian_federation"},{"divname":"all_other_cities"},{"divname":"serbia"},{"divname":"slovak_republic"},{"divname":"slovenia"},{"divname":"spain"},{"divname":"sweden"},{"divname":"switzerland"},{"divname":"turkey"},{"divname":"ukraine"},{"divname":"united_kingdom"},{"divname":"belize"},{"divname":"costa_rica"},{"divname":"el_salvador"},{"divname":"guatemala"},{"divname":"honduras"},{"divname":"mexico"},{"divname":"nicaragua"},{"divname":"panama"},{"divname":"bahrain"},{"divname":"israel"},{"divname":"jordan"},{"divname":"kuwait"},{"divname":"palestine"},{"divname":"qatar"},{"divname":"saudi_arabia"},{"divname":"united_arab_emirates"},{"divname":"australia"},{"divname":"new_zealand"},{"divname":"argentina"},{"divname":"brazil"},{"divname":"chile"},{"divname":"colombia"},{"divname":"ecuador"},{"divname":"guyana"},{"divname":"peru"},{"divname":"uruguay"},{"divname":"venezuela"},{"divname":"viewallcontact"},{"divname":"res_skymiles_true_div"}]};var needHelpdropdownList={"af":[{"optionvalue":"burkinafaso","optionlist":"Burkina Faso"},{"optionvalue":"cameroon","optionlist":"Cameroon"},{"optionvalue":"cotedivoire","optionlist":"C&#244;te d'Ivoire"},{"optionvalue":"egypt","optionlist":"Egypt"},{"optionvalue":"ghana","optionlist":"Ghana"},{"optionvalue":"kenya","optionlist":"Kenya"},{"optionvalue":"liberia","optionlist":"Liberia"},{"optionvalue":"mali","optionlist":"Mali"},{"optionvalue":"mauritania","optionlist":"Mauritania"},{"optionvalue":"morocco","optionlist":"Morocco"},{"optionvalue":"namibia","optionlist":"Namibia"},{"optionvalue":"nigeria","optionlist":"Nigeria"},{"optionvalue":"senegal","optionlist":"Senegal"},{"optionvalue":"south_africa","optionlist":"South Africa"},{"optionvalue":"togo","optionlist":"Togo"}],"as":[{"optionvalue":"cambodia","optionlist":"Cambodia"},{"optionvalue":"china","optionlist":"China"},{"optionvalue":"india","optionlist":"India"},{"optionvalue":"indonesia","optionlist":"Indonesia"},{"optionvalue":"japan","optionlist":"Japan"},{"optionvalue":"malaysia","optionlist":"Malaysia"},{"optionvalue":"philippines","optionlist":"Philippines"},{"optionvalue":"singapore","optionlist":"Singapore"},{"optionvalue":"southkorea","optionlist":"South Korea"},{"optionvalue":"srilanka","optionlist":"Sri Lanka"},{"optionvalue":"taiwan","optionlist":"Taiwan"},{"optionvalue":"thailand","optionlist":"Thailand"},{"optionvalue":"vietnam","optionlist":"Vietnam"}],"ca":[{"optionvalue":"antigua","optionlist":"Antigua"},{"optionvalue":"aruba","optionlist":"Aruba"},{"optionvalue":"bahamas","optionlist":"Bahamas"},{"optionvalue":"barbados","optionlist":"Barbados"},{"optionvalue":"bermuda","optionlist":"Bermuda"},{"optionvalue":"bonaire_curacao","optionlist":"Bonaire and Curacao"},{"optionvalue":"cayman_islands","optionlist":"Cayman Islands"},{"optionvalue":"dominican_republic","optionlist":"Dominican Republic"},{"optionvalue":"grenada","optionlist":"Grenada"},{"optionvalue":"haiti","optionlist":"Haiti"},{"optionvalue":"jamaica","optionlist":"Jamaica"},{"optionvalue":"puerto_rico","optionlist":"Puerto Rico"},{"optionvalue":"kitts","optionlist":"St. Kitts"},{"optionvalue":"lucia","optionlist":"St. Lucia"},{"optionvalue":"maarten","optionlist":"St. Maarten"},{"optionvalue":"trinidad_tobago","optionlist":"Trinidad and Tobago"},{"optionvalue":"turks_caicos","optionlist":"Turks and Caicos"},{"optionvalue":"virgin_islands","optionlist":"Virgin Islands"}],"eu":[{"optionvalue":"austria","optionlist":"Austria"},{"optionvalue":"belgium","optionlist":"Belgium"},{"optionvalue":"bosnia_herzegovina","optionlist":"Bosnia-Herzegovina"},{"optionvalue":"croatia","optionlist":"Croatia"},{"optionvalue":"czech_republic","optionlist":"Czech Republic"},{"optionvalue":"denmark","optionlist":"Denmark"},{"optionvalue":"england","optionlist":"England"},{"optionvalue":"finland","optionlist":"Finland"},{"optionvalue":"france","optionlist":"France"},{"optionvalue":"germany","optionlist":"Germany"},{"optionvalue":"great_britain","optionlist":"Great Britain"},{"optionvalue":"greece","optionlist":"Greece"},{"optionvalue":"hungary","optionlist":"Hungary"},{"optionvalue":"iceland","optionlist":"Iceland"},{"optionvalue":"ireland","optionlist":"Ireland"},{"optionvalue":"italy","optionlist":"Italy"},{"optionvalue":"macedonia","optionlist":"Macedonia"},{"optionvalue":"montenegro","optionlist":"Montenegro"},{"optionvalue":"netherlands","optionlist":"Netherlands"},{"optionvalue":"norway","optionlist":"Norway"},{"optionvalue":"poland","optionlist":"Poland"},{"optionvalue":"portugal","optionlist":"Portugal"},{"optionvalue":"romania","optionlist":"Romania"},{"optionvalue":"russian_federation","optionlist":"Russian Federation"},{"optionvalue":"all_other_cities","optionlist":"All Other Cities"},{"optionvalue":"serbia","optionlist":"Serbia"},{"optionvalue":"slovak_republic","optionlist":"Slovak Republic"},{"optionvalue":"slovenia","optionlist":"Slovenia"},{"optionvalue":"spain","optionlist":"Spain"},{"optionvalue":"sweden","optionlist":"Sweden"},{"optionvalue":"switzerland","optionlist":"Switzerland"},{"optionvalue":"turkey","optionlist":"Turkey"},{"optionvalue":"ukraine","optionlist":"Ukraine"},{"optionvalue":"united_kingdom","optionlist":"United Kingdom"}],"me":[{"optionvalue":"belize","optionlist":"Belize"},{"optionvalue":"costa_rica","optionlist":"Costa Rica"},{"optionvalue":"el_salvador","optionlist":"El Salvador"},{"optionvalue":"guatemala","optionlist":"Guatemala"},{"optionvalue":"honduras","optionlist":"Honduras"},{"optionvalue":"mexico","optionlist":"Mexico"},{"optionvalue":"nicaragua","optionlist":"Nicaragua"},{"optionvalue":"panama","optionlist":"Panama"}],"mi":[{"optionvalue":"bahrain","optionlist":"Bahrain"},{"optionvalue":"israel","optionlist":"Israel"},{"optionvalue":"jordan","optionlist":"Jordan"},{"optionvalue":"kuwait","optionlist":"Kuwait"},{"optionvalue":"palestine","optionlist":"Palestine"},{"optionvalue":"qatar","optionlist":"Qatar"},{"optionvalue":"saudi_arabia","optionlist":"Saudi Arabia"},{"optionvalue":"united_arab_emirates","optionlist":"United Arab Emirates"}],"pa":[{"optionvalue":"australia","optionlist":"Australia"},{"optionvalue":"new_zealand","optionlist":"New Zealand"}],"so":[{"optionvalue":"argentina","optionlist":"Argentina"},{"optionvalue":"brazil","optionlist":"Brazil"},{"optionvalue":"chile","optionlist":"Chile"},{"optionvalue":"colombia","optionlist":"Colombia"},{"optionvalue":"ecuador","optionlist":"Ecuador"},{"optionvalue":"guyana","optionlist":"Guyana"},{"optionvalue":"peru","optionlist":"Peru"},{"optionvalue":"uruguay","optionlist":"Uruguay"},{"optionvalue":"venezuela","optionlist":"Venezuela"}]};function hideAllHelpWidgetfields(){var obj=allneedHelpContactInfo.allDivName;var length=obj.length;for(var i=0;i<length;i++)
{$('#'+obj[i].divname+'').hide();}}
function showNeedHelpContactInfromation(selectedValue){var optionListValue=needHelpcontactinformation[selectedValue];var divId=optionListValue[0].contactid;$("#contactnum").html("");$("#contactnum").load("/content/dam/delta-applications/util/NeedHelp.html #"+divId+"");}
function resetNeedHelpRadio(){var radioobj=document.getElementsByName('isSkyMilesMember');if(radioobj!=null){for(var i=0;i<radioobj.length;i++){radioobj[i].checked=false;}}}
function setNeedHelpListValue(selectOption,dropdownId){var selectedValue=selectOption.val();var options=["<option value='none'>Select</option>"];var dropdownListValue=needHelpdropdownList[selectedValue];if(dropdownListValue!=undefined){$('#'+dropdownId+'').html(options.join(''));for(var k=0;k<dropdownListValue.length;k++){$('#'+dropdownId+'').append("<option value='"+dropdownListValue[k].optionvalue+"'>"+dropdownListValue[k].optionlist+"</option>");}}}
function setSearchString(searchString){var searchStringSession={"searchString":searchString};jQuery.ajax({url:"/utils/searchSession_setSearchStringData",type:"POST",data:searchStringSession,dataType:"json",success:function(searchSuccess){}});}
var needHelpSearchResultObj={searchAsYouTypeRenderer:function(){$(this).data('autocomplete')._renderItem=function(ul,item){return $("<li></li>").data("item.autocomplete",item).append(item.label).appendTo(ul);};},searchAsYouTypeHandler:function(request,response){if(request.term.length==0){$("#findResults").html('');$("#responseTest").hide();$("#responseHR").hide();}
if((request.term.length>=3&&request.term.length<=20&&request.term.split(' ').length<=1)||(request.term.length>=3&&request.term.split(' ').length<=15&&request.term.split(' ').length>1)){response(searchResults.getGSAPredictions(request.term,"allresults","false",{callback:function(resultList){var strResult="";if(resultList!=null){for(var i=0;i<resultList.searchResults.length;i++){var searchTitle="";if(resultList.searchResults[i].searchTitle.length>40){searchTitle=resultList.searchResults[i].searchTitle.substring(0,37)+'...';if(searchTitle.indexOf('<b>')!=-1&&searchTitle.indexOf('</b>')==-1){searchTitle=searchTitle+'</b>';searchTitle=searchTitle.replace(/<b>/gi,'<b class="bold">');}}else{searchTitle=resultList.searchResults[i].searchTitle;}
strResult+='<a class="searchResultLink" href="'+resultList.searchResults[i].searchUrl+'" >'+searchTitle+'</a>';if(i==4){break;}else{strResult+="</br>";}}
if(strResult.length>0){strResult+='</br> <a class="searchLink" href="/dlsearch/index.jsp?searchText='+request.term+'&category=allresults" >See All Search Result</a>';$("#findResults").html(strResult);setSearchString(request.term);}else{var noResultStr="No matching results were found. Please try your search again or visit our <a href='/content/www/en_US/support.html'>help page</a>";$("#findResults").html(noResultStr);}
$("#responseTest").show();$("#responseHR").show();delta.navwidget.adjustWidgetHeight("need-help");}}}));}}};if(dwr==null)var dwr={};if(dwr.engine==null)dwr.engine={};if(DWREngine==null)var DWREngine=dwr.engine;if(searchResults==null)var searchResults={};searchResults._path='/dlsearch/dwr';searchResults.getDynamicClusters=function(p1,p2,callback){dwr.engine._execute(searchResults._path,'searchResults','getDynamicClusters',false,p1,p2,callback);}
searchResults.getGSASearchResults=function(p1,p2,p3,callback){dwr.engine._execute(searchResults._path,'searchResults','getGSASearchResults',false,p1,p2,p3,callback);}
searchResults.getGSAPredictions=function(p1,p2,p3,callback){dwr.engine._execute(searchResults._path,'searchResults','getGSAPredictions',false,p1,p2,p3,callback);}
var EscapeWidget=window.EscapeWidget||{};EscapeWidget=(function($){var escpOCd=CookieUtils.get("escpOCd");var escpOCdSearch=CookieUtils.get("escpOCdSearch");if(escpOCd!=null){$('#escape-mapit-from').attr("value",escpOCd);}
if(escpOCdSearch!=null){$('#escape-search-origin').attr("value",escpOCdSearch);}
var runCount=0;var currentElement=null;var currentErrorMessage="";var cityOrAirportHolderText="City or Airport";var departureDateHolderText="Depart Date";var postalCodeHolderText="U.S. Zip Code";var searchORSpecialityURL="";if($('#isProd').val()==='true'){searchORSpecialityURL='https://www.deltavacations.com/';}else{searchORSpecialityURL='https://qa.deltavacations.com/';}
var pub={},activeInputFieldId,airportsList={},regionsList={},departureDatesList={},countryLang={country:'',lang:''},loginInfo={},cruisesSubmitConfig={cruisesParams:{},querystr:{baseUrl:'http://www.skymilescruises.com/results.do?',pageUrl:function(){var url=cruisesSubmitConfig.querystr.baseUrl+$.param(cruisesSubmitConfig.cruisesParams,true);return url;}}},specialtySubmitConfig={tag:'',rfr:'',querystr:{baseUrl:searchORSpecialityURL,pageUrl:function(){var url=specialtySubmitConfig.querystr.baseUrl+'sitenav?tag='+specialtySubmitConfig.tag+'&rfr='+specialtySubmitConfig.rfr;return url;},loginUrl:function(){var url=specialtySubmitConfig.querystr.pageUrl()+'&'+$.param(loginInfo,true)
return url;}}},searchSubmitConfig={autofillErrors:[],searchParams:{},querystr:{baseUrl:specialtySubmitConfig.querystr.baseUrl,pageUrl:function(){var url=searchSubmitConfig.querystr.baseUrl+'sitenav?tag=BOOK_COBRAND&package=ah&extAppSource=DELTA&'+$.param(searchSubmitConfig.searchParams,true)+'&coBrand=TEST&fewestStops=true&rfr=DLHPSEARCH';return url;},loginUrl:function(){var url=searchSubmitConfig.querystr.pageUrl()+'&extAppSource=DELTA&'+$.param(loginInfo,true)
return url;}}},mapitSubmitConfig={autofillErrors:[]},dataConfig={interstitialUrl:'/escape/escape/tmpl/_interstitial.tmpl.jsp',popupUrl:'/escape/escape/tmpl/airportpicker.jsp',airportsJsonUrl:'/escape/escape/json/AirportData.txt',regionsJsonUrl:'/escape/escape/json/RegionData.txt',crusDateJsonUrl:'/escape/json/FetchDate.action',loginJsonUrl:'/escape/json/FetchLogin.action',errorfile:function(errorCode){var url='/escape/errors/escape/'+errorCode+'.html';if(window.location.hostname==='localhost'){url='http://dvl7.delta.com'+url;}
return url;},airportsJsonUrl:'/escape/json/FetchAirports.action',regionsJsonUrl:'/escape/json/FetchRegions.action',crusDateJsonUrl:'/escape/json/FetchDate.action',loginJsonUrl:'/escape/json/FetchLogin.action',interstitialUrl:'/escape/escape/tmpl/_interstitial.tmpl.jsp',popupUrl:'/escape/escape/tmpl/airportpicker.jsp'},uiDialogTitleCss={airportPicker:{'width':'100%','background':'#fff','height':'35px','margin':'-1px 0 30px','padding':'5px 15px','boxShadow':'0 1px 2px rgba(0,0,0, 0.5)','borderRadius':'2px 2px 0 0'},interstitial:{'background':'#fff','boxShadow':'0 1px 2px rgba(0,0,0, 0.5)','borderRadius':'2px 2px 0 0','height':'auto','width':'95%'}};pub.predictiveTextDefinition={includeCityLevelCodes:false,isUSOnly:true};pub.init=function(){$('#escape-tabs').removeClass('ui-widget');$('#escape-tabs #ui-tabs-mapit').removeClass('ui-tabs-panel');$('#escape-tabs #ui-tabs-search').removeClass('ui-tabs-panel');$('#escape-tabs #ui-tabs-specialty').removeClass('ui-tabs-panel');$('#escape-tabs #ui-tabs-cruises').removeClass('ui-tabs-panel');determineWidgetCountry();handleInputPlaceholder()
if(EscapeWidget.getRunCount()===0){setTimeout('$(\'#escape-maincontent select\').focus().blur();',2);}};function createAirportBubble(){try{var mapLookup=new AirportLookup({targetInp:'#escape-mapit-from',displayTitle:cityOrAirportHolderText,serverUrl:window.location.host});mapLookup.attachEventHandlers();var searchOrigin=new AirportLookup({targetInp:'#escape-search-origin',displayTitle:cityOrAirportHolderText,serverUrl:window.location.host});searchOrigin.attachEventHandlers();var searchDestination=new AirportLookup({targetInp:'#escape-search-destination',displayTitle:cityOrAirportHolderText,serverUrl:window.location.host});searchDestination.attachEventHandlers();}catch(e1){}}
function handleInputPlaceholder(){if($.browser.msie){var mapFromInputField=$("#escape-mapit-from");var searchFromInputField=$('#escape-search-origin');var searchToInputField=$('#escape-search-destination');var departureDateInputField=$('#escape-search-date');var postalCodeInputField=$('#escape-cruises-zip');$(document).on('click','#close_image',function(){$('#escape-widget-popup').remove();});mapFromInputField.click(function(){if(mapFromInputField.val()==cityOrAirportHolderText){mapFromInputField.val("");}});searchFromInputField.click(function(){if(searchFromInputField.val()==cityOrAirportHolderText){searchFromInputField.val("");}});searchToInputField.val(cityOrAirportHolderText);searchToInputField.click(function(){if(searchToInputField.val()==cityOrAirportHolderText){searchToInputField.val("");}});departureDateInputField.val(departureDateHolderText);departureDateInputField.click(function(){if(departureDateInputField.val()==departureDateHolderText){departureDateInputField.val("");}});postalCodeInputField.val(postalCodeHolderText);postalCodeInputField.click(function(){if(postalCodeInputField.val()==postalCodeHolderText){postalCodeInputField.val("");}});}}
var loadJsonData={airports:function(){$.ajax({dataType:'json',error:function(){loadJsonData.showError('ESC0001','#escape-errormessage-mapit');loadJsonData.showError('ESC0001','#escape-errormessage-search');},success:function(data){airportsList=data;if(data.fault&&data.fault.error.errorCode){loadJsonData.showError(data.fault.error.errorCode,'#escape-errormessage-mapit');loadJsonData.showError(data.fault.error.errorCode,'#escape-errormessage-search');}else{populateLists.init('autocomplete');}
loadJsonData.setDefaultAirport();DeltaUtils.initButtons();},type:'GET',url:dataConfig.airportsJsonUrl});},cruises:function(){$.ajax({dataType:'json',error:function(){loadJsonData.showError('ESC0001','#escape-errormessage-cruises');},success:function(data){departureDatesList=data
if(data.fault&&data.fault.error.errorCode){loadJsonData.showError(data.fault.errorCode,'#escape-errormessage-cruises');}else{populateLists.init('cruises');}},type:'GET',url:dataConfig.crusDateJsonUrl});},showError:function(errorCode,location){var x=dataConfig.errorfile(errorCode),$elm=$(location);if(x!==null&&errorCode!==null){$.ajax({dataType:'html',error:function(){$elm.html('<p>System Error <br /><b>'+dataConfig.errorfile(errorCode)+'</b> does not exist.</p>');},success:function(html){currentElement=location;currentErrorMessage=html;setTimeout("EscapeWidget.displayErrorMessage()",20);},type:'GET',url:dataConfig.errorfile(errorCode)});}else{}},login:function(){$.getJSON(dataConfig.loginJsonUrl,function(data){loginInfo=data;loadJsonData.setDefaultAirport();});},regions:function(){$.ajax({dataType:'json',error:function(){$('input[type="submit"]#escape-mapit-submit').attr('disabled','disabled');$('input[type="submit"]#escape-search-submit').attr('disabled','disabled');$("#escape-errormessage-search").text("We are experiencing an unknown issue at this time. Please refresh this page or try again later. We apologize for the inconvenience.").removeClass("hidden");loadJsonData.showError('ESC0001','#escape-errormessage-mapit');},success:function(data){regionsList=data
if(data.fault&&data.fault.error.errorCode){loadJsonData.showError(data.fault.error.errorCode,'#escape-errormessage-mapit');}else{populateLists.init('regions');}},type:'GET',url:dataConfig.regionsJsonUrl});},setDefaultAirport:function(){if(loginInfo.homeAirportPref&&airportsList.originationAirports){$.each(airportsList.originationAirports,function(key,val){if(loginInfo.homeAirportPref===val.code){$('#escape-mapit-from, #escape-search-origin').val(val.code);}});}}};var populateLists={airports:function(data,$textfield){var $elm=$('#escape-widget-popup #country_ul');populateLists.updateList($elm,data,'mapitOrigin',true);},cruisesDates:function(){$elm=$("#escape-cruises-deptmonth");$.each(departureDatesList.dateList,function(key,val){$elm.append('<option value="'+val.date+'">'+val.displayDate+'</option>');});},regions:function(){populateLists.updateList('#escape-mapit-to',regionsList.regions,'mapitDestition');},setAutoComplete:function(elmId,data){var availableTags=[];$.each(data,function(key,val){availableTags.push(val.name)});$.ui.autocomplete.prototype._renderItem=function(ul,item){var term=this.term.split(' ').join('|'),re=new RegExp("("+term+")","gi"),t=item.label.replace(re,"<span class='matchedAutofill'>$1</span>");var noAirportCode=this.element;if(noAirportCode.attr("noairportcode")=="true"){item.value=item.label;}else{if(item.label.indexOf("(")=="-1"){item.label+="()";}
item.value=item.label.split("(")[1].split(")")[0];}
return $("<li></li>").data("item.autocomplete",item).append("<a>"+t+"</a>").appendTo(ul);};$(elmId).autocomplete({source:availableTags,selectFirst:true,change:function(event,ui){var $elm=$(this);if($elm.val().length!=0){escapeValidation.autocomplete($elm,availableTags);$(".airporterror:visible").addClass("error");}
else if($elm.is(":visible")&&$elm.hasClass("airporterror")){if($elm.attr("id")=="escape-mapit-from"){if($('#escape-mapit-submit').data("clicked")==true){return false;}}
$elm.removeClass("airporterror error");if($(".airporterror:visible").size()==0){$("#escape-errormessage-search").text("");}}},appendTo:"#escape-widget"});},updateList:function($elm,data,id,autofill){$('.escape-multiselect').width('100%');$('.ui-dialog-titlebar').css(uiDialogTitleCss.airportPicker);if($.type($elm)!=='object'){$elm=$($elm);}
if(!autofill){autofill=false;}
$elm.empty();$.each(data,function(key,val){if(autofill===true){$elm.append('<li id="'+id+'-'+val.code+'">'+val.name+'</li>');}else{$elm.append('<option id="'+id+'-'+val.code+'" value="'+val.code+'">'+val.name+'</option>');}});$('#escape-widget-popup #scroll_country').tinyscrollbar({sizethumb:17});},init:function(list){if(list==='regions'){this.regions();}else if(list==='autocomplete'){this.setAutoComplete('#escape-mapit-from',airportsList.originationAirports);this.setAutoComplete('#escape-search-origin',airportsList.originationAirports);this.setAutoComplete('#escape-search-destination',airportsList.destinationAirports);}else if(list==='cruises'){this.cruisesDates();}else{}}};function setActiveInputId(elmId){if(activeInputFieldId){checkInnerlabel($('body').find(activeInputFieldId));}
activeInputFieldId=elmId;}
function extractAirportCode(fieldId){var originalCodeStr=$(fieldId).val(),startOriginCode=originalCodeStr.indexOf('('),originCode=originalCodeStr.substr(startOriginCode+1,3)
return originCode;}
var submitPage={cruises:function(){var a={"places":$("#escape-cruises-dest").val(),"Month":$("#escape-cruises-deptmonth").val(),"c":$("#escape-cruises-cruiseline").val(),"days":$("#escape-cruises-days").val(),"shoppingZipCode":$("#escape-cruises-zip").val(),"IncludeSeniorRates":$("#escape-cruise-age").is(':checked')},b;cruisesSubmitConfig.cruisesParams=a;b=cruisesSubmitConfig.querystr.pageUrl();window.open(b,'_blank');},mapit:function(){var product={'originregion':$('#escape-mapit-to').val(),'origincode':$('#escape-mapit-from').val()};CookieUtils.create("escpOCd",$('#escape-mapit-from').val(),10);$('#escape-mapit-to').val(product.originregion);$('#escape-mapit-from').val(product.origincode);},searchVacations:function(){function getDepartDate(){var val=$("#escape-search-date").val(),yyyy=val.substr(6),first=val.substr(0,6),last=((yyyy.length==2)?'20'+yyyy:yyyy),full=first+last;CookieUtils.create("escpOCdSearch",$('#escape-search-origin').val(),10);return full;}
Date.prototype.customFormat=function(){var YY,MM,M,DD,D;var dateObject=this;YY=((dateObject.getFullYear())+"").slice(-2);MM=(M=dateObject.getMonth()+1)<10?('0'+M):M;DD=(D=dateObject.getDate())<10?('0'+D):D;return MM+'/'+DD+'/'+YY;}
function getReturnDate(){var depart=parseInt(Date.parse(getDepartDate()));var nights=parseInt($("#escape-search-length").val())*24*60*60*1000;var returnDate=new Date(depart+nights).customFormat();return returnDate;}
var a={"airDisplayIndicator":$("input:radio[name='airDisplayIndicator']:checked").val(),"adultCount":$("#escape-search-adults").val(),"childCount":$("#escape-search-children").val(),"origin":extractAirportCode('#escape-search-origin'),"destination":extractAirportCode('#escape-search-destination'),"departureDate":$("#escape-search-date").val(),"departureTime":$("#escape-search-time").val(),"returnDate":getReturnDate()};if(pub.childrenInterstitial.wait===true){$('#escape-interstitial .escape-child').each(function(index){a["child["+index+"].age"]=$(this).val();});};searchSubmitConfig.searchParams=a;if(loginInfo.loggedIn===true){var b=searchSubmitConfig.querystr.loginUrl();window.open(b,'_blank');}else{var b=searchSubmitConfig.querystr.pageUrl();window.open(b,'_blank');}
return{"getDepartDate":getDepartDate};},speciality:function(targetId){switch(targetId){case('escape-luxury'):specialtySubmitConfig.tag='LUXURY_INDEX';specialtySubmitConfig.rfr='DLHPSPECLUX';break;case('escape-honeymoons'):specialtySubmitConfig.tag='ROMANCE_HONEYMOON';specialtySubmitConfig.rfr='DLHPSPECHNYMN';break;case('escape-weddings'):specialtySubmitConfig.tag='ROMANCE_WEDDING';specialtySubmitConfig.rfr='DLHPSPECDESTWEDD';break;case('escape-grouptravel'):specialtySubmitConfig.tag='GROUP_TRAVEL_INDEX';specialtySubmitConfig.rfr='DLHPSPECGRP';break;case('escape-resort'):specialtySubmitConfig.tag='DISNEY_INDEX';specialtySubmitConfig.rfr='DLHPSPECDISNEY';break;case('escape-skivacations'):specialtySubmitConfig.tag='SKI';specialtySubmitConfig.rfr='DLHPSPECSKI';break;case('escape-specialty-submit'):specialtySubmitConfig.tag='THEME_INDEX';specialtySubmitConfig.rfr='DLHPSPECALL';if(loginInfo.loggedIn===true){window.open(''+specialtySubmitConfig.querystr.loginUrl());}else{window.open(''+specialtySubmitConfig.querystr.pageUrl());}
break;default:specialtySubmitConfig.tag='THEME_INDEX';specialtySubmitConfig.rfr='DLHPSPECALL';}
if(loginInfo.loggedIn===true){$('#'+targetId)[0].href=specialtySubmitConfig.querystr.loginUrl();}else{$('#'+targetId)[0].href=specialtySubmitConfig.querystr.pageUrl();}}};function popitup(url){newwindow=window.open(url);if(window.focus){newwindow.focus()}
return false;}
function enableEventListeners(){$('#escape-mapit-airportpicker').click(function(){setActiveInputId('#escape-mapit-from');airportsPopup.displayPopup({elementId:'#escape-widget-popup',data:airportsList.originationAirports,$textfield:$(this).prev('input'),callback:populateLists.airports});return false;});$('#escape-search-originpicker').click(function(){setActiveInputId('#escape-search-origin');airportsPopup.displayPopup({elementId:'#escape-widget-popup',data:airportsList.originationAirports,$textfield:$(this).prev('input'),callback:populateLists.airports});return false;});$('#escape-search-destinationpicker').click(function(){setActiveInputId('#escape-search-destination');airportsPopup.displayPopup({elementId:'#escape-widget-popup',data:airportsList.destinationAirports,$textfield:$(this).prev('input'),callback:populateLists.airports});return false;});$('input[type=text]').focus(function(){$(this).prev('.escape-innerlabel').css('visibility','hidden')}).on("change blur",function(){checkInnerlabel($(this))});$('#escape-search-submit').click(function(e){escapeValidation.searchTab();});$('.escape-specialty-icon, #escape-specialty-submit').click(function(){var targetId=$(this).attr('id');loadJsonData.login();submitPage.speciality(targetId);});$('#escape-cruises-submit').click(function(){escapeValidation.cruisesTab();});$('#escape-mapit-submit').click(function(event){event.preventDefault();$(this).data("clicked",true);submitPage.mapit();escapeValidation.mapit();var submitError=false;if($("#escape-errormessage-mapit").html()!=""||$.trim($("#escape-mapit-from").val())==""||$("#escape-mapit-from").val()=="City or Airport"){$("#escape-errormessage-mapit").text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");$("#escape-mapit-from").addClass("error");delta.navwidget.adjustWidgetHeight("escape");submitError=true;}
if(!submitError&&$('#escape-mapit-from').val().length>3){$('#escape-mapit-from').val(extractAirportCode('#escape-mapit-from'));$("form#escape-mapit").submit();}});}
$('#escape-mapit-from').live('keydown',function(e){var elmLength=$("#escape-mapit-from").val().length;if(elmLength>0){if($(".airporterror:visible").size()==1){$('.escape-errormessage:visible').addClass("hidden");delta.navwidget.adjustWidgetHeight("escape");}
$(this).removeClass("error");}
if(e.keyCode==13){$('#escape-mapit-submit').data("clicked",false);}});$('#escape-search-origin').live('keypress',function(e){var elmLength=$(this).val().length;if(elmLength<=4){if($(".airporterror:visible").size()==1){$('.escape-errormessage:visible').addClass("hidden");delta.navwidget.adjustWidgetHeight("escape");}
$(this).removeClass("error");}});$('#escape-search-destination').live('keypress',function(e){var elmLength=$(this).val().length;if(elmLength<=4){if($(".airporterror:visible").size()==1){$('.escape-errormessage:visible').addClass("hidden");delta.navwidget.adjustWidgetHeight("escape");}
$(this).removeClass("error");}});var spinners={setDefaultSpinners:function(){$('#escape-search-adults').spinit({min:1,max:5,stepInc:1,width:15,height:24,initValue:2});$('#escape-search-children').spinit({min:0,max:4,stepInc:1,width:15,height:24});$('#escape-search-length').spinit({min:1,max:28,stepInc:1,initValue:4,width:15,height:24});},setInterstitialSpinner:function(){$('.childSpinners').spinit({min:1,max:17,stepInc:1,width:15,height:24});}};function enableDatePicker(){delta.calendar.globalConfiguration();delta.calendar.create({calendarElement:$('.escapeWidgetDateFieldWrap'),daysInFutureToShow:331,daysInPastToShow:0,startDateTitle:'Depart Date',showDropDown:true});}
var initWidget={defaultWidget:function(){this.showHide('#escape-widget-default');changeActiveTab();loadJsonData.airports();loadJsonData.cruises();loadJsonData.login();loadJsonData.regions();enableEventListeners();enableDatePicker();$('#escape-widget #depDateCalIcon, #escape-widget .calendarClickIcon').on('click',function(){$('#escape-search-date').trigger("focus");});spinners.setDefaultSpinners();checkInnerlabel($('#escape-mapit-from'));checkInnerlabel($('#escape-search-origin'));$('#escape-cruises-dest').val('ALL');var cruisesHtml="<b>YOU MAY QUALIFY FOR SPECIAL RESIDENT OR SENIOR RATES!</b><br/><br/>Why We Ask For A Zip Code:<br/>For many cruises, we can obtain special rates for residents of particular states.Providing your 5-digit zip code allows us to apply these additional savings to your cruise price.<br /><br />Special rates are indicated by the \"Special Rate\"<br /><br />Any traveler who qualifies for a special resident rate will be required to show a government-issued form of identification  (passport, or birth certificate and driver's license) at the pier to validate state of residency prior to boarding the cruise ship. If you do not have a U.S. zip code, please call a cruise specialist at 800-820-3244 24 hours a day, 7 days a week.<br /><br />Why We Ask \"Over 55\"<br />For many cruises, we can obtain special rates for passengers 55 years of age or older*. If any traveler in your stateroom is 55 years of age or older by the date the cruise departs, these special rates and additional savings may apply for all travelers in your party.<br /><br />Special rates are indicated by the \"Special Rate\"<br /><br />Any traveler who qualifies for this special rate will be required to show a governmentissued form of identification (passport, or birth certificate and driver's license) at the pier to validate his/her age prior to boarding the cruise ship.<br /><br />* Costa Cruise Lines senior age is 60 years or older; all others are 55 or older."
DeltaUtils.showToolTip('escape-seniordiscounttip',cruisesHtml,-13,13,'',250,'','');var childrenTipHtml="<b>Booking Age Restrictions</b><br/><br/>Children under the age of two traveling within the U.S. with a parent or an adult 18 years of age and older can travel on the adult's lap as a \'lap child\', and can be added to your reservation by contacting us at 1-800-800-1504 once you complete your booking online. If there are two or more children under the age of two traveling with the same adult, only one of the children may travel as a lap child. Any additional children are required to have a seat purchased for them. <br/><br/>All children under the age of two traveling internationally are required to have a ticket purchased for them at a percentage of the adult base fare, plus applicable taxes and fees. Regardless of your destination, you should indicate you are traveling with an infant when making your reservation.";DeltaUtils.showToolTip('escape-search-childrentip',childrenTipHtml,-13,13,'',250,'','');},japaneseWidget:function(){this.showHide('#escape-widget-japan');DeltaUtils.initButtons();$('#escape-jpncta').click(function(){window.location='http://www.DeltaVacations.jp';delta.navwidget.adjustWidgetHeight("escape");return false;});},internationalWidget:function(){this.showHide('#escape-widget-international');$('#escape-intcta').click(function(){initWidget.defaultWidget();delta.navwidget.adjustWidgetHeight("escape");return false;})},showHide:function(widget){$('.escape-regionalwidget').hide();if($(widget).hasClass('hidden')){$(widget).removeClass('hidden');}
$(widget).show();}};function determineWidgetCountry(){countryLang.country=CookieUtils.get('MP_COUNTRY');countryLang.lang=CookieUtils.get('MP_LANG');if((countryLang.country==="us"||countryLang.country==="US"||countryLang.country==="ca"||countryLang.country==="CA"||typeof(countryLang.country)=='undefined')&&(countryLang.lang.toLowerCase()==="en"||typeof(countryLang.lang)=='undefined')){initWidget.defaultWidget();}else if(countryLang.lang=="ja"||countryLang.lang=="JA"){initWidget.japaneseWidget();}else{initWidget.internationalWidget();}}
var airportsPopup={calculatePosition:function(){var $field=$(activeInputFieldId);var widgetOffset=$('#escape-widget').offset();var popupOffset=0;var inputOffset=$field.offset();var inputPosition=$field.position();var inputWidth=$field.width();var originInputOffset=$('#escape-search-origin').position();var totaltop=$('#widget-escape').offset().top+$('#widget-escape .widgetCloseHeader').height()+$('#widget-escape ul').height()+$('#escape-search-origin').position().top+$field.height()+$field.height()+5;if($(".widget-container-docked").length>0){widgetOffset=$field.closest("div.widget-container-docked").offset();$('#escape-widget-popup #airportlookup_dropdown').offset({left:widgetOffset.left-popupOffset,}).css({'position':'fixed','top':'auto','bottom':'-50px'});}else{$('#escape-widget-popup #airportlookup_dropdown').offset({left:widgetOffset.left-popupOffset,top:inputOffset.top+$field.height()+1});}
$('#escape-widget-popup .from_arrow_container').css('paddingLeft',inputWidth/2+inputPosition.left+popupOffset);},closePopup:function(){$('#escape-widget-popup #close_image').click(function(){removePopup();});$('#escape-widget-popup #country_ul li').click(function(){if($(activeInputFieldId).attr("noairportcode")!="true"){var code=$(this).text().split("(")[1].split(")")[0];$(activeInputFieldId).val(code);}else{$(activeInputFieldId).val($(this).text());}
removePopup();});function removePopup(){$('#escape-widget-popup').remove();$(activeInputFieldId).css({borderColor:'#CCCCCC',outline:'inherit'});}},displayPopup:function(params){var $target=$('body').find(params.elementId);if($target.length<=0){$('body').append('<div id="escape-widget-popup" />');$target=$('body').find(params.elementId);}
$target.empty().load(dataConfig.popupUrl,function(){params.callback(params.data,params.$textfield);airportsPopup.calculatePosition();$(activeInputFieldId).css({borderColor:'#0253A4',outline:'medium none'});airportsPopup.closePopup();});}};pub.childrenInterstitial={wait:false,init:function(params){var count=0,numberOfChild=$('#escape-search-children').val();if(numberOfChild>=1&&numberOfChild!==count){pub.childrenInterstitial.wait=true;pub.childrenInterstitial.display(params,numberOfChild);}else{pub.childrenInterstitial.wait=false;}},display:function(params,numberOfChild){var interstitialSettings={autoOpen:true,resizable:false,draggable:false,modal:false,width:600,dialogClass:'escape-interstitial',title:'ENTER THE AGES OF YOUR CHILDREN'};var $target=$('body').find(params.elementId);if($target.length<=0){$('body').append('<div id="escape-interstitial" />');$target=$('body').find(params.elementId);}
var children={childrenResponses:[],multipleChildren:false};for(var i=1;i<=numberOfChild;i++){children.childrenResponses.push({'isChild':'Y'});}
if(children.childrenResponses.length>1){children.multipleChildren=true;}
$target.empty().dialog(interstitialSettings).load(dataConfig.interstitialUrl,function(){$('.escape-popup .ui-dialog-titlebar').width('100%');$target.html($('body').find('#_interstitial').render(children));DeltaUtils.initButtons();pub.childrenInterstitial.submitListener();});$('.ui-dialog-titlebar').css(uiDialogTitleCss.interstitial);airportsPopup.closePopup();},submitListener:function(){$('.escape-child').change(function(){if($('#escape-child1').val()!="Select"&&$('#escape-child2').val()!="Select"&&$('#escape-child3').val()!="Select"&&$('#escape-child4').val()!="Select")
{$(".ui-button").removeClass("ui-state-disabled");$(".ui-button").removeAttr("disabled");}
else if($('#escape-child1').val()=="Select"||$('#escape-child2').val()=="Select"||$('#escape-child3').val()=="Select"||$('#escape-child4').val()=="Select")
{$('#escape-interstitial-submit').addClass("ui-state-disabled");$("#escape-interstitial-submit").attr('disabled','disabled');}});$('#escape-interstitial-submit').click(function(){submitPage.searchVacations();return false;});$('#escape-interstitial-cancel').click(function(){$('#escape-interstitial').dialog('close');return false;});}};var escapeValidation={autocomplete:function($elm,availableTags){var $form=$elm.parents('form'),usrStr=$elm.val().toString(),result;function _pickCity(){var noAirportCode=$elm.attr("noairportcode");var b=usrStr.toLowerCase();if(usrStr.length>=3){for(var i=0;i<availableTags.length;i++){var a=availableTags[i].toLowerCase();try{var cityCode=availableTags[i].split("(")[1].split(")")[0],cityName=$.trim(availableTags[i].split(",")[0]);}catch(e){continue;}
if(noAirportCode!="true"&&(cityName.toLowerCase()==b||cityCode.toLowerCase()==b||a==b)){result=availableTags[i];$elm.val(cityCode).removeClass('airporterror');break;}else if(noAirportCode=="true"&&(cityName.toLowerCase()==b||cityCode.toLowerCase()==b||a==b)){result=availableTags[i];$elm.val(result).removeClass('airporterror');break;}}}
if(!result){$elm.addClass('airporterror');_showErrorMessage();}}
function _showErrorMessage(){$form.children('.escape-errormessage').text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");}
function _hideErrorMessage(){$form.children('.escape-errormessage').text("").addClass("hidden");}
_pickCity();if($form.find('.airporterror').length<=0){_hideErrorMessage();}
delta.navwidget.adjustWidgetHeight("escape");return result;},mapit:function($elm){if(mapitSubmitConfig.goodToGo===false){escapeValidation.autofill("escape-mapit");}
var airport_origination=[];$.each(airportsList.originationAirports,function(key,val){airport_origination.push(val.name);});escapeValidation.autocomplete($("#escape-mapit-from"),airport_origination);},searchTab:function(){jQuery.validator.addMethod("math",function(value,element,params){var first=value.substr(0,6),yyyy=value.substr(6),last=((yyyy.length==2)?'20'+yyyy:yyyy),full=first+last,minStartDate=new Date();minStartDate.setDate(minStartDate.getDate());minStartDate.setHours(0);minStartDate.setMinutes(0);minStartDate.setSeconds(0);minStartDate.setMilliseconds(0);full=new Date(Date.parse(full));var dateDiff=(full-minStartDate)/(1000*60*60*24);if(minStartDate>full||minStartDate=="Depart date"||dateDiff>=335){$('#escape-errormessage-search.escape-errormessage').text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");return 0;}
else{$('#escape-errormessage-search.escape-errormessage').text("").addClass("hidden");}
return this.optional(element)||minStartDate<=full;},"This date cannot be booked because it is in the past. Please try another date.");jQuery.validator.addMethod("requiredCityRAirport",function(value,element,params){var val=$.trim(value);if(val==""||val=="City or Airport"){$('#escape-errormessage-search.escape-errormessage').text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");$("#escape-search-origin").focus();}
else{$('#escape-errormessage-search.escape-errormessage').text("").addClass("hidden");}
return!(val==""||val=="City or Airport");},"");$('#escape-search').validate({submitHandler:function(){pub.childrenInterstitial.init({elementId:'#escape-interstitial'});var airport_origination=[];var airport_destination=[];$.each(airportsList.destinationAirports,function(key,val){airport_destination.push(val.name);});$.each(airportsList.originationAirports,function(key,val){airport_origination.push(val.name);});escapeValidation.autocomplete($("#escape-search-origin"),airport_origination);escapeValidation.autocomplete($("#escape-search-destination"),airport_destination);if(pub.childrenInterstitial.wait===false&&$('#escape-search').find('.airporterror').length<=0){submitPage.searchVacations();}
delta.navwidget.adjustWidgetHeight("escape");},invalidHandler:function(){delta.navwidget.adjustWidgetHeight("escape");},rules:{"escape-search-adults":"required","escape-search-date":{required:true,math:true},"escape-search-destination":{requiredCityRAirport:true},"escape-search-origin":{requiredCityRAirport:true},"escape-search-length":"required"},errorPlacement:function(error,element){error.insertBefore(element.parents('.escape-imginput'));delta.navwidget.adjustWidgetHeight("escape");}});delta.navwidget.adjustWidgetHeight("escape");},cruisesTab:function(){jQuery.validator.messages.postalcode="Please enter a 5-digit U.S. zip code";jQuery.validator.classRuleSettings.postalcode={postalcode:true};jQuery.validator.addMethod("postalcode",function(value,element,param){if(value==""||value.match(/^\d{5}(-\d{4})?$/)||value==$("#escape-cruises-zip").attr("placeholder")){return true;}else{return false;}},jQuery.validator.messages.postalcode);$('#escape-cruises').validate({submitHandler:function(){submitPage.cruises();},showErrors:function(error,element){this.defaultShowErrors();delta.navwidget.adjustWidgetHeight("escape");},rules:{"escape-cruises-zip":{postalcode:true}}});}};function checkInnerlabel($inputField,popup){if(!popup){popup=false}}
function changeActiveTab(){var hasTabshow=false;function adjustWidget(){var $activeTab=$('.escape-activetab'),appendClass=$('#escape-tabs').find('.ui-state-active').attr('class').split(' ')[0].split('-')[2],removeClass=$activeTab.attr('class').split(' ')[1];$activeTab.removeClass(removeClass).addClass(appendClass);$('#escape-widget-popup').remove();$('#container1_inner').remove();delta.navwidget.adjustWidgetHeight("escape");$('#escape-widget-popup').remove();$('#container1_inner').remove();}
$('#escape-widget').on('tabsshow','#escape-tabs',function(){hasTabshow=true;adjustWidget();});$("#nav-widget section").on("click",function(){$('#escape-interstitial').dialog('close');$('#escape-widget-popup #close_image').trigger('click');});if(hasTabshow===false){$('#escape-tabs li a').click(function(){if($('#aToolTip').is(':visible')){if($(this).parent().hasClass("ui-tab-cruises ui-state-default ui-corner-top ui-tabs-selected ui-state-active")){return false;}
$('#aToolTipCloseBtn').trigger('click');}
if(!$(this).parent().hasClass("ui-tab-search")){$('#escape-interstitial').dialog('close');}
adjustWidget();});}}
pub.getRunCount=function(){return runCount;}
pub.setRunCount=function(value){runCount=value;}
pub.displayErrorMessage=function(message){if(DeltaUtils.exists(currentElement)&&DeltaUtils.exists(currentErrorMessage)){$(currentElement).html(currentErrorMessage).removeClass('hidden');delta.navwidget.adjustWidgetHeight("escape");$('input[type="submit"]#escape-mapit-submit').attr('disabled','disabled');$('input[type="submit"]#escape-search-submit').attr('disabled','disabled');$("#escape-errormessage-search").text("We are experiencing an unknown issue at this time. Please refresh this page or try again later. We apologize for the inconvenience.").removeClass("hidden");}}
return pub;})(jQuery);$(function(){var events="event69";var originCode="";var destinationCode="";function extractAirportCode(fieldId){var originalCodeStr=$(fieldId).val(),startAirCode=originalCodeStr.indexOf('('),airCode=originalCodeStr.substr(startAirCode+1,3);return airCode;}
$("#escape-widget").delegate("#ui-tabs li","click",function(){var tab="";tab="home:"+$(this).find("a").text().toLowerCase();s.linkTrackVars="prop1, prop2";s.prop1=tab;s.prop2="home";s.tl(this,"o",tab);s.prop1=s.prop2="";});$("#escape-widget").delegate("#escape-mapit-submit","click",function(){originCode=extractAirportCode("#escape-mapit-from").toLowerCase();destinationCode=$("#escape-mapit-to option:selected").text().toLowerCase();s.linkTrackVars="events,eVar58,eVar59";s.linkTrackEvents=events;s.events=events;s.eVar58="map_it:"+originCode;s.eVar59="map_it:"+destinationCode;s.tl(this,"o","map it escape search");s.eVar58=s.eVar59=s.events="";});$("#escape-widget").delegate("#escape-search-submit","click",function(){if(EscapeWidget.childrenInterstitial.wait){$('#escape-interstitial-submit').click(function(){setTags();});}else if($('#escape-search').find('.airporterror.error').length<=0){setTags();};function setTags(){var priceVsDeparture="";originCode=extractAirportCode("#escape-search-origin").toLowerCase();destinationCode=extractAirportCode("#escape-search-destination").toLowerCase();var airDisplayIndicator=$("input:radio[name='airDisplayIndicator']:checked").val().toLowerCase();if(airDisplayIndicator==='p')
priceVsDeparture="best price";else if(airDisplayIndicator==='s')
priceVsDeparture="departure time";s.linkTrackVars="events,eVar58,eVar59,eVar60";s.linkTrackEvents=events;s.events=events;s.eVar58="search:"+originCode;s.eVar59="search:"+destinationCode;s.eVar60=priceVsDeparture;s.tl(this,"o","vacation escape search");s.eVar58=s.eVar59=s.eVar60=s.events="";}});$("#escape-widget").delegate(".escape-specialty-icon, #escape-specialty-submit","click",function(){var specialtyPackage="";if($(this).attr("id")==="escape-specialty-submit"){specialtyPackage="all specialty vacations"}else{specialtyPackage=$(this).attr("id").split("-")[1];}
s.linkTrackVars="events,eVar59";s.linkTrackEvents=events;s.events=events;s.eVar59="specialty:"+specialtyPackage;s.tl(this,"o","specialty escape search");s.eVar59=s.events="";});$("#escape-widget").delegate("#escape-cruises-submit","click",function(){var searchOptions="";var cruiseType="";var lengthOfCruise=$("#escape-cruises-days").children("option:selected").text().toLowerCase();var month=$("#escape-cruises-deptmonth").children("option:selected").text().toLowerCase().replace(" ","-");var cruiseLine=$("#escape-cruises-cruiseline option:selected").text().toLowerCase();var over55=($("#escape-cruise-age").is(':checked'))?"y":"n";cruiseType=$("#escape-cruises-dest option:selected").text().toLowerCase();searchOptions=cruiseType+":"+lengthOfCruise+":"+month+":"+cruiseLine+":"+over55;s.linkTrackVars="events,eVar61,prop42";s.linkTrackEvents=events;s.events=events;s.eVar61=cruiseType;s.prop42=searchOptions;s.tl(this,"o","cruise search");s.eVar58=s.eVar59=s.eVar60=s.events="";});});
(function($){$.fn.extend({spinit:function(options){var settings=$.extend({min:0,max:100,initValue:0,callback:null,stepInc:1,pageInc:10,width:50,height:15,btnWidth:10,mask:''},options);return this.each(function(){var UP=38;var DOWN=40;var PAGEUP=33;var PAGEDOWN=34;var mouseCaptured=false;var mouseIn=false;var interval;var direction='none';var isPgeInc=false;var value=Math.max(settings.initValue,settings.min);var el=$(this).val(value).css('width',(settings.width)+'px').css('height',settings.height+'px').addClass('smartspinner');raiseCallback(value);if(settings.mask!='')el.val(settings.mask);$.fn.reset=function(val){if(isNaN(val))val=0;value=Math.max(val,settings.min);$(this).val(value);raiseCallback(value);};function setDirection(dir){direction=dir;isPgeInc=false;switch(dir){case'up':setClass('up');break;case'down':setClass('down');break;case'pup':isPgeInc=true;setClass('up');break;case'pdown':isPgeInc=true;setClass('down');break;case'none':setClass('');break;}}
el.focusin(function(){el.val(value);});el.click(function(e){mouseCaptured=true;isPgeInc=false;clearInterval(interval);onValueChange();});el.mouseenter(function(e){el.val(value);});el.mousemove(function(e){if(e.pageX>(el.offset().left+settings.width)-settings.btnWidth-4){if(e.pageY<el.offset().top+settings.height/2)
setDirection('up');else
setDirection('down');}
else
setDirection('none');});el.mousedown(function(e){isPgeInc=false;clearInterval(interval);interval=setInterval(onValueChange,200);});el.mouseup(function(e){mouseCaptured=false;isPgeInc=false;clearInterval(interval);});el.mouseleave(function(e){setDirection('none');if(settings.mask!='')el.val(settings.mask);});el.keydown(function(e){switch(e.which){case UP:setDirection('up');onValueChange();break;case DOWN:setDirection('down');onValueChange();break;case PAGEUP:setDirection('pup');onValueChange();break;case PAGEDOWN:setDirection('pdown');onValueChange();break;default:setDirection('none');break;}});el.keyup(function(e){setDirection('none');});el.keypress(function(e){if(el.val()==settings.mask)el.val(value);var sText=getSelectedText();if(sText!=''){sText=el.val().replace(sText,'');el.val(sText);}
if(e.which>=48&&e.which<=57){var temp=parseFloat(el.val()+(e.which-48));if(temp>=settings.min&&temp<=settings.max){value=temp;raiseCallback(value);}
else{e.preventDefault();}}});el.blur(function(){if(settings.mask==''){if(el.val()=='')
el.val(settings.min);}
else{el.val(settings.mask);}});el.bind("mousewheel",function(e){if(e.wheelDelta>=120){setDirection('down');onValueChange();}
else if(e.wheelDelta<=-120){setDirection('up');onValueChange();}
e.preventDefault();});if(this.addEventListener){this.addEventListener('DOMMouseScroll',function(e){if(e.detail>0){setDirection('down');onValueChange();}
else if(e.detail<0){setDirection('up');onValueChange();}
e.preventDefault();},false);}
function raiseCallback(val){if(settings.callback!=null)settings.callback(val);}
function getSelectedText(){var startPos=el.get(0).selectionStart;var endPos=el.get(0).selectionEnd;var doc=document.selection;if(doc&&doc.createRange().text.length!=0){return doc.createRange().text;}else if(!doc&&el.val().substring(startPos,endPos).length!=0){return el.val().substring(startPos,endPos);}
return'';}
function setValue(a,b){if(a>=settings.min&&a<=settings.max){value=b;}el.val(value);}
function onValueChange(){if(direction=='up'){value+=settings.stepInc;if(value>settings.max)value=settings.max;setValue(parseFloat(el.val()),value);}
if(direction=='down'){value-=settings.stepInc;if(value<settings.min)value=settings.min;setValue(parseFloat(el.val()),value);}
if(direction=='pup'){value+=settings.pageInc;if(value>settings.max)value=settings.max;setValue(parseFloat(el.val()),value);}
if(direction=='pdown'){value-=settings.pageInc;if(value<settings.min)value=settings.min;setValue(parseFloat(el.val()),value);}
raiseCallback(value);}
function setClass(name){el.removeClass('up').removeClass('down');if(name!='')el.addClass(name);}});}});})(jQuery);
var CheckinWidget={isInitialzed:false,oci_fieldChosen:"confNum",predictiveTextDefinition:{includeCityLevelCodes:false},initialize:function(){CheckinWidget.handleFormDisplay(CheckinWidget.oci_fieldChosen,false);$("#oci_checkinSearchType").on("change",function(){CheckinWidget.handleFormDisplay($(this).val(),true);});$('body').prepend('<div id="oci-wait-screen" style="display: none; position: relative; border-radius: 4px; margin: 120px auto; width: 930px; height: 483px; background: white; background-image: url('+imgPath+'/content/dam/delta-applications/pcc/widget/images/texture-lightVer2.png)"><div style="padding-top: 90px; color: black; text-align: center; font-size: 48px"><img style="position: absolute; left: 120px; top: 85px;" src=\"'+imgPath+'/content/dam/delta-applications/pcc/widget/images/plane-loading.gif">JUST A MOMENT...</div><div style="padding-top: 30px; color: black; text-align: center; font-size: 24px">Finding your trip details</div><div style="border: 2px solid #BFC8D5; border-radius: 4px; background: url('+imgPath+'/content/dam/delta-applications/pcc/widget/images/oci_retrieve_itinerary.jpg); margin: 75px 18px; text-align: center; height: 230px; width: 890px"><div style="font-size: 36px; color: #003366; padding: 65px 0px 0px 325px;">SURF AT 10,000 FEET</div><div style="color: #333333; font-size: 16px; padding: 20px 0px 0px 420px; text-align: left;">Stay connected with Delta. We have more Wi-Fi on more aircraft than any other airline</div></div><div style="display: none"><img src=\"'+imgPath+'/content/dam/delta-applications/pcc/widget/images/oci_retrieve_itinerary.jpg"></div></div>');$("#oci_checkinForm").submit(function(){if(CheckinWidget.validateFindBy()){setTimeout(function(){$('body').html($("#oci-wait-screen"));$("#oci-wait-screen").show();},1);}else{return false;}});DeltaUtils.addAutocomplete("#oci_airPortField","airportCode");try{$('#oci_confirmation_info').on('click',function(event){DeltaUtils.showToolTip('oci_confirmation_info',$('#ociConfirmationTooltip').val(),0,5,'',250,'','');});$('#oci_ticket_info').on('click',function(event){DeltaUtils.showToolTip('oci_ticket_info',$('#ociTicketTooltip').val(),0,5,'',250,'','');});}catch(e){}
if(!CheckinWidget.isInitialzed){CheckinWidget.getOciCheckinEligibleTrips();CheckinWidget.createAirportBubble();CheckinWidget.hideErrorRegions();CheckinWidget.isInitialzed=true;$("#nav-widget-checkin").click(function(){try{delta.navwidget.adjustWidgetHeight("checkin");}catch(e){}});}
setTimeout('$(\'#oci_checkinForm select\').focus().blur();',2);},handleFormDisplay:function(value,isAdjustHeight){CheckinWidget.hideErrorRegions();$("#oci_checkinForm").find("input").removeClass("error");$(".oci_checkinWidgetFieldHolder").hide();$(".oci_checkinWidgetLabelHolder").show();if(value=="confirmationInput"){$(".oci_confirmationNumberHolder").show();$(".oci_confirmationNumberHolder").css("display","block");CheckinWidget.oci_fieldChosen="confNum";}else if(value=="eticketInput"){$(".oci_eticketNumberHolder").show();CheckinWidget.oci_fieldChosen="eTicket";$(".oci_eticketNumberHolder").css("display","block");}else if(value=="skymilesInput"){$(".oci_skymilesNumberHolder").show();CheckinWidget.oci_fieldChosen="skyMiles";$(".oci_skymilesNumberHolder").css("display","block");}else if(value=="creditCardInput"){$(".oci_creditcardNumberHolder").show();CheckinWidget.oci_fieldChosen="ccNum";$('#oci_cardNumField').validateCreditCard(getCreditCardType);$(".oci_creditcardNumberHolder").css("display","block");}else{$(".oci_confirmationNumberHolder").show();$(".oci_confirmationNumberHolder").css("display","block");}
if(isAdjustHeight){CheckinWidget.adjustCheckinWidgetHeight();}},hideErrorRegions:function(){$(".oci_noDisplay").hide();},validateFindBy:function(){var findByError=true;var airportError=true;var errorPresent=false;CheckinWidget.hideErrorRegions();try{var actionURL=$("#oci_checkinForm").attr("action");if(actionURL.indexOf("https")==-1){var protocol="https://";var host=location.hostname;var secureURL=protocol+host+actionURL;$("#oci_checkinForm").attr("action",secureURL);}}catch(e){};if(CheckinWidget.oci_fieldChosen=="confNum"){var validConfirm=/^[a-zA-Z0-9]{6}$/g;var confirmationNumber=DeltaUtils.removeSpaces($("#oci_confNumField").val());if(confirmationNumber.search(validConfirm)){$("#oci_confirmationError").show();$("#oci_confNumField").addClass("error");findByError=false;}else{$("#oci_confNumField").removeClass("error");}}else if(CheckinWidget.oci_fieldChosen=="eTicket"){var validEticket=/^[0-9]{13,14}$/g;if($("#oci_eTicketField").val().search(validEticket)){$("#oci_eticketError").show();$("#oci_eTicketField").addClass("error");findByError=false;}else{$("#oci_eTicketField").removeClass("error");}}else if(CheckinWidget.oci_fieldChosen=="skyMiles"){var validSkymiles=/^[0-9]{10}$/g;if($("#oci_skyMilesField").val().search(validSkymiles)){$("#oci_skymilesError").show();$("#oci_skyMilesField").addClass("error");findByError=false;}else{$("#oci_skyMilesField").removeClass("error");}}else if(CheckinWidget.oci_fieldChosen=="ccNum"){var ccNumInput=$("#oci_cardNumField").val();if(ccNumInput.length==0||isNotNumberAndValidLength(ccNumInput)){$("#oci_creditcardError").show();$("#oci_cardNumField").addClass("error");findByError=false;}else{$("#oci_cardNumField").removeClass("error");}
if($("#oci_lastNameField").val().length==0){$("#oci_lastnameError").show();$("#oci_lastNameField").addClass("error");findByError=false;}else{$("#oci_lastNameField").removeClass("error");}}
var validAirport=/([a-zA-Z]{3})+/g;if($("#oci_airPortField").val().search(validAirport)){$("#oci_airportError").show();$("#oci_airPortField").addClass("error");airportError=false;}else{$("#oci_airPortField").removeClass("error");}
if(airportError&&findByError){errorPresent=true;CheckinWidget.adjustCheckinWidgetHeight();}else{errorPresent=false;}
CheckinWidget.adjustCheckinWidgetHeight();return errorPresent;},getOciCheckinEligibleTrips:function(){try{if(typeof CustomerInfo!='undefined'&&CustomerInfo.isLoggedIn()){$.ajax({type:"POST",url:"/PCCOciWeb/getCheckinEligibleTripsAction.action",timeout:15000,success:function(data){$("#oci_availableTrips").html(data);if(DeltaUtils.exists(data)&&data!==""){CheckinWidget.adjustCheckinWidgetHeight();}},error:function(){$("#oci_availableTrips").html("");}});}else{$("#oci_availableTrips").html("");}}catch(e){}},adjustCheckinWidgetHeight:function(){try{delta.navwidget.adjustWidgetHeight("checkin");}catch(e2){}},createAirportBubble:function(){try{var ociAirportLookup=new AirportLookup({targetInp:'#oci_airPortField',displayTitle:'From Airport',serverUrl:window.location.host});ociAirportLookup.attachEventHandlers();}catch(e1){}}};function OciConstants(){counts=0,getCounts=function(){return counts;},addCounts=function(){counts++;};}
function isNotNumberAndValidLength(value){var status=false;if(/[^0-9]/.test(value)||value.length<10||value.length>16){status=true;}
return status;}
function getCreditCardType(result){if(result!=null&&result.card_type!=null){$('#oci_checkinCreditcardType').val(result.card_type.code);}else{$('#oci_checkinCreditcardType').val(null);}}
(function(){$.fn.validateCreditCard=function(callback){var card,card_type,card_types,get_card_type,normalize,validate,validate_number;card_types=[{name:'amex',code:'AX',pattern:/^3[47]/,valid_length:[15]},{name:'diners_club_carte_blanche',code:'DC',pattern:/^30[0-5]/,valid_length:[14]},{name:'diners_club_international',code:'DC',pattern:/^36/,valid_length:[14]},{name:'jcb',code:'JC',pattern:/^35(2[89]|[3-8][0-9])/,valid_length:[16]},{name:'laser',code:'LS',pattern:/^(6304|670[69]|6771)/,valid_length:[16,17,18,19]},{name:'visa_electron',code:'VI',pattern:/^(4026|417500|4508|4844|491(3|7))/,valid_length:[16]},{name:'visa',code:'VI',pattern:/^4/,valid_length:[16]},{name:'mastercard',code:'CA',pattern:/^5[1-5]/,valid_length:[16]},{name:'maestro',code:'TO',pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,valid_length:[12,13,14,15,16,17,18,19]},{name:'discover',code:'DS',pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]},{name:'uatp',code:'TP',pattern:/^1/,valid_length:[16]}];get_card_type=function(number){var _j,_len1;for(_j=0,_len1=card_types.length;_j<_len1;_j++){card_type=card_types[_j];if(number.match(card_type.pattern)){return card_type;}}
return null;};validate_number=function(number){card_type=get_card_type(number);return callback({card_type:card_type});};validate=function(){var number;number=normalize($(this).val());return validate_number(number);};normalize=function(number){return number.replace(/[ -]/g,'');};this.bind('input',function(){$(this).unbind('keyup');return validate.call(this);});this.bind('keyup',function(){return validate.call(this);});if(this.length!==0){validate.call(this);}
return this;};}).call(this);
$(function(){var events="event69";var originCode="";var destinationCode="";function extractAirportCode(fieldId){var originalCodeStr=$(fieldId).val(),startAirCode=originalCodeStr.indexOf('('),airCode=originalCodeStr.substr(startAirCode+1,3);return airCode;}
$("#escape-widget").delegate("#ui-tabs li","click",function(){var tab="";tab="home:"+$(this).find("a").text().toLowerCase();s.linkTrackVars="prop1, prop2";s.prop1=tab;s.prop2="home";s.tl(this,"o",tab);s.prop1=s.prop2="";});$("#escape-widget-bok").delegate("#escape-search-submit-bok","click",function(){if(EscapeWidget.childrenInterstitial.wait){$('#escape-interstitial-submit').click(function(){setTags();});}else if($('#escape-search').find('.airporterror.error').length<=0){setTags();};function setTags(){var priceVsDeparture="";originCode=extractAirportCode("#escape-search-origin_bok").toLowerCase();destinationCode=extractAirportCode("#escape-search-destination_bok").toLowerCase();var airDisplayIndicator=$("input:radio[name='airDisplayIndicator']:checked").val().toLowerCase();if(airDisplayIndicator==='p')
priceVsDeparture="best price";else if(airDisplayIndicator==='s')
priceVsDeparture="departure time";s.linkTrackVars="events,eVar58,eVar59,eVar60";s.linkTrackEvents=events;s.events=events;s.eVar58="search:"+originCode;s.eVar59="search:"+destinationCode;s.eVar60=priceVsDeparture;s.tl(this,"e","hp:book a trip widget vacation tab search");s.eVar58=s.eVar59=s.eVar60=s.events="";}});});var VacationWidget=window.VacationWidget||{};VacationWidget=(function($){var escpOCdSearch=CookieUtils.get("escpOCdSearch");if(escpOCdSearch!=null){$('#escape-search-origin_bok').attr("value",escpOCdSearch);}
var runCount=0;var currentElement=null;var currentErrorMessage="";var cityOrAirportHolderText="City or Airport";var departureDateHolderText="Depart Date";var postalCodeHolderText="U.S. Zip Code";var searchORSpecialityURL="";if($('#isProd_bok').val()==='true'){searchURL='https://www.deltavacations.com/';}else{searchURL='https://qa.deltavacations.com/';}
var pub={},activeInputFieldId,airportsList={},regionsList={},departureDatesList={},countryLang={country:'',lang:''},loginInfo={},searchSubmitConfig={autofillErrors:[],searchParams:{},querystr:{baseUrl:searchURL,pageUrl:function(){var url=searchSubmitConfig.querystr.baseUrl+'sitenav?tag=BOOK_COBRAND&package=ah&extAppSource=DELTA&'+$.param(searchSubmitConfig.searchParams,true)+'&coBrand=TEST&fewestStops=true&rfr=DLHPBATFHSEARCH';return url;},loginUrl:function(){var url=searchSubmitConfig.querystr.pageUrl()+'&extAppSource=DELTA&'+$.param(loginInfo,true)
return url;}}},dataConfig={interstitialUrl:'/escape/escape/tmpl/_interstitial.tmpl.jsp',popupUrl:'/escape/escape/tmpl/airportpicker.jsp',airportsJsonUrl:'/escape/json/AirportData.txt',regionsJsonUrl:'/escape/json/RegionData.txt',crusDateJsonUrl:'/escape/json/FetchDate.action',loginJsonUrl:'/escape/json/FetchLogin.action',errorfile:function(errorCode){var url='/escape/errors/escape/'+errorCode+'.html';if(window.location.hostname==='localhost'){url='http://dvl7.delta.com'+url;}
return url;},airportsJsonUrl:'/escape/json/FetchAirports.action',regionsJsonUrl:'/escape/json/FetchRegions.action',crusDateJsonUrl:'/escape/json/FetchDate.action',loginJsonUrl:'/escape/json/FetchLogin.action',interstitialUrl:'/escape/escape/tmpl/_interstitial.tmpl.jsp',popupUrl:'/escape/escape/tmpl/airportpicker.jsp'},uiDialogTitleCss={airportPicker:{'width':'100%','background':'#fff','height':'35px','margin':'-1px 0 30px','padding':'5px 15px','boxShadow':'0 1px 2px rgba(0,0,0, 0.5)','borderRadius':'2px 2px 0 0'},interstitial:{'background':'#fff','boxShadow':'0 1px 2px rgba(0,0,0, 0.5)','borderRadius':'2px 2px 0 0','height':'auto','width':'95%'}};pub.predictiveTextDefinition={includeCityLevelCodes:false,isUSOnly:true};pub.init=function(){$('#escape-tabs').removeClass('ui-widget');$('#escape-tabs #ui-tabs-search').removeClass('ui-tabs-panel');determineWidgetCountry();handleInputPlaceholder()
if(VacationWidget.getRunCount()===0){setTimeout('$(\'#escape-maincontent-bok select\').focus().blur();',2);}};function createAirportBubble(){try{var searchOrigin=new AirportLookup({targetInp:'#escape-search-origin_bok',displayTitle:cityOrAirportHolderText,serverUrl:window.location.host});searchOrigin.attachEventHandlers();var searchDestination=new AirportLookup({targetInp:'#escape-search-destination_bok',displayTitle:cityOrAirportHolderText,serverUrl:window.location.host});searchDestination.attachEventHandlers();}catch(e1){}}
function handleInputPlaceholder(){if($.browser.msie){var mapFromInputField=$("#escape-mapit-from");var searchFromInputField=$('#escape-search-origin_bok');var searchToInputField=$('#escape-search-destination_bok');var departureDateInputField=$('#escape-search-date_bok');var postalCodeInputField=$('#escape-cruises-zip');$(document).on('click','#close_image',function(){$('#escape-widget-popup').remove();});mapFromInputField.click(function(){if(mapFromInputField.val()==cityOrAirportHolderText){mapFromInputField.val("");}});searchFromInputField.click(function(){if(searchFromInputField.val()==cityOrAirportHolderText){searchFromInputField.val("");}});searchToInputField.val(cityOrAirportHolderText);searchToInputField.click(function(){if(searchToInputField.val()==cityOrAirportHolderText){searchToInputField.val("");}});departureDateInputField.val(departureDateHolderText);departureDateInputField.click(function(){if(departureDateInputField.val()==departureDateHolderText){departureDateInputField.val("");}});postalCodeInputField.val(postalCodeHolderText);postalCodeInputField.click(function(){if(postalCodeInputField.val()==postalCodeHolderText){postalCodeInputField.val("");}});}}
var loadJsonData={airports:function(){$.ajax({dataType:'json',error:function(xhr,ajaxOptions,thrownError){loadJsonData.showError('ESC0001','#escape-errormessage-search_bok');},success:function(data){airportsList=data;if(data.fault&&data.fault.error.errorCode){loadJsonData.showError(data.fault.error.errorCode,'#escape-errormessage-search_bok');}else{populateLists.init('autocomplete');}
loadJsonData.setDefaultAirport();DeltaUtils.initButtons();},type:'GET',url:dataConfig.airportsJsonUrl});},cruises:function(){$.ajax({dataType:'json',error:function(){loadJsonData.showError('ESC0001','#escape-errormessage-cruises');},success:function(data){departureDatesList=data
if(data.fault&&data.fault.error.errorCode){loadJsonData.showError(data.fault.errorCode,'#escape-errormessage-cruises');}else{populateLists.init('cruises');}},type:'GET',url:dataConfig.crusDateJsonUrl});},showError:function(errorCode,location){var x=dataConfig.errorfile(errorCode),$elm=$(location);if(x!==null&&errorCode!==null){$.ajax({dataType:'html',error:function(){$elm.html('<p>System Error <br /><b>'+dataConfig.errorfile(errorCode)+'</b> does not exist.</p>');},success:function(html){currentElement=location;currentErrorMessage=html;setTimeout("VacationWidget.displayErrorMessage()",20);},type:'GET',url:dataConfig.errorfile(errorCode)});}else{}},login:function(){$.getJSON(dataConfig.loginJsonUrl,function(data){loginInfo=data;loadJsonData.setDefaultAirport();});},setDefaultAirport:function(){if(loginInfo.homeAirportPref&&airportsList.originationAirports){$.each(airportsList.originationAirports,function(key,val){if(loginInfo.homeAirportPref===val.code){$('#escape-search-origin_bok').val(val.code);}});}}};var populateLists={airports:function(data,$textfield){var $elm=$('#escape-widget-popup #country_ul');populateLists.updateList($elm,data,'mapitOrigin',true);},cruisesDates:function(){$elm=$("#escape-cruises-deptmonth");$.each(departureDatesList.dateList,function(key,val){$elm.append('<option value="'+val.date+'">'+val.displayDate+'</option>');});},setAutoComplete:function(elmId,data){var availableTags=[];$.each(data,function(key,val){availableTags.push(val.name)});$.ui.autocomplete.prototype._renderItem=function(ul,item){var term=this.term.split(' ').join('|'),re=new RegExp("("+term+")","gi"),t=item.label.replace(re,"<span class='matchedAutofill'>$1</span>");var noAirportCode=this.element;if(noAirportCode.attr("noairportcode")=="true"){item.value=item.label;}else{if(item.label.indexOf("(")=="-1"){item.label+="()";}
item.value=item.label.split("(")[1].split(")")[0];}
return $("<li></li>").data("item.autocomplete",item).append("<a>"+t+"</a>").appendTo(ul);};$(elmId).autocomplete({source:availableTags,selectFirst:true,change:function(event,ui){var $elm=$(this);if($elm.val().length!=0){vacationValidation.autocomplete($elm,availableTags);$(".airporterror:visible").addClass("error");}
else if($elm.is(":visible")&&$elm.hasClass("airporterror")){if($elm.attr("id")=="escape-mapit-from"){}
$elm.removeClass("airporterror error");if($(".airporterror:visible").size()==0){$("#escape-errormessage-search_bok").text("");}}},appendTo:"body"});},updateList:function($elm,data,id,autofill){$('.escape-multiselect').width('100%');$('.ui-dialog-titlebar').css(uiDialogTitleCss.airportPicker);if($.type($elm)!=='object'){$elm=$($elm);}
if(!autofill){autofill=false;}
$elm.empty();$.each(data,function(key,val){if(autofill===true){$elm.append('<li id="'+id+'-'+val.code+'">'+val.name+'</li>');}else{$elm.append('<option id="'+id+'-'+val.code+'" value="'+val.code+'">'+val.name+'</option>');}});$('#escape-widget-popup #scroll_country').tinyscrollbar({sizethumb:17});},init:function(list){if(list==='regions'){this.regions();}else if(list==='autocomplete'){this.setAutoComplete('#escape-mapit-from',airportsList.originationAirports);this.setAutoComplete('#escape-search-origin_bok',airportsList.originationAirports);this.setAutoComplete('#escape-search-destination_bok',airportsList.destinationAirports);}else if(list==='cruises'){this.cruisesDates();}else{}}};function setActiveInputId(elmId){if(activeInputFieldId){checkInnerlabel($('body').find(activeInputFieldId));}
activeInputFieldId=elmId;}
function extractAirportCode(fieldId){var originalCodeStr=$(fieldId).val(),startOriginCode=originalCodeStr.indexOf('('),originCode=originalCodeStr.substr(startOriginCode+1,3)
return originCode;}
var submitPage={cruises:function(){var a={"places":$("#escape-cruises-dest").val(),"Month":$("#escape-cruises-deptmonth").val(),"c":$("#escape-cruises-cruiseline").val(),"days":$("#escape-cruises-days").val(),"shoppingZipCode":$("#escape-cruises-zip").val(),"IncludeSeniorRates":$("#escape-cruise-age").is(':checked')},b;cruisesSubmitConfig.cruisesParams=a;b=cruisesSubmitConfig.querystr.pageUrl();window.open(b,'_blank');},mapit:function(){var product={'originregion':$('#escape-mapit-to').val(),'origincode':$('#escape-mapit-from').val()};CookieUtils.create("escpOCd",$('#escape-mapit-from').val(),10);$('#escape-mapit-to').val(product.originregion);$('#escape-mapit-from').val(product.origincode);},searchVacations:function(){function getDepartDate(){var val=$("#escape-search-date_bok").val(),yyyy=val.substr(6),first=val.substr(0,6),last=((yyyy.length==2)?'20'+yyyy:yyyy),full=first+last;CookieUtils.create("escpOCdSearch",$('#escape-search-origin_bok').val(),10);return full;}
Date.prototype.customFormat=function(){var YY,MM,M,DD,D;var dateObject=this;YY=((dateObject.getFullYear())+"").slice(-2);MM=(M=dateObject.getMonth()+1)<10?('0'+M):M;DD=(D=dateObject.getDate())<10?('0'+D):D;return MM+'/'+DD+'/'+YY;}
function getReturnDate(){var depart=parseInt(Date.parse(getDepartDate()));var nights=parseInt($("#vacation-search-length").val())*24*60*60*1000;var returnDate=new Date(depart+nights).customFormat();return returnDate;}
var a={"airDisplayIndicator":$("input:radio[name='airDisplayIndicator']:checked").val(),"adultCount":$("#escape-search-adults_bok").val(),"childCount":$("#escape-search-children_bok").val(),"origin":extractAirportCode('#escape-search-origin_bok'),"destination":extractAirportCode('#escape-search-destination_bok'),"departureDate":$("#escape-search-date_bok").val(),"departureTime":$("#escape-search-time").val(),"returnDate":getReturnDate()};if(pub.childrenInterstitial.wait===true){$('#escape-interstitial .escape-child').each(function(index){a["child["+index+"].age"]=$(this).val();});};searchSubmitConfig.searchParams=a;if(loginInfo.loggedIn===true){var b=searchSubmitConfig.querystr.loginUrl();window.open(b,'_blank');}else{var b=searchSubmitConfig.querystr.pageUrl();window.open(b,'_blank');}
return{"getDepartDate":getDepartDate};}};function popitup(url){newwindow=window.open(url);if(window.focus){newwindow.focus()}
return false;}
function enableEventListeners(){$('#escape-mapit-airportpicker').click(function(){setActiveInputId('#escape-mapit-from');airportsPopup.displayPopup({elementId:'#escape-widget-popup',data:airportsList.originationAirports,$textfield:$(this).prev('input'),callback:populateLists.airports});return false;});$('#formField_bok').click(function(){setActiveInputId('#escape-search-origin_bok');airportsPopup.displayPopup({elementId:'#escape-widget-popup',data:airportsList.originationAirports,$textfield:$(this).prev('input'),callback:populateLists.airports});return false;});$('#toField_bok').click(function(){setActiveInputId('#escape-search-destination_bok');airportsPopup.displayPopup({elementId:'#escape-widget-popup',data:airportsList.destinationAirports,$textfield:$(this).prev('input'),callback:populateLists.airports});return false;});$('input[type=text]').focus(function(){$(this).prev('.escape-innerlabel').css('visibility','hidden')}).on("change blur",function(){checkInnerlabel($(this))});$('#escape-search-submit-bok').click(function(e){vacationValidation.searchTab();});}
$('#escape-search-origin_bok').live('keypress',function(e){var elmLength=$(this).val().length;if(elmLength<=4){if($(".airporterror:visible").size()==1){$('.escape-errormessage_bok:visible').addClass("hidden");delta.navwidget.adjustWidgetHeight("escape");}
$(this).removeClass("error");}});$('#escape-search-destination_bok').live('keypress',function(e){var elmLength=$(this).val().length;if(elmLength<=4){if($(".airporterror:visible").size()==1){$('.escape-errormessage_bok:visible').addClass("hidden");delta.navwidget.adjustWidgetHeight("escape");}
$(this).removeClass("error");}});var spinners={setDefaultSpinners:function(){$('#escape-search-adults_bok').spinit({min:1,max:5,stepInc:1,width:15,height:24,initValue:2});$('#escape-search-children_bok').spinit({min:0,max:4,stepInc:1,width:15,height:24});$('#vacation-search-length').spinit({min:1,max:28,stepInc:1,initValue:4,width:15,height:24});},setInterstitialSpinner:function(){$('.childSpinners').spinit({min:1,max:17,stepInc:1,width:15,height:24});}};function enableDatePickerBok(){delta.calendar.globalConfiguration();delta.calendar.create({calendarElement:$('.calendarWidgetHolder'),daysInFutureToShow:331,daysInPastToShow:0,startDateTitle:'Depart Date',showDropDown:true});}
var initWidget_bok={defaultWidget_bok:function(){this.showHide('#escape-widget-default-bok');changeActiveTab();loadJsonData.airports();loadJsonData.login();enableEventListeners();enableDatePickerBok();$('#escape-widget-bok #depDateCalIcon, #escape-widget-bok .calendarClickIcon_bok').on('click',function(e){e.stopPropagation();$('#escape-search-date_bok').trigger("focus");});spinners.setDefaultSpinners();checkInnerlabel($('#escape-mapit-from'));checkInnerlabel($('#escape-search-origin_bok'));$('#escape-cruises-dest').val('ALL');var cruisesHtml="<b>YOU MAY QUALIFY FOR SPECIAL RESIDENT OR SENIOR RATES!</b><br/><br/>Why We Ask For A Zip Code:<br/>For many cruises, we can obtain special rates for residents of particular states.Providing your 5-digit zip code allows us to apply these additional savings to your cruise price.<br /><br />Special rates are indicated by the \"Special Rate\"<br /><br />Any traveler who qualifies for a special resident rate will be required to show a government-issued form of identification  (passport, or birth certificate and driver's license) at the pier to validate state of residency prior to boarding the cruise ship. If you do not have a U.S. zip code, please call a cruise specialist at 800-820-3244 24 hours a day, 7 days a week.<br /><br />Why We Ask \"Over 55\"<br />For many cruises, we can obtain special rates for passengers 55 years of age or older*. If any traveler in your stateroom is 55 years of age or older by the date the cruise departs, these special rates and additional savings may apply for all travelers in your party.<br /><br />Special rates are indicated by the \"Special Rate\"<br /><br />Any traveler who qualifies for this special rate will be required to show a governmentissued form of identification (passport, or birth certificate and driver's license) at the pier to validate his/her age prior to boarding the cruise ship.<br /><br />* Costa Cruise Lines senior age is 60 years or older; all others are 55 or older."
DeltaUtils.showToolTip('escape-seniordiscounttip',cruisesHtml,-13,13,'',250,'','');var childrenTipHtml="<b>Booking Age Restrictions</b><br/><br/>Children under the age of two traveling within the U.S. with a parent or an adult 18 years of age and older can travel on the adult's lap as a \'lap child\', and can be added to your reservation by contacting us at 1-800-800-1504 once you complete your booking online. If there are two or more children under the age of two traveling with the same adult, only one of the children may travel as a lap child. Any additional children are required to have a seat purchased for them. <br/><br/>All children under the age of two traveling internationally are required to have a ticket purchased for them at a percentage of the adult base fare, plus applicable taxes and fees. Regardless of your destination, you should indicate you are traveling with an infant when making your reservation.";DeltaUtils.showToolTip('escape-search-childrentip_bok',childrenTipHtml,-13,13,'',250,'','');},japaneseWidget:function(){this.showHide('#escape-widget-japan-bok');DeltaUtils.initButtons();$('#escape-jpncta').click(function(){window.location='http://www.DeltaVacations.jp';delta.navwidget.adjustWidgetHeight("escape");return false;});},internationalWidget:function(){this.showHide('#escape-widget-international-bok');$('#escape-intcta').click(function(){initWidget_bok.defaultWidget_bok();delta.navwidget.adjustWidgetHeight("escape");return false;})},showHide:function(widget){$('.escape-regionalwidget-bok').hide();if($(widget).hasClass('hidden')){$(widget).removeClass('hidden');}
$(widget).show();}};function determineWidgetCountry(){countryLang.country=CookieUtils.get('MP_COUNTRY');countryLang.lang=CookieUtils.get('MP_LANG');if((countryLang.country==="us"||countryLang.country==="US"||countryLang.country==="ca"||countryLang.country==="CA"||typeof(countryLang.country)=='undefined')&&(countryLang.lang.toLowerCase()==="en"||typeof(countryLang.lang)=='undefined')){initWidget_bok.defaultWidget_bok();}else if(countryLang.lang=="ja"||countryLang.lang=="JA"){initWidget_bok.japaneseWidget();}else{initWidget_bok.internationalWidget();}}
var airportsPopup={calculatePosition:function(){var $field=$(activeInputFieldId);var widgetOffset=$('#widget-booking').offset();var popupOffset=0;var inputOffset=$field.offset();var inputPosition=$field.position();var inputWidth=$field.width();var originInputOffset=$('#escape-search-origin_bok').position();var totaltop=$('#widget-booking').offset().top+$('#widget-escape .widgetCloseHeader').height()+$('#widget-escape ul').height()+$('#escape-search-origin_bok').position().top+$field.height()+$field.height()+5;if($(".widget-container-docked").length>0){widgetOffset=$field.closest("div.widget-container-docked").offset();$('#escape-widget-popup #airportlookup_dropdown').offset({left:widgetOffset.left-popupOffset,}).css({'position':'fixed','top':'auto','bottom':'-50px'});}else{$('#escape-widget-popup #airportlookup_dropdown').offset({left:widgetOffset.left-popupOffset,top:inputOffset.top+$field.height()+1});}
$('#escape-widget-popup .from_arrow_container').css('paddingLeft',inputWidth/2+inputPosition.left+popupOffset);},closePopup:function(){$('#escape-widget-popup #close_image').click(function(){removePopup();});$('#escape-widget-popup #country_ul li').click(function(){if($(activeInputFieldId).attr("noairportcode")!="true"){var code=$(this).text().split("(")[1].split(")")[0];$(activeInputFieldId).val(code);}else{$(activeInputFieldId).val($(this).text());}
removePopup();});function removePopup(){$('#escape-widget-popup').remove();$(activeInputFieldId).css({borderColor:'#CCCCCC',outline:'inherit'});}},displayPopup:function(params){var $target=$('body').find(params.elementId);if($target.length<=0){$('body').append('<div id="escape-widget-popup" />');$target=$('body').find(params.elementId);}
$target.empty().load(dataConfig.popupUrl,function(){params.callback(params.data,params.$textfield);airportsPopup.calculatePosition();$(activeInputFieldId).css({borderColor:'#0253A4',outline:'medium none'});airportsPopup.closePopup();});}};pub.childrenInterstitial={wait:false,init:function(params){var count=0,numberOfChild=$('#escape-search-children_bok').val();if(numberOfChild>=1&&numberOfChild!==count){pub.childrenInterstitial.wait=true;pub.childrenInterstitial.display(params,numberOfChild);}else{pub.childrenInterstitial.wait=false;}},display:function(params,numberOfChild){var interstitialSettings={autoOpen:true,resizable:false,draggable:false,modal:false,width:600,dialogClass:'escape-interstitial',title:'ENTER THE AGES OF YOUR CHILDREN'};var $target=$('body').find(params.elementId);if($target.length<=0){$('body').append('<div id="escape-interstitial" />');$target=$('body').find(params.elementId);}
var children={childrenResponses:[],multipleChildren:false};for(var i=1;i<=numberOfChild;i++){children.childrenResponses.push({'isChild':'Y'});}
if(children.childrenResponses.length>1){children.multipleChildren=true;}
$target.empty().dialog(interstitialSettings).load(dataConfig.interstitialUrl,function(){$('.escape-popup .ui-dialog-titlebar').width('100%');$target.html($('body').find('#_interstitial').render(children));DeltaUtils.initButtons();pub.childrenInterstitial.submitListener();});$('.ui-dialog-titlebar').css(uiDialogTitleCss.interstitial);airportsPopup.closePopup();},submitListener:function(){$('.escape-child').change(function(){if($('#escape-child1').val()!="Select"&&$('#escape-child2').val()!="Select"&&$('#escape-child3').val()!="Select"&&$('#escape-child4').val()!="Select")
{$(".ui-button").removeClass("ui-state-disabled");$(".ui-button").removeAttr("disabled");}
else if($('#escape-child1').val()=="Select"||$('#escape-child2').val()=="Select"||$('#escape-child3').val()=="Select"||$('#escape-child4').val()=="Select")
{$('#escape-interstitial-submit').addClass("ui-state-disabled");$("#escape-interstitial-submit").attr('disabled','disabled');}});$('#escape-interstitial-submit').click(function(){submitPage.searchVacations();$('#escape-interstitial').dialog('close');return false;});$('#escape-interstitial-cancel').click(function(){$('#escape-interstitial').dialog('close');return false;});}};var vacationValidation={autocomplete:function($elm,availableTags){var $form=$elm.parents('form'),usrStr=$elm.val().toString(),result;function _pickCity(){var noAirportCode=$elm.attr("noairportcode");var b=usrStr.toLowerCase();if(usrStr.length>=3){for(var i=0;i<availableTags.length;i++){var a=availableTags[i].toLowerCase();try{var cityCode=availableTags[i].split("(")[1].split(")")[0],cityName=$.trim(availableTags[i].split(",")[0]);}catch(e){continue;}
if(noAirportCode!="true"&&(cityName.toLowerCase()==b||cityCode.toLowerCase()==b||a==b)){result=availableTags[i];$elm.val(cityCode).removeClass('airporterror');break;}else if(noAirportCode=="true"&&(cityName.toLowerCase()==b||cityCode.toLowerCase()==b||a==b)){result=availableTags[i];$elm.val(result).removeClass('airporterror');break;}}}
if(!result){$elm.addClass('airporterror');_showErrorMessage();}}
function _showErrorMessage(){$form.children('.escape-errormessage_bok').text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");}
function _hideErrorMessage(){$form.children('.escape-errormessage_bok').text("").addClass("hidden");}
_pickCity();if($form.find('.airporterror').length<=0){_hideErrorMessage();}
delta.navwidget.adjustWidgetHeight("escape");return result;},mapit:function($elm){if(mapitSubmitConfig.goodToGo===false){vacationValidation.autofill("escape-mapit");}
var airport_origination=[];$.each(airportsList.originationAirports,function(key,val){airport_origination.push(val.name);});vacationValidation.autocomplete($("#escape-mapit-from"),airport_origination);},searchTab:function(){jQuery.validator.addMethod("math",function(value,element,params){var first=value.substr(0,6),yyyy=value.substr(6),last=((yyyy.length==2)?'20'+yyyy:yyyy),full=first+last,minStartDate=new Date();minStartDate.setDate(minStartDate.getDate());minStartDate.setHours(0);minStartDate.setMinutes(0);minStartDate.setSeconds(0);minStartDate.setMilliseconds(0);full=new Date(Date.parse(full));var dateDiff=(full-minStartDate)/(1000*60*60*24);if(minStartDate>full||minStartDate=="Depart date"||dateDiff>=335){$('#escape-errormessage-search_bok.escape-errormessage_bok').text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");return 0;}
else{$('#escape-errormessage-search_bok.escape-errormessage_bok').text("").addClass("hidden");}
return this.optional(element)||minStartDate<=full;},"This date cannot be booked because it is in the past. Please try another date.");jQuery.validator.addMethod("requiredCityRAirport",function(value,element,params){var val=$.trim(value);if(val==""||val=="City or Airport"){$('#escape-errormessage-search_bok.escape-errormessage_bok').text("We\'re sorry. No airport codes or cities match your entry; or the departure date must be after today\'s date. Please enter a valid departure date, enter valid city code, or click the city codes icon and select from the list.").removeClass("hidden");$("#escape-search-origin_bok").focus();}
else{$('#escape-errormessage-search_bok.escape-errormessage_bok').text("").addClass("hidden");}
return!(val==""||val=="City or Airport");},"");$('#vacation-search').validate({submitHandler:function(){pub.childrenInterstitial.init({elementId:'#escape-interstitial'});var airport_origination=[];var airport_destination=[];$.each(airportsList.destinationAirports,function(key,val){airport_destination.push(val.name);});$.each(airportsList.originationAirports,function(key,val){airport_origination.push(val.name);});vacationValidation.autocomplete($("#escape-search-origin_bok"),airport_origination);vacationValidation.autocomplete($("#escape-search-destination_bok"),airport_destination);if(pub.childrenInterstitial.wait===false&&$('#vacation-search').find('.airporterror').length<=0){submitPage.searchVacations();}
delta.navwidget.adjustWidgetHeight("escape");},invalidHandler:function(){delta.navwidget.adjustWidgetHeight("escape");},rules:{"escape-search-adults_bok":"required","escape-search-date_bok":{required:true,math:true},"escape-search-destination_bok":{requiredCityRAirport:true},"escape-search-origin_bok":{requiredCityRAirport:true},"vacation-search-length":"required"},errorPlacement:function(error,element){error.insertBefore(element.parents('.escape-imginput'));delta.navwidget.adjustWidgetHeight("escape");}});delta.navwidget.adjustWidgetHeight("escape");},cruisesTab:function(){jQuery.validator.messages.postalcode="Please enter a 5-digit U.S. zip code";jQuery.validator.classRuleSettings.postalcode={postalcode:true};jQuery.validator.addMethod("postalcode",function(value,element,param){if(value==""||value.match(/^\d{5}(-\d{4})?$/)||value==$("#escape-cruises-zip").attr("placeholder")){return true;}else{return false;}},jQuery.validator.messages.postalcode);$('#escape-cruises').validate({submitHandler:function(){submitPage.cruises();},showErrors:function(error,element){this.defaultShowErrors();delta.navwidget.adjustWidgetHeight("escape");},rules:{"escape-cruises-zip":{postalcode:true}}});}};function checkInnerlabel($inputField,popup){if(!popup){popup=false}}
function changeActiveTab(){var hasTabshow=false;function adjustWidget(){var $activeTab=$('.escape-activetab'),appendClass=$('#escape-tabs').find('.ui-state-active').attr('class').split(' ')[0].split('-')[2],removeClass=$activeTab.attr('class').split(' ')[1];$activeTab.removeClass(removeClass).addClass(appendClass);$('#escape-widget-popup').remove();$('#container1_inner').remove();delta.navwidget.adjustWidgetHeight("escape");$('#escape-widget-popup').remove();$('#container1_inner').remove();}
$('#escape-widget-bok').on('tabsshow',function(){hasTabshow=true;adjustWidget();});$("#nav-widget section").on("click",function(){$('#escape-interstitial').dialog('close');$('#escape-widget-popup #close_image').trigger('click');});if(hasTabshow===false){$('#escape-tabs li a').click(function(){if($('#aToolTip').is(':visible')){if($(this).parent().hasClass("ui-tab-cruises ui-state-default ui-corner-top ui-tabs-selected ui-state-active")){return false;}
$('#aToolTipCloseBtn').trigger('click');}
if(!$(this).parent().hasClass("ui-tab-search")){$('#escape-interstitial').dialog('close');}
adjustWidget();});}}
pub.getRunCount=function(){return runCount;}
pub.setRunCount=function(value){runCount=value;}
pub.displayErrorMessage=function(message){if(DeltaUtils.exists(currentElement)&&DeltaUtils.exists(currentErrorMessage)){$(currentElement).html(currentErrorMessage).removeClass('hidden');delta.navwidget.adjustWidgetHeight("escape");$("#escape-errormessage-search_bok").text("We are experiencing an unknown issue at this time. Please refresh this page or try again later. We apologize for the inconvenience.").removeClass("hidden");}}
return pub;})(jQuery);jQuery.validator.messages.vacationsRequiredFromCity="";jQuery.validator.classRuleSettings.vacationsRequiredFromCity={vacationsRequiredFromCity:true};jQuery.validator.addMethod("vacationsRequiredFromCity",function(value,element,param){ErrorMessages.clearErrorMsg(element);if(VacationsAirportValidation.isBlank(value,$(param[0]).val())){jQuery.validator.messages.vacationsRequiredFromCity="";return false;}else if((value=="City or Airport"||$.trim(value)=="")||value.length!=3||!(/^[a-z]+$/i.test(value))){jQuery.validator.messages.vacationsRequiredFromCity=ErrorMessages.noDate.errMsg+" 'FROM' City or Airport code.";return false;}else if(VacationsAirportValidation.sameValueOrBlank(value,$(param[0]).val())){jQuery.validator.messages.vacationsRequiredFromCity="";return false;}else{jQuery.validator.messages.vacationsRequiredFromCity="";return true;}},jQuery.validator.messages.vacationsRequiredFromCity);jQuery.validator.messages.vacationsRequiredToCity="";jQuery.validator.classRuleSettings.vacationsRequiredToCity={vacationsRequiredToCity:true};jQuery.validator.addMethod("vacationsRequiredToCity",function(value,element,param){ErrorMessages.clearErrorMsg(element);if(VacationsAirportValidation.isBlank(value,$(param[0]).val())){jQuery.validator.messages.vacationsRequiredToCity=ErrorMessages.blankAirports.errMsg;return false;}else if((value=="City or Airport"||$.trim(value)=="")||value.length!=3||!(/^[a-z]+$/i.test(value))){jQuery.validator.messages.vacationsRequiredToCity=ErrorMessages.noDate.errMsg+" 'TO' City or Airport code.";return false;}else if(VacationsAirportValidation.sameValueOrBlank(value,$(param[0]).val())){jQuery.validator.messages.vacationsRequiredToCity=ErrorMessages.sameAirport.errMsg;return false;}else{jQuery.validator.messages.vacationsRequiredToCity="";return true;}},jQuery.validator.messages.vacationsRequiredToCity);jQuery.validator.messages.vacationsRequiredHotelLocation="Please enter valid Hotel Location";jQuery.validator.classRuleSettings.vacationsRequiredHotelLocation={vacationsRequiredHotelLocation:true};jQuery.validator.addMethod("vacationsRequiredHotelLocation",function(value,element,param){ErrorMessages.clearErrorMsg(element);if(VacationsAirportValidation.isHotelLocationBlank(value)){return false;}else if((value=="City or Airport"||$.trim(value)=="")||value.length!=3||!(/^[a-z]+$/i.test(value))){return false;}else{jQuery.validator.messages.vacationsRequiredHotelLocation="";return true;}},jQuery.validator.messages.vacationsRequiredHotelLocation);jQuery.validator.messages.vacationsRequiredStartDate="";jQuery.validator.classRuleSettings.vacationsRequiredStartDate={vacationsRequiredStartDate:true};jQuery.validator.addMethod("vacationsRequiredStartDate",function(value,element,param){ErrorMessages.clearErrorMsg(element);var invalidFormatCheck=VacationsDateValidation.formatCheck(value);var invalidmaxRangeCheck=VacationsDateValidation.maxRangeCheck(value);var invalidminRangeCheck=VacationsDateValidation.minRangeCheck(value);var invalidReturnDate=VacationsDateValidation.returnCheck();if(VacationsDateValidation.blankDateCheck(param.departureDateField,param.returnDateField)){jQuery.validator.messages.vacationsRequiredStartDate="";return false;}else if(value=="Depart Date"||$.trim(value)==""){jQuery.validator.messages.vacationsRequiredStartDate=ErrorMessages.noDate.errMsg+" Departure Date.";return false;}else if(invalidFormatCheck){if($('div[for=returnDate]').text()!=ErrorMessages.invalidFormatDate.errMsg||($('div[for=returnDate]').text()==ErrorMessages.invalidFormatDate.errMsg&&$('div[for=returnDate]').css("display")=="none")){jQuery.validator.messages.vacationsRequiredStartDate=ErrorMessages.invalidFormatDate.errMsg;}else{jQuery.validator.messages.vacationsRequiredStartDate="";}
return false;}else if(invalidmaxRangeCheck){jQuery.validator.messages.vacationsRequiredStartDate=ErrorMessages.futureDate.errMsg;return false;}else if(invalidminRangeCheck){jQuery.validator.messages.vacationsRequiredStartDate=ErrorMessages.noDate.errMsg+" Departure Date.";return false;}else if(invalidReturnDate){jQuery.validator.messages.vacationsRequiredStartDate=ErrorMessages.noDate.errMsg+" Departure Date.";$("#"+element.id).val("");return false;}else{jQuery.validator.messages.vacationsRequiredStartDate="";return true;}},jQuery.validator.messages.vacationsRequiredStartDate);jQuery.validator.messages.vacationsRequiredReturnDate="";jQuery.validator.classRuleSettings.vacationsRequiredReturnDate={vacationsRequiredReturnDate:true};jQuery.validator.addMethod("vacationsRequiredReturnDate",function(value,element,param){ErrorMessages.clearErrorMsg(element);var invalidFormatCheck=VacationsDateValidation.formatCheck(value);var invalidmaxRangeCheck=VacationsDateValidation.maxRangeCheck(value);var invalidminRangeCheck=VacationsDateValidation.minRangeCheck(value);var invalidReturnDate=VacationsDateValidation.returnCheck();if(VacationsDateValidation.blankDateCheck(param.departureDateField,param.returnDateField)){jQuery.validator.messages.vacationsRequiredReturnDate=ErrorMessages.blankDates.errMsg;return false;}else if(value=="Return Date"||$.trim(value)==""){jQuery.validator.messages.vacationsRequiredReturnDate=ErrorMessages.noDate.errMsg+" Return Date.";return false;}else if(invalidFormatCheck){if($('div[for=departureDate]').text()!=ErrorMessages.invalidFormatDate.errMsg||($('div[for=departureDate]').text()==ErrorMessages.invalidFormatDate.errMsg&&$('div[for=departureDate]').css("display")=="none")){jQuery.validator.messages.vacationsRequiredReturnDate=ErrorMessages.invalidFormatDate.errMsg;}else{jQuery.validator.messages.vacationsRequiredReturnDate="";}
return false;}else if(invalidmaxRangeCheck){jQuery.validator.messages.vacationsRequiredReturnDate=ErrorMessages.futureDate.errMsg;return false;}else if(invalidminRangeCheck){jQuery.validator.messages.vacationsRequiredReturnDate=ErrorMessages.noDate.errMsg+" Return Date.";return false;}else if(invalidReturnDate){jQuery.validator.messages.vacationsRequiredReturnDate=ErrorMessages.noDate.errMsg+" Return Date.";$("#"+element.id).val("");return false;}else{jQuery.validator.messages.vacationsRequiredReturnDate="";return true;}},jQuery.validator.messages.vacationsRequiredReturnDate);jQuery.validator.messages.vacationsHotelDate="Please enter a valid ";jQuery.validator.classRuleSettings.vacationsHotelDate={vacationsHotelDate:true};jQuery.validator.addMethod("vacationsHotelDate",function(value,element,param){jQuery.validator.messages.vacationsHotelDate="Please enter a valid ";value=DeltaUtils.removeSpaces(value);try{var re=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(value.match(re)){jQuery.datepicker.parseDate('mm/dd/yy',value);resizeVacationsWidget.resize();return true;}else{jQuery.validator.messages.vacationsHotelDate=jQuery.validator.messages.vacationsHotelDate+param.data;resizeVacationsWidget.resize();return false;}}
catch(exception){jQuery.validator.messages.vacationsHotelDate=jQuery.validator.messages.vacationsHotelDate+param.data;resizeVacationsWidget.resize();return false;}},jQuery.validator.messages.vacationsHotelDate);jQuery.validator.messages.vacationsHotelPastDate="Please select future date";jQuery.validator.addMethod("vacationsHotelPastDate",function(value,element){var today=new Date().toDateString();var dateValue=new Date(value).toDateString();if(today!=dateValue){if(new Date().getTime()>new Date(value).getTime()){resizeHotelWidget.resize();return false;}}
resizeVacationsWidget.resize();return true;},jQuery.validator.messages.vacationsHotelPastDate);jQuery.validator.messages.greaterThan="Please select an earlier check-in date or a later check-out date.";jQuery.validator.addMethod("greaterThan",function(value,element,params){if($(params).val()==""||$(params).val()=="mm/dd/yyyy"){return true;}
if(!/Invalid|NaN/.test(new Date(value))){return new Date(value)>new Date($(params).val());}
return isNaN(value)&&isNaN($(params).val())||(parseFloat(value)>parseFloat($(params).val()));},jQuery.validator.messages.greaterThan);jQuery.validator.messages.greaterThanCarDate="Please select an earlier pick-up date or a later drop-off date.";jQuery.validator.addMethod("greaterThanCarDate",function(value,element,params){if($(params).val()==""||$(params).val()=="mm/dd/yyyy"){return true;}
if(!/Invalid|NaN/.test(new Date(value))){return new Date(value)>new Date($(params).val());}
return isNaN(value)&&isNaN($(params).val())||(parseFloat(value)>parseFloat($(params).val()));},jQuery.validator.messages.greaterThanCarDate);jQuery.validator.messages.vacationsTimeGreaterThan="To Time Must be greater than From Time.";jQuery.validator.addMethod("vacationsTimeGreaterThan",function(value,element,params){var flag=true;var fromTimeWithAMOrPM=$(params).val().split(" ");fromTime=fromTimeWithAMOrPM[0];fromTimeAmOrPm=fromTimeWithAMOrPM[1];var toTimeWithAMOrPM=value.split(" ");toTime=toTimeWithAMOrPM[0];toTimeAmOrPm=toTimeWithAMOrPM[1];var fromTimeArr=fromTime.split(":");var fromTimeHour=fromTimeArr[0];var toTimeArr=toTime.split(":");var toTimeHour=toTimeArr[0];var pickUpDt=$('#pickUpDate').val();var dropOffDt=$('#dropOffDate').val();if(pickUpDt=="mm/dd/yyyy"||dropOffDt=="mm/dd/yyyy"){flag=true;}
if(pickUpDt==dropOffDt&&pickUpDt!="mm/dd/yyyy"&&dropOffDt!="mm/dd/yyyy"){flag=Date.parse(pickUpDt+" "+fromTime+" "+fromTimeAmOrPm)<Date.parse(dropOffDt+" "+toTime+" "+toTimeAmOrPm);}
return flag;},jQuery.validator.messages.vacationsTimeGreaterThan);jQuery.validator.messages.vacationsSkymilesNumber="SkyMiles number is not valid. Please check and re-enter.";jQuery.validator.classRuleSettings.vacationsSkymilesNumber={vacationsSkymilesNumber:true};jQuery.validator.addMethod("vacationsSkymilesNumber",function(value,element,param){if(!value.match(/[^\d]/)){if(value!=""&&value.match(/\d{9,12}/)==null){return true;}else{return false;}}
return false;},jQuery.validator.messages.vacationsSkymilesNumber);jQuery.validator.messages.vacationsPromoCode="Promo Code is invalid and needs to be alphanumeric.";jQuery.validator.classRuleSettings.vacationsPromoCode={vacationsPromoCode:true};jQuery.validator.addMethod("vacationsPromoCode",function(value,element,param){if(value!=""){if(value.match(/^[a-z0-9]+$/i)&&value.length<=10)
return true;else
return false;}
return true;},jQuery.validator.messages.vacationsPromoCode);jQuery.validator.messages.vacationsAdultChildCountMatch="Adult and Child count does not match with search.";jQuery.validator.classRuleSettings.vacationsAdultChildCountMatch={vacationsAdultChildCountMatch:true};jQuery.validator.addMethod("vacationsAdultChildCountMatch",function(value,element,param){var formIdentifier=param.formIdentifier;var formType=param.formType;var formName=formIdentifier+"SearchForm";var formContainer="#"+formIdentifier+"VacationExpandedSearchContainer ";var adultCountSearch=parseInt($("#"+formName+" [name='travelersAdults']").val());var childCountSearch=parseInt($("#"+formName+" [name='travelersChildren']").val());var roomCountSearch=parseInt($("#"+formName+" [name='numberOfRooms']").val());var adultCountExpanded=0;var childCountExpanded=0;var returnVal=true;if(roomCountSearch>1){for(var i=1;i<=roomCountSearch;i++){adultCountExpanded=adultCountExpanded+parseInt($("#"+formName+" [name='rooms["+(i-1)+"].adultsNumber']").val());childCountExpanded=childCountExpanded+parseInt($("#"+formName+" [name='rooms["+(i-1)+"].childrenNumber']").val());}
if((adultCountSearch!=adultCountExpanded)||(childCountSearch!=childCountExpanded)){returnVal=false;}else{returnVal=true;}}else if(childCountSearch>0){adultCountExpanded=parseInt($("#"+formName+" [name='rooms[0].adultsNumber']").val());childCountExpanded=parseInt($("#"+formName+" [name='rooms[0].childrenNumber']").val());if((adultCountSearch!=adultCountExpanded)||(childCountSearch!=childCountExpanded)){returnVal=false;}else{returnVal=true;}}else{returnVal=true;}
return returnVal;},jQuery.validator.messages.vacationsAdultChildCountMatch);var VacationsAirportValidation={sameValueOrBlank:function(param1,param2){if(param1.toUpperCase()==param2.toUpperCase()){return true;}
return false;},isBlank:function(param1,param2){if(!(((param1=="City or Airport"||$.trim(param1)=="")||param1.length!=3||!(/^[a-z]+$/i.test(param1)))&&((param2=="City or Airport"||$.trim(param2)=="")||param2.length!=3||!(/^[a-z]+$/i.test(param2))))){return false;}
return true;},isHotelLocationBlank:function(param1){if(!(((param1=="City or Airport"||$.trim(param1)=="")||param1.length!=3||!(/^[a-z]+$/i.test(param1))))){return false;}
return true;}};var VacationsDateValidation={maxDaysinFuture:331,todayDate:function(){var dateArr=$("#serverDate").html().split("-");return new Date(dateArr[0],dateArr[1],dateArr[2]);},minDate:function(){return new Date(VacationsDateValidation.todayDate().getFullYear(),VacationsDateValidation.todayDate().getMonth(),VacationsDateValidation.todayDate().getDate());},maxDate:function(){return new Date(VacationsDateValidation.minDate().getTime()+VacationsDateValidation.maxDaysinFuture*24*60*60*1000);},formatCheck:function(value){var re=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(re.test(value)){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if((xdata.getFullYear()==aaaa)&&(xdata.getMonth()==mm-1)&&(xdata.getDate()==gg)){return false;}else{return true;}}else
return true;},rangeCheck:function(value){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if(xdata.getTime()<VacationsDateValidation.minDate().getTime()||xdata.getTime()>VacationsDateValidation.maxDate().getTime()){return true;}else{return false;}},maxRangeCheck:function(value){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if(xdata.getTime()>VacationsDateValidation.maxDate().getTime()){return true;}else{return false;}},minRangeCheck:function(value){var adata=value.split('/');var gg=parseInt(adata[1],10);var mm=parseInt(adata[0],10);var aaaa=parseInt(adata[2],10);var xdata=new Date(aaaa,mm-1,gg);if(xdata.getTime()<VacationsDateValidation.minDate().getTime()){return true;}else{return false;}},returnCheck:function(){var depdata=$('#vacationsdepartureDate').val().split('/');var retdata=$('#vacationsreturnDate').val().split('/');if(VacationsDateValidation.formatCheck($('#vacationsdepartureDate').val())||VacationsDateValidation.formatCheck($('#vacationsreturnDate').val())){return false;}
var depgg=parseInt(depdata[1],10);var depmm=parseInt(depdata[0],10);var depaaaa=parseInt(depdata[2],10);var xdepdata=new Date(depaaaa,depmm-1,depgg);var retgg=parseInt(retdata[1],10);var retmm=parseInt(retdata[0],10);var retaaaa=parseInt(retdata[2],10);var xretdata=new Date(retaaaa,retmm-1,retgg);if(xdepdata.getTime()>xretdata.getTime()){return true;}else{return false;}},formatDate:function(value){if(!this.isValidateDate(value)){return value;}
var convertDate=this.formatYear(value);return convertDate;},isValidateDate:function(dateValue){var objRegExp=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{2,4}$/;if(!objRegExp.test(dateValue)){return false;}
return true;},formatYear:function(strInput){var strYear;var strRetVal=strInput;strYear=strInput.substr(strInput.lastIndexOf("\/")+1);if(strYear.length==2){strYear=parseInt(strYear)+2000;strRetVal=""+strInput.substring(0,(strInput.lastIndexOf("\/")+1))+strYear;}
return strRetVal;},blankDateCheck:function(departureDateField,returnDateField){var departDate=$("input#"+departureDateField).val();var returnDate=$("input#"+returnDateField).val();if(!((departDate=="Depart Date"||$.trim(departDate)=="")&&(returnDate=="Return Date"||$.trim(returnDate)==""))){return false;}
return true;}};var delta=delta||{};delta.widgetnav=delta.widgetnav||{};delta.widgetnav.vacations={delayForFormSubmission:100,tmpSearchVal:null,submitDelayedForm:function(form){form.submit();},recentSearchesStored:false,fetchedRecentSearchesData:null,isErrorHeightReset:false,loadRecentSearches:function(key){try{var myPrefillData={prefillAttribute:key};var callMetaData={callback:this.storeRecentSearches};prefill.retrievePrefillData(myPrefillData,callMetaData);}catch(error){prefillError(error);}},init:function(){delta.widgetnav.vacations.initialiseDateLookup_FlightHotelWidget();delta.widgetnav.vacations.uiBehaviours();delta.widgetnav.vacations.loadRecentSearches("vacationFlightHotelSearches");},uiBehaviours:function(){delta.widgetnav.vacations.searchTabSelectEvent();delta.widgetnav.vacations.flightHotel_RoomsChangeEvent();delta.widgetnav.vacations.hotelCar_RoomsChangeEvent();delta.widgetnav.vacations.flightHotel_ChildCountChangeEvent();delta.widgetnav.vacations.flightCar_ChildCountChangeEvent();delta.widgetnav.vacations.hotelCar_ChildCountChangeEvent();delta.widgetnav.vacations.flightHotel_ExpandedChildCountChangeEvent();delta.widgetnav.vacations.hotelCar_ExpandedChildCountChangeEvent();delta.widgetnav.vacations.flightCar_ExpandedChildCountChangeEvent();delta.widgetnav.vacations.roomChangeEvent();delta.widgetnav.vacations.promoCodeDataChangeEvent();delta.widgetnav.vacations.flightCar_promoCodeDataChangeEvent();delta.widgetnav.vacations.hotelCar_promoCodeDataChangeEvent();$("#flightHotelSearchForm").validate({errorLabelContainer:"#vacations-flightHotelSearch-errorMsg",errorClass:"spc_err_msg",errorElement:"div",groups:{countCheckGroup:"travelersAdults travelersChildren numberOfRooms"},rules:{"fromAirport":{vacationsRequiredFromCity:['input[name="toAirport"]']},"toAirport":{vacationsRequiredToCity:['input[name="fromAirport"]']},"departureDate":{vacationsRequiredStartDate:{"departureDateField":"vacationsdepartureDate","returnDateField":"vacationsreturnDate"},maxlength:false},"returnDate":{vacationsRequiredReturnDate:{"departureDateField":"vacationsdepartureDate","returnDateField":"vacationsreturnDate"},maxlength:false},"promoCode":{vacationsPromoCode:true},"skyMilesNumber":{vacationsSkymilesNumber:true},"travelersAdults":{vacationsAdultChildCountMatch:{"formIdentifier":"flightHotel","formType":""}}},showErrors:function(){this.defaultShowErrors();if($("#flightHotelVacationExpandedSearchContainer").css('display')!='none')
{delta.widgetnav.vacations.resetHeightOnError("flightHotel");}},submitHandler:function(flightHotelSearchForm){if($("#flightHotelAdvSearchClk").val().toLowerCase()!="y")
{delta.widgetnav.vacations.saveRecentSearchesData();setTimeout(function(){delta.widgetnav.vacations.submitDelayedForm(flightHotelSearchForm);},delta.widgetnav.vacations.delayForFormSubmission);}else{setTimeout(function(){delta.widgetnav.vacations.submitDelayedForm(flightHotelSearchForm);},delta.widgetnav.vacations.delayForFormSubmission);}}});$("#flightCarSearchForm").validate({errorLabelContainer:"#vacations-flightCarSearch-errorMsg",errorClass:"spc_err_msg",errorElement:"div",groups:{countCheckGroup:"travelersAdults travelersChildren"},rules:{"fromAirport":{vacationsRequiredFromCity:['input[name="toAirport"]']},"toAirport":{vacationsRequiredToCity:['input[name="fromAirport"]']},"departureDate":{vacationsRequiredStartDate:{"departureDateField":"flightCarVacationsdepartureDate","returnDateField":"flightCarVacationsreturnDate"},maxlength:false},"returnDate":{vacationsRequiredReturnDate:{"departureDateField":"flightCarVacationsdepartureDate","returnDateField":"flightCarVacationsreturnDate"},maxlength:false},"promoCode":{vacationsPromoCode:true},"skyMilesNumber":{vacationsSkymilesNumber:true},"travelersAdults":{vacationsAdultChildCountMatch:{"formIdentifier":"flightCar","formType":"_flightCar"}}},showErrors:function(){this.defaultShowErrors();if($("#flightCarVacationExpandedSearchContainer").css('display')!='none')
{delta.widgetnav.vacations.resetHeightOnError("flightCar");}},submitHandler:function(flightCarSearchForm){if($("#flightCarAdvSearchClk").val().toLowerCase()!="y"){delta.widgetnav.vacations.saveRecentSearchesData();setTimeout(function(){delta.widgetnav.vacations.submitDelayedForm(flightCarSearchForm);},delta.widgetnav.vacations.delayForFormSubmission);}else{setTimeout(function(){delta.widgetnav.vacations.submitDelayedForm(flightCarSearchForm);},delta.widgetnav.vacations.delayForFormSubmission);}}});$("#hotelCarSearchForm").validate({errorLabelContainer:"#vacations-hotelCarSearch-errorMsg",errorClass:"spc_err_msg",errorElement:"div",groups:{countCheckGroup:"travelersAdults travelersChildren numberOfRooms"},rules:{"fromAirport":{vacationsRequiredHotelLocation:true},"departureDate":{vacationsHotelDate:{data:"Check-in Date"},vacationsHotelPastDate:true},"returnDate":{vacationsHotelDate:{data:"Check-out Date"},vacationsHotelPastDate:true,greaterThan:"#hotelCheckInDate"},"promoCode":{vacationsPromoCode:true},"skyMilesNumber":{vacationsSkymilesNumber:true},"travelersAdults":{vacationsAdultChildCountMatch:{"formIdentifier":"hotelCar","formType":"_hotelCar"}}},showErrors:function(){this.defaultShowErrors();if($("#hoteltCarVacationExpandedSearchContainer").css('display')!='none')
{delta.widgetnav.vacations.resetHeightOnError("hotelCar");}},submitHandler:function(hotelCarSearchForm){if($("#hotelCarAdvSearchClk").val().toLowerCase()!="y")
{delta.widgetnav.vacations.saveRecentSearchesData();setTimeout(function(){delta.widgetnav.vacations.submitDelayedForm(hotelCarSearchForm);},delta.widgetnav.vacations.delayForFormSubmission);}else{setTimeout(function(){delta.widgetnav.vacations.submitDelayedForm(hotelCarSearchForm);},delta.widgetnav.vacations.delayForFormSubmission);}}});$(document).off("click",".vacations-recent-search-arrow").on("click",".vacations-recent-search-arrow",function(){if($("#vacationsRecentSearchesBox").css("display")=="none"){delta.widgetnav.vacations.populateSearchCriteria("vacationFlightHotelSearches");delta.widgetnav.vacations.hidePopups();$("#vacationsRecentSearchesBox").slideDown(300,function(){});$('#vacartionsRecentSearchArrow').css({'border-bottom-color':'#fff','background-color':'#fff'});delta.widgetnav.vacations.showSearch();$(window).scroll(function(){delta.widgetnav.vacations.hideSearchDiv();});}else{$("#vacationsRecentSearchesBox").slideUp(300);$('#vacartionsRecentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});}});$(document).on('click','li.vacationsRecentInput',function(){var search=this.id;var searchDetailsArr=search.split("|");var searchType=searchDetailsArr[0];var formContainer="";if(searchType=='flightHotelVacationSearch'){delta.widgetnav.vacations.flightHotel_RecentSearchSelection(searchDetailsArr);}else if(searchType=='flightCarVacationSearch'){delta.widgetnav.vacations.flightCar_RecentSearchesSelection(searchDetailsArr);}else{delta.widgetnav.vacations.hotelCar_RecentSearchSelection(searchDetailsArr);}});$("#flightHotelAdvSearch,#flightHotelAdvSearchExp").on("click",function(){$("#flightHotelSearchForm").validate().cancelSubmit=true;$("#flightHotelAdvSearchClk").val("Y");var hostName=window.location.hostname;var actionURL="";actionURL="https://"+hostName+"/vacations/searchAction.action";$("#flightHotelSearchForm").attr("action",actionURL);$("#flightHotelSearchForm").submit();});$("#flightCarAdvSearch,#flightCarAdvSearchExp").on("click",function(){$("#flightCarSearchForm").validate().cancelSubmit=true;$("#flightCarAdvSearchClk").val("Y");var hostName=window.location.hostname;var actionURL="";if(hostName=="localhost")
actionURL="https://"+hostName+"/vacations/searchAction.action";$("#flightCarSearchForm").attr("action",actionURL);$("#flightCarSearchForm").submit();});$("#hotelCarAdvSearch,#hotelCarAdvSearchExp").on("click",function(){$("#hotelCarSearchForm").validate().cancelSubmit=true;$("#hotelCarAdvSearchClk").val("Y");var hostName=window.location.hostname;var actionURL="";if(hostName=="localhost")
actionURL="https://"+hostName+"/vacations/searchAction.action";$("#hotelCarSearchForm").attr("action",actionURL);$("#hotelCarSearchForm").submit();});},initialiseDateLookup_FlightHotelWidget:function(){$(document).on('click','.flightHotelDateContainer #depDateCalIcon',function(){$("#vacationsdepartureDate").trigger("focus");});$(document).on('click','.flightHotelDateContainer #returnDateCalIcon',function(){$("#vacationsdepartureDate").trigger("focus");});delta.widgetnav.vacations.setVacationCalendarControl("vacationsdepartureDate","vacationsreturnDate","Depart Date","Return Date","flightHotelDateContainer");$("#fromAirport").autocomplete({airportId:"fromAirport",source:AirportPredictions.airportPredictionHandler});$("#toAirport").autocomplete({airportId:"toAirport",source:AirportPredictions.airportPredictionHandler});$('#fromCityLookup').click(function(){AirportPredictions.getList("","sourceAirport","fromAirport");return false;});$('#toCityLookup').click(function(){AirportPredictions.getList("","destAirport","toAirport");return false;});},initialiseDateLookup_FlightCarWidget:function(){$("#flightCarFromAirport").autocomplete({airportId:"flightCarFromAirport",source:AirportPredictions.airportPredictionHandler});$("#flightCarToAirport").autocomplete({airportId:"flightCarToAirport",source:AirportPredictions.airportPredictionHandler});$('#flightCarFromCityLookup').click(function(){AirportPredictions.getList("","sourceAirport","flightCarFromAirport");return false;});$('#flightCarToCityLookup').click(function(){AirportPredictions.getList("","destAirport","flightCarToAirport");return false;});$(document).on('click','.flightCarDateContainer #flightCarDepDateCalIcon',function(){$("#flightCarVacationsdepartureDate").trigger("focus");});$(document).on('click','.flightCarDateContainer #flightCarReturnDateCalIcon',function(){$("#flightCarVacationsdepartureDate").trigger("focus");});delta.widgetnav.vacations.setVacationCalendarControl("flightCarVacationsdepartureDate","flightCarVacationsreturnDate","Depart Date","Return Date","flightCarDateContainer");},initialiseDateLookup_HotelCarWidget:function(){$("#vacationHotelLocation").autocomplete({airportId:"flightCarFromAirport",source:AirportPredictions.airportPredictionHandler});$(document).on('click','.hotelCarDateContainer #checkInCalIcon',function(){$("#hotelCheckInDate").trigger("focus");});$('#hotelLocationLookup').click(function(){AirportPredictions.getList("","sourceAirport","vacationHotelLocation");return false;});$(document).on('click','.hotelCarDateContainer #checkOutCalIcon',function(){$("#hotelCheckInDate").trigger("focus");});delta.widgetnav.vacations.setVacationCalendarControl("hotelCheckInDate","hotelCheckOutDate","Depart Date","Return Date","hotelCarDateContainer");},searchTabSelectEvent:function(){$("ul.tabHolder li").on("click",function(){var id=this.id;var selectedTabId=$("ul.tabHolder").find("li.active")[0].id;$("#"+selectedTabId).removeClass("active");$("#"+id).addClass("active");if(selectedTabId!=id)
{if(id=="flightHotelTab")
{var formContainer="#flightHotelVacationExpandedSearchContainer ";if($("#delta-vacations-expanded-tabs").css("display")!="none"){$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#hotelCarVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");delta.widgetnav.vacations.collapseHotelCarWidget();$("#flightCarVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_flightCar");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_flightCar");delta.widgetnav.vacations.collapseFlightCarWidget();$("#delta-vacations-expanded-tabs ul").removeClass("noRoomExpandedTab");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");}
$("#flightHotelVacationSearchContainer").show();$("#flightCarVacationSearchContainer").hide();$("#hotelCarVacationSearchContainer").hide();$("#adultCount").val("1");$("#childCount").val("0");$("#numberOfRooms").val("1");delta.widgetnav.vacations.fetchedRecentSearchesData=null;delta.widgetnav.vacations.recentSearchesStored=false;delta.widgetnav.vacations.loadRecentSearches("vacationFlightHotelSearches");$("div#vacations-flightHotelSearch-errorMsg div.spc_err_msg").html("");$("div#vacations-flightHotelSearch-errorMsg").hide();$("div#dlv-errormessage-search").html("");$("div#dlv-errormessage-search").hide();delta.widgetnav.vacations.isErrorHeightReset=false;delta.widgetnav.vacations.initialiseDateLookup_FlightHotelWidget();}else if(id=="flightCarTab"){var formContainer="#flightCarVacationExpandedSearchContainer ";if($("#delta-vacations-expanded-tabs").css("display")!="none")
{$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#hotelCarVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");delta.widgetnav.vacations.collapseHotelCarWidget();$("#flightHotelVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseFlightHotelWidget();$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");}
$("#flightHotelVacationSearchContainer").hide();$("#flightCarVacationSearchContainer").show();$("#hotelCarVacationSearchContainer").hide();$("#flightCarAdultCount").val("1");$("#flightCarChildCount").val("0");delta.widgetnav.vacations.fetchedRecentSearchesData=null;delta.widgetnav.vacations.recentSearchesStored=false;delta.widgetnav.vacations.loadRecentSearches("vacationFlightCarSearches");$("div#vacations-flightCarSearch-errorMsg div.spc_err_msg").html("");$("div#vacations-flightCarSearch-errorMsg").hide();$("div#dlv-errormessage-search").html("");$("div#dlv-errormessage-search").hide();delta.widgetnav.vacations.isErrorHeightReset=false;delta.widgetnav.vacations.initialiseDateLookup_FlightCarWidget();}else{var formContainer="#hotelCarVacationExpandedSearchContainer ";if($("#delta-vacations-expanded-tabs").css("display")!="none"){$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#flightCarVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_flightCar");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_flightCar");delta.widgetnav.vacations.collapseFlightCarWidget();$("#flightHotelVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseFlightHotelWidget();$("#delta-vacations-expanded-tabs ul").removeClass("noRoomExpandedTab");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");}
$("#flightHotelVacationSearchContainer").hide();$("#flightCarVacationSearchContainer").hide();$("#hotelCarVacationSearchContainer").show();$("#travelerAdultCount").val("1");$("#travelerChildCount").val("0");$("#hotelNumberOfRooms").val("1");delta.widgetnav.vacations.fetchedRecentSearchesData=null;delta.widgetnav.vacations.recentSearchesStored=false;delta.widgetnav.vacations.loadRecentSearches("vacationHotelCarSearches");$("div#vacations-hotelCarSearch-errorMsg div.spc_err_msg").html("");$("div#vacations-hotelCarSearch-errorMsg").hide();$("div#dlv-errormessage-search").html("");$("div#dlv-errormessage-search").hide();delta.widgetnav.vacations.isErrorHeightReset=false;delta.widgetnav.vacations.initialiseDateLookup_HotelCarWidget();}}});},flightHotel_RoomsChangeEvent:function(){$("#numberOfRooms").on("change",function(){var roomCount=$("#numberOfRooms").val();var formContainer="#flightHotelVacationExpandedSearchContainer ";if(roomCount>1){delta.widgetnav.vacations.expandFlightHotelWidget();$(formContainer+"#hiddenAdultCount").val("1");$(formContainer+"#childCount").val("0");var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs(roomCount);if(selectedTab<parseInt(roomCount)){for(var k=1;k<=4;k++){if(selectedTab!=k)
{$(formContainer+"#roomGuestLeftContainer"+k).hide();$(formContainer+"#childCountRightContainer"+k).hide();}}}else{delta.widgetnav.vacations.hideRemovedRoomDetails(roomCount,formContainer,"");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");}
delta.widgetnav.vacations.setExpandedWidgetContainerHeight();}else{$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#flightHotelVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseFlightHotelWidget();}});},hotelCar_RoomsChangeEvent:function(){$("#hotelNumberOfRooms").on("change",function(){var roomCount=$("#hotelNumberOfRooms").val();var formContainer="#hotelCarVacationExpandedSearchContainer ";if(roomCount>1){delta.widgetnav.vacations.expandHotelCarWidget();$(formContainer+"#hiddenAdultCount").val("1");$(formContainer+"#childCount").val("0");var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs(roomCount);if(selectedTab<parseInt(roomCount)){for(var k=1;k<=4;k++){if(selectedTab!=k)
{$(formContainer+"#roomGuestLeftContainer"+k+"_hotelcar").hide();$(formContainer+"#childCountRightContainer"+k+"_hotelcar").hide();}}}else{delta.widgetnav.vacations.hideRemovedRoomDetails(roomCount,formContainer,"_hotelCar");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");}
delta.widgetnav.vacations.setExpandedWidgetContainerHeight();}else{$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#hotelCarVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");delta.widgetnav.vacations.collapseHotelCarWidget();}});},flightHotel_ChildCountChangeEvent:function(){$("#childCount").on("change",function(){var selectedChildCount=$("#childCount").val();var numberOfRooms=parseInt($("#numberOfRooms").val());var formContainer="#flightHotelVacationExpandedSearchContainer ";if(numberOfRooms==1){if(selectedChildCount>0){delta.widgetnav.vacations.expandFlightHotelWidget();var roomCount=1;delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs(roomCount);$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+roomCount).parent().addClass("lastVacationsRoomTab");for(var k=2;k<=4;k++){$("#roomGuestLeftContainer"+k).hide();$("#childCountRightContainer"+k).hide();}
$("#hiddenchildrenNumber1").val(selectedChildCount);var currentRoomId=1;var prevRoomChildCount=0;for(var i=1;i<=8;i++){if($("#child_"+currentRoomId+"_"+i+"AgeDiv").css("display")!="none")
prevRoomChildCount=prevRoomChildCount+1;$("#child_"+currentRoomId+"_"+i+"AgeDiv").hide();}
$("#childCountRightContainer"+currentRoomId).show();if(prevRoomChildCount<selectedChildCount){for(var i=1;i<=selectedChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv").show();}}else{for(var i=1;i<=selectedChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv").show();}
for(var i=(parseInt(selectedChildCount)+1);i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age").val("1");}}
delta.widgetnav.vacations.resetExpandedWidgetContainerHeight(formContainer,"");}else{delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseFlightHotelWidget();}}});},hotelCar_ChildCountChangeEvent:function(){$("#travelerChildCount").on("change",function(){var selectedChildCount=$("#travelerChildCount").val();var formContainer="#hotelCarVacationExpandedSearchContainer ";var hotelNumberOfRooms=parseInt($("#hotelNumberOfRooms").val());if(hotelNumberOfRooms==1)
{if(selectedChildCount>0){delta.widgetnav.vacations.expandHotelCarWidget();var roomCount=1;delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs(roomCount);$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+roomCount).parent().addClass("lastVacationsRoomTab");for(var k=2;k<=4;k++){$(formContainer+"#roomGuestLeftContainer"+k+"_hotelCar").hide();$(formContainer+"#childCountRightContainer"+k+"_hotelCar").hide();}
$("#hiddenchildrenNumber1_hotelCar").val(selectedChildCount);var currentRoomId=1;var prevRoomChildCount=0;for(var i=1;i<=8;i++){if($("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_hotelCar").css("display")!="none")
prevRoomChildCount=prevRoomChildCount+1;$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_hotelCar").hide();}
$("#childCountRightContainer"+currentRoomId+"_hotelCar").show();if(prevRoomChildCount<selectedChildCount){for(var i=1;i<=selectedChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_hotelCar").show();}}else{for(var i=1;i<=selectedChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_hotelCar").show();}
for(var i=(parseInt(selectedChildCount)+1);i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age"+"_hotelCar").val("1");}}
delta.widgetnav.vacations.setExpandedWidgetContainerHeight();}else{delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");delta.widgetnav.vacations.collapseHotelCarWidget();}}});},flightCar_ChildCountChangeEvent:function(){$("#flightCarChildCount").change(function(){var selectedChildCount=$("#flightCarChildCount").val();var formContainer="#flightCarVacationExpandedSearchContainer ";if(selectedChildCount>0){delta.widgetnav.vacations.expandFlightCarWidget();var roomCount=1;delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.hideExpandedTabName();for(var k=2;k<=4;k++){$("#roomGuestLeftContainer"+k+"_flightCar").hide();$("#childCountRightContainer"+k+"_flightCar").hide();}
$("#hiddenchildrenNumber1_flightCar").val(selectedChildCount);var currentRoomId=1;var prevRoomChildCount=0;for(var i=1;i<=8;i++){if($("#child_"+currentRoomId+"_"+i+"AgeDiv_flightCar").css("display")!="none")
prevRoomChildCount=prevRoomChildCount+1;$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").hide();}
$("#childCountRightContainer"+currentRoomId+"_flightCar").show();if(prevRoomChildCount<selectedChildCount){for(var i=1;i<=selectedChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").show();}}else{for(var i=1;i<=selectedChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").show();}
for(var i=(parseInt(selectedChildCount)+1);i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age"+"_flightCar").val("1");}}
delta.widgetnav.vacations.resetExpandedWidgetContainerHeight(formContainer,"_flightCar");}else{delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_flightCar");delta.widgetnav.vacations.collapseFlightCarWidget();}});},flightHotel_ExpandedChildCountChangeEvent:function(){$("#flightHotelVacationExpandedSearchContainer select[id^='hiddenchildrenNumber']").on("change",function(){var roomChildCount=this.value;var currentRoomId=this.id.replace("hiddenchildrenNumber","");if(roomChildCount>0){var prevRoomChildCount=0;for(var i=1;i<=8;i++){if($("#child_"+currentRoomId+"_"+i+"AgeDiv").css("display")!="none")
prevRoomChildCount=prevRoomChildCount+1;$("#child_"+currentRoomId+"_"+i+"AgeDiv").hide();}
$("#childCountRightContainer"+currentRoomId).show();if(prevRoomChildCount!=0){if(prevRoomChildCount<roomChildCount){for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv").show();}}else{for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv").show();}
for(var i=(parseInt(roomChildCount)+1);i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age").val("1");}}}else{for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv").show();}}
delta.widgetnav.vacations.resetExpandedWidgetContainerHeight("#flightHotelVacationExpandedSearchContainer ","");}else{for(var i=1;i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age").val("1");}
$("#childCountRightContainer"+currentRoomId).hide();}});},hotelCar_ExpandedChildCountChangeEvent:function(){$("#hotelCarVacationExpandedSearchContainer select[id^='hiddenchildrenNumber']").on("change",function(){var roomChildCount=this.value;var currentRoomId=this.id.replace("hiddenchildrenNumber","").replace("_hotelCar","");if(roomChildCount>0){var prevRoomChildCount=0;for(var i=1;i<=8;i++){if($("#child_"+currentRoomId+"_"+i+"AgeDiv_hotelCar").css("display")!="none")
prevRoomChildCount=prevRoomChildCount+1;$("#child_"+currentRoomId+"_"+i+"AgeDiv_hotelCar").hide();}
$("#childCountRightContainer"+currentRoomId+"_hotelCar").show();if(prevRoomChildCount!=0){if(prevRoomChildCount<roomChildCount){for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv_hotelCar").show();}}else{for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv_hotelCar").show();}
for(var i=(parseInt(roomChildCount)+1);i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age_hotelCar").val("1");}}}else{for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv_hotelCar").show();}}}else{for(var i=1;i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age_hotelCar").val("1");}
$("#childCountRightContainer"+currentRoomId+"_hotelCar").hide();}});},flightCar_ExpandedChildCountChangeEvent:function(){$("#flightCarVacationExpandedSearchContainer select[id^='hiddenchildrenNumber']").on("change",function(){var roomChildCount=this.value;var currentRoomId=this.id.replace("hiddenchildrenNumber","").replace("_flightCar","");if(roomChildCount>0){var prevRoomChildCount=0;for(var i=1;i<=8;i++){if($("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").css("display")!="none")
prevRoomChildCount=prevRoomChildCount+1;$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").hide();}
$("#childCountRightContainer"+currentRoomId+"_flightCar").show();if(prevRoomChildCount!=0){if(prevRoomChildCount<roomChildCount){for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").show();}}else{for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").show();}
for(var i=(parseInt(roomChildCount)+1);i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age"+"_flightCar").val("1");}}}else{for(var i=1;i<=roomChildCount;i++){$("#child_"+currentRoomId+"_"+i+"AgeDiv"+"_flightCar").show();}}
delta.widgetnav.vacations.resetExpandedWidgetContainerHeight("#flightCarVacationExpandedSearchContainer ","_flightCar");}else{for(var i=1;i<=8;i++){$("#child_"+currentRoomId+"_"+i+"Age"+"_flightCar").val("1");}
$("#childCountRightContainer"+currentRoomId+"_flightCar").hide();}});},roomChangeEvent:function(){$(".vacationRooms").on("click",function(){var selectedRoomId=this.id.replace("vacationsRoom","");var formContainer="";var formType="";var selectedTabId=$("ul.tabHolder").find("li.active")[0].id;if(selectedTabId=="flightHotelTab"){formContainer="#flightHotelVacationExpandedSearchContainer ";}else if(selectedTabId=="flightCarTab"){formContainer="#flightCarVacationExpandedSearchContainer ";formType="_flightCar";}else{formContainer="#hotelCarVacationExpandedSearchContainer ";formType="_hotelCar";}
delta.widgetnav.vacations.roomTabHandlerFunction(selectedRoomId,formContainer,formType);});},flightHotel_RecentSearchSelection:function(searchDetailsArr){formContainer="#flightHotelVacationExpandedSearchContainer ";var departurenCity=searchDetailsArr[1];var arrivalCity=searchDetailsArr[2];var departureDate=searchDetailsArr[3];var arrivalDate=searchDetailsArr[4];var roomCount=parseInt(searchDetailsArr[5]);var adultCount=parseInt(searchDetailsArr[6]);var childCount=parseInt(searchDetailsArr[7]);$("form#flightHotelSearchForm #fromAirport").val(departurenCity);$("form#flightHotelSearchForm #toAirport").val(arrivalCity);$("form#flightHotelSearchForm #vacationsdepartureDate").val(departureDate);$("form#flightHotelSearchForm #vacationsreturnDate").val(arrivalDate);$("form#flightHotelSearchForm #numberOfRooms").val(roomCount);$("form#flightHotelSearchForm #adultCount").val(adultCount);$("form#flightHotelSearchForm #childCount").val(childCount);if(roomCount>1){delta.widgetnav.vacations.activateExpandedWidget_roomCount_flightHotel(formContainer,roomCount,searchDetailsArr);}else if(childCount>0){delta.widgetnav.vacations.activateExpandedWidget_childCount_flightHotel(formContainer,searchDetailsArr);}else if($("#delta-vacations-expanded-tabs").css("display")!='none'){$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#flightHotelVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseFlightHotelWidget();}
delta.widgetnav.vacations.hideSearchDiv();},activateExpandedWidget_roomCount_flightHotel:function(formContainer,roomCount,searchDetailsArr){$("#flightHotelVacationExpandedSearchContainer").removeAttr("style");delta.widgetnav.vacations.expandFlightHotelWidget();$("#hiddenAdultCount").val("1");var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs(""+roomCount);delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");var roomCounter=1;for(var j=8;j<8+roomCount;j++){var roomDetails=searchDetailsArr[j];var roomDetailsArr=roomDetails.split("~");var perRoomAdultNo=roomDetailsArr[0];$("#hiddenAdultCount"+roomCounter).val(perRoomAdultNo);var perRoomChildCount=roomDetailsArr[1];$("#hiddenchildrenNumber"+roomCounter).val(perRoomChildCount);delta.widgetnav.vacations.setExpandedWidgetContainerHeight();if(perRoomChildCount>0)
{$("#childCountRightContainer"+roomCounter).show();var perChildAgeSeatOptionDetails=roomDetailsArr[2];var perChildAgeSeatOptionDetailsArr=perChildAgeSeatOptionDetails.split("_");for(var k=0;k<perChildAgeSeatOptionDetailsArr.length;k++){if(perChildAgeSeatOptionDetailsArr[k]!=""){$("#child_"+roomCounter+"_"+(k+1)+"AgeDiv").show();$("#child_"+roomCounter+"_"+(k+1)+"Age").val(perChildAgeSeatOptionDetailsArr[k]);}}}
roomCounter++;}
delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");},activateExpandedWidget_childCount_flightHotel:function(formContainer,searchDetailsArr){$("#flightHotelVacationExpandedSearchContainer").removeAttr("style");delta.widgetnav.vacations.expandFlightHotelWidget();var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs("1");delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");var roomCounter=1;var roomDetails=searchDetailsArr[8];var roomDetailsArr=roomDetails.split("~");var perRoomAdultNo=roomDetailsArr[0];$("#hiddenAdultCount"+roomCounter).val(perRoomAdultNo);var perRoomChildCount=roomDetailsArr[1];$("#hiddenchildrenNumber"+roomCounter).val(perRoomChildCount);delta.widgetnav.vacations.setExpandedWidgetContainerHeight();if(perRoomChildCount>0)
{$("#childCountRightContainer"+roomCounter).show();var perChildAgeSeatOptionDetails=roomDetailsArr[2];var perChildAgeSeatOptionDetailsArr=perChildAgeSeatOptionDetails.split("_");for(var k=0;k<perChildAgeSeatOptionDetailsArr.length;k++){if(perChildAgeSeatOptionDetailsArr[k]!=""){$("#child_"+roomCounter+"_"+(k+1)+"AgeDiv").show();$("#child_"+roomCounter+"_"+(k+1)+"Age").val(perChildAgeSeatOptionDetailsArr[k]);}}}
delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");},flightCar_RecentSearchesSelection:function(searchDetailsArr){formContainer="#flightCarVacationExpandedSearchContainer ";var departurenCity=searchDetailsArr[1];var arrivalCity=searchDetailsArr[2];var departureDate=searchDetailsArr[3];var arrivalDate=searchDetailsArr[4];var adultCount=parseInt(searchDetailsArr[5]);var childCount=parseInt(searchDetailsArr[6]);$("form#flightCarSearchForm #flightCarFromAirport").val(departurenCity);$("form#flightCarSearchForm #flightCarToAirport").val(arrivalCity);$("form#flightCarSearchForm #flightCarVacationsdepartureDate").val(departureDate);$("form#flightCarSearchForm #flightCarVacationsreturnDate").val(arrivalDate);$("form#flightCarSearchForm #flightCarAdultCount").val(adultCount);$("form#flightCarSearchForm #flightCarChildCount").val(childCount);if(childCount>0){delta.widgetnav.vacations.activateExpandedWidget_childCount_flightCar(formContainer,searchDetailsArr);}else if($("#delta-vacations-expanded-tabs").css("display")!='none'){$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#flightHotelVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseFlightHotelWidget();}
delta.widgetnav.vacations.hideSearchDiv();},activateExpandedWidget_childCount_flightCar:function(formContainer,searchDetailsArr){$("#flightCarVacationExpandedSearchContainer").removeAttr("style");delta.widgetnav.vacations.expandFlightCarWidget();var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.hideExpandedTabName();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_flightCar");var roomCounter=1;var roomDetails=searchDetailsArr[7];var roomDetailsArr=roomDetails.split("~");var perRoomAdultNo=roomDetailsArr[0];$("#hiddenAdultCount"+roomCounter+"_flightCar").val(perRoomAdultNo);var perRoomChildCount=roomDetailsArr[1];$("#hiddenchildrenNumber"+roomCounter+"_flightCar").val(perRoomChildCount);delta.widgetnav.vacations.setExpandedWidgetContainerHeight();if(perRoomChildCount>0)
{$("#childCountRightContainer"+roomCounter+"_flightCar").show();var perChildAgeSeatOptionDetails=roomDetailsArr[2];var perChildAgeSeatOptionDetailsArr=perChildAgeSeatOptionDetails.split("_");for(var k=0;k<perChildAgeSeatOptionDetailsArr.length;k++){if(perChildAgeSeatOptionDetailsArr[k]!=""){$("#child_"+roomCounter+"_"+(k+1)+"AgeDiv"+"_flightCar").show();$("#child_"+roomCounter+"_"+(k+1)+"Age"+"_flightCar").val(perChildAgeSeatOptionDetailsArr[k]);}}}
delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_flightCar");},hotelCar_RecentSearchSelection:function(searchDetailsArr){formContainer="#hotelCarVacationExpandedSearchContainer ";var hotelLocation=searchDetailsArr[1];var hotelLocationCode=searchDetailsArr[2];var hotelLocationType=searchDetailsArr[3];var checkInDate=searchDetailsArr[4];var checkOutDate=searchDetailsArr[5];var roomCount=parseInt(searchDetailsArr[6]);var adultCount=parseInt(searchDetailsArr[7]);var childCount=parseInt(searchDetailsArr[8]);$("form#hotelCarSearchForm #vacationHotelLocation").val(hotelLocation);$("form#hotelCarSearchForm #vacationsHotelLocationCodeWidget").val(hotelLocationCode);$("form#hotelCarSearchForm #vacationsHotelLocationTypeWidget").val(hotelLocationType);$("form#hotelCarSearchForm #hotelCheckInDate").val(checkInDate);$("form#hotelCarSearchForm #hotelCheckOutDate").val(checkOutDate);$("form#hotelCarSearchForm #travelerAdultCount").val(adultCount);$("form#hotelCarSearchForm #travelerChildCount").val(childCount);$("form#hotelCarSearchForm #hotelNumberOfRooms").val(roomCount);if(roomCount>1){$("#flightHotelVacationExpandedSearchContainer").removeAttr("style");delta.widgetnav.vacations.expandHotelCarWidget();var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs(""+roomCount);delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");var roomCounter=1;for(var j=9;j<9+roomCount;j++){var roomDetails=searchDetailsArr[j];var roomDetailsArr=roomDetails.split("~");var perRoomAdultNo=roomDetailsArr[0];$("#hiddenAdultCount"+roomCounter+"_hotelCar").val(perRoomAdultNo);var perRoomChildCount=roomDetailsArr[1];$("#hiddenchildrenNumber"+roomCounter+"_hotelCar").val(perRoomChildCount);delta.widgetnav.vacations.setExpandedWidgetContainerHeight();if(perRoomChildCount>0)
{$("#childCountRightContainer"+roomCounter+"_hotelCar").show();var perChildAgeSeatOptionDetails=roomDetailsArr[2];var perChildAgeSeatOptionDetailsArr=perChildAgeSeatOptionDetails.split("_");for(var k=0;k<perChildAgeSeatOptionDetailsArr.length;k++){if(perChildAgeSeatOptionDetailsArr[k]!=""){$("#child_"+roomCounter+"_"+(k+1)+"AgeDiv"+"_hotelCar").show();$("#child_"+roomCounter+"_"+(k+1)+"Age"+"_hotelCar").val(perChildAgeSeatOptionDetailsArr[k]);}}}
roomCounter++;}
delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");}else if(childCount>0){$("#hotelCarVacationExpandedSearchContainer").removeAttr("style");delta.widgetnav.vacations.expandHotelCarWidget();var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));delta.widgetnav.vacations.resetRoomTabs();delta.widgetnav.vacations.setEachRoomTabWidth();delta.widgetnav.vacations.hideRoomTabs("1");delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");var roomCounter=1;var roomDetails=searchDetailsArr[9];var roomDetailsArr=roomDetails.split("~");var perRoomAdultNo=roomDetailsArr[0];$("#hiddenAdultCount"+roomCounter+"_hotelCar").val(perRoomAdultNo);var perRoomChildCount=roomDetailsArr[1];$("#hiddenchildrenNumber"+roomCounter+"_hotelCar").val(perRoomChildCount);delta.widgetnav.vacations.setExpandedWidgetContainerHeight();if(perRoomChildCount>0)
{$("#childCountRightContainer"+roomCounter+"_hotelCar").show();var perChildAgeSeatOptionDetails=roomDetailsArr[2];var perChildAgeSeatOptionDetailsArr=perChildAgeSeatOptionDetails.split("_");for(var k=0;k<perChildAgeSeatOptionDetailsArr.length;k++){if(perChildAgeSeatOptionDetailsArr[k]!=""){$("#child_"+roomCounter+"_"+(k+1)+"AgeDiv"+"_hotelCar").show();$("#child_"+roomCounter+"_"+(k+1)+"Age"+"_hotelCar").val(perChildAgeSeatOptionDetailsArr[k]);}}}
delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"_hotelCar");}else if($("#delta-vacations-expanded-tabs").css("display")!='none'){$("#vacationSearchWidgetContainer").removeClass("expadedContainer");$("#hotelCarVacationExpandedSearchContainer").hide();delta.widgetnav.vacations.hideRemovedRoomDetails("0",formContainer,"_hotelCar");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-tabs-selected");$("#delta-vacations-expanded-tabs ul").find("li.ui-tabs-selected").removeClass("ui-state-active");delta.widgetnav.vacations.roomTabHandlerFunction("1",formContainer,"");delta.widgetnav.vacations.collapseHotelCarWidget();}
delta.widgetnav.vacations.hideSearchDiv();},hidePopups:function(){$("#vacationsRecentSearchesBox").slideUp(300);$('#vacartionsRecentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});},hideSearchDiv:function(){$('#vacationsRecentSearchesBox').hide();$('#vacartionsRecentSearchArrow').css({'border-bottom-color':'#acadad','background-color':'transparent'});},showSearch:function(from){$("#vacationsRecentSearch").show();$('#vacationsRecentSearch').css("border-bottom","none");setTimeout(function(){resizeVacationsWidget.resize();},200);},setVacationCalendarControl:function(fromFieldId,toFieldId,fromFieldName,toFieldName,dateFieldsContainer){var language="en";var country="US";var displayFormat="MM/dd/yyyy";var langcntryRegEx=/^[a-zA-Z]{2}$/;var locationObj=window.location;var protocol=locationObj.protocol;var host=locationObj.host;var ctx=protocol+"//"+host;delta.calendar.globalConfiguration();delta.calendar.create({calendarElement:$('.'+dateFieldsContainer),daysInFutureToShow:331,daysInPastToShow:0,startDateTitle:fromFieldName,endDateTitle:toFieldName,onSelect:delta.widgetnav.vacations.triggerDepartureDateEvent(fromFieldId),showDropDown:true});},triggerDepartureDateEvent:function(fromFieldId){$("#"+fromFieldId).trigger("change");},roomTabHandlerFunction:function(selectedRoomId,formContainer,formType){for(var k=1;k<=4;k++){if(k!=parseInt(selectedRoomId))
{$("#vacationsRoom"+k).parent().removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active");$(formContainer+"#roomGuestLeftContainer"+k+formType).hide();$(formContainer+"#childCountRightContainer"+k+formType).hide();}else{$("#vacationsRoom"+k).parent().addClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active");$(formContainer+"#roomGuestLeftContainer"+k+formType).show();var childCountSelected=$(formContainer+"#roomGuestLeftContainer"+k+formType+" #hiddenchildrenNumber"+k+formType).val();if(childCountSelected>0)
$(formContainer+"#childCountRightContainer"+k+formType).show();}}},setExpandedWidgetContainerHeight:function(){var selectedTabId=$("ul.tabHolder").find("li.active")[0].id;if(selectedTabId=="flightHotelTab"){$("#flightHotelVacationSearchContainer").removeAttr("style");$("#flightHotelVacationSearchContainer").show();$("#flightHotelVacationExpandedSearchContainer").removeAttr("style");$("#flightHotelVacationExpandedSearchContainer").show();}else if(selectedTabId=="flightCarTab"){$("#flightCarVacationSearchContainer").removeAttr("style");$("#flightCarVacationSearchContainer").show();$("#flightCarVacationExpandedSearchContainer").removeAttr("style");$("#flightCarVacationExpandedSearchContainer").show();}else{$("#hotelCarVacationSearchContainer").removeAttr("style");$("#hotelCarVacationSearchContainer").show();$("#hotelCarVacationExpandedSearchContainer").removeAttr("style");$("#hotelCarVacationExpandedSearchContainer").show();}
var recentSearchContainerHeight=0;if($("#vacationsRecentSearchContainer").css('display')!='none'){recentSearchContainerHeight=$("#vacationsRecentSearchContainer").height()+
parseInt($("#vacationsRecentSearchContainer").css("padding-top").replace("px",""))+
parseInt($("#vacationsRecentSearchContainer").css("padding-bottom").replace("px",""));}
if(recentSearchContainerHeight!=0){if(selectedTabId=="flightHotelTab"){var currentMargin=parseInt($("#flightHotelVacationExpandedSearchContainer").css("margin-top").replace("px",""));$("#flightHotelVacationExpandedSearchContainer").css("margin-top",(currentMargin-recentSearchContainerHeight)+"px");}else if(selectedTabId=="flightCarTab"){var currentMargin=parseInt($("#flightCarVacationExpandedSearchContainer").css("margin-top").replace("px",""));$("#flightCarVacationExpandedSearchContainer").css("margin-top",(currentMargin-recentSearchContainerHeight)+"px");}else{var currentMargin=parseInt($("#hotelCarVacationExpandedSearchContainer").css("margin-top").replace("px",""));$("#hotelCarVacationExpandedSearchContainer").css("margin-top",(currentMargin-recentSearchContainerHeight)+"px");}}
var widgetTabeHeight=$("#vacationSearchWidgetContainer div.widgetTabs").height()+
parseInt($("#vacationSearchWidgetContainer div.widgetTabs").css("padding-top").replace("px",""));var vacationTabHeight=$("#book-delta-vacations-content-tab").height();var roomTabHeight=$("#delta-vacations-expanded-tabs ul li").height();if(selectedTabId=="flightHotelTab"){var vacationSearchWidgetHeight=$("#flightHotelVacationSearchContainer").height()+
parseInt($("#flightHotelVacationSearchContainer").css("padding-top").replace("px",""));var expandedWidgetContainerHeight=(vacationSearchWidgetHeight+vacationTabHeight+widgetTabeHeight
+recentSearchContainerHeight)-roomTabHeight;$("#flightHotelVacationExpandedSearchContainer .childCountRightContainer").css("height",(expandedWidgetContainerHeight-10)+"px");$("#flightHotelExpandedWidgetDiv").css("height",expandedWidgetContainerHeight+"px");}else if(selectedTabId=="flightCarTab"){var vacationSearchWidgetHeight=$("#flightCarVacationSearchContainer").height()+
parseInt($("#flightCarVacationSearchContainer").css("padding-top").replace("px",""));var expandedWidgetContainerHeight=(vacationSearchWidgetHeight+vacationTabHeight+widgetTabeHeight
+recentSearchContainerHeight)-roomTabHeight;$("#flightCarVacationExpandedSearchContainer .childCountRightContainer").css("height",(expandedWidgetContainerHeight-10)+"px");$("#flightCarExpandedWidgetDiv").css("height",expandedWidgetContainerHeight+"px");}else{var vacationSearchWidgetHeight=$("#hotelCarVacationSearchContainer").height()+
parseInt($("#hotelCarVacationSearchContainer").css("padding-top").replace("px",""));var expandedWidgetContainerHeight=(vacationSearchWidgetHeight+vacationTabHeight+widgetTabeHeight
+recentSearchContainerHeight)-roomTabHeight;$("#hotelCarVacationExpandedSearchContainer .childCountRightContainer").css("height",(expandedWidgetContainerHeight-10)+"px");$("#hotelCarExpandedWidgetDiv").css("height",expandedWidgetContainerHeight+"px");}},resetExpandedWidgetContainerHeight:function(formContainer,formType){$(formContainer).removeAttr("style");$(formContainer).show();var selectedTab=parseInt($("#delta-vacations-expanded-tabs ul li.ui-state-active a")[0].id.replace("vacationsRoom",""));$("#childCountRightContainer"+selectedTab+formType).removeAttr("style");$("#childCountRightContainer"+selectedTab+formType).show();var childCountRightContainerHeight=$("#childCountRightContainer"+selectedTab+formType).height();var selectedChildCount=$("#hiddenchildrenNumber"+selectedTab+formType).val();var singleChildAgeDivHeight=$("#child_"+selectedTab+"_1AgeDiv"+formType).height()+
parseInt($("#child_"+selectedTab+"_1AgeDiv"+formType).css("padding-top").replace("px",""));var totalChildAgeDivHeight=singleChildAgeDivHeight*selectedChildCount;if(selectedChildCount>=7&&!$.browser.msie)
totalChildAgeDivHeight=totalChildAgeDivHeight+1;var currentExpandedDivHeight=0;var vacationSearchWidgetPadding=0;if(formType==""){currentExpandedDivHeight=$("#flightHotelExpandedWidgetDiv").height();vacationSearchWidgetPadding=parseInt($("#flightHotelVacationSearchContainer").css("padding-top").replace("px",""));}else if(formType=="_flightCar"){currentExpandedDivHeight=$("#flightCarExpandedWidgetDiv").height();vacationSearchWidgetPadding=parseInt($("#flightCarVacationSearchContainer").css("padding-top").replace("px",""));}
var recentSearchContainerHeight=0;if($("#vacationsRecentSearchContainer").css('display')!='none'){recentSearchContainerHeight=$("#vacationsRecentSearchContainer").height()+
parseInt($("#vacationsRecentSearchContainer").css("padding-top").replace("px",""))+
parseInt($("#vacationsRecentSearchContainer").css("padding-bottom").replace("px",""));var currentMargin=parseInt($(formContainer).css("margin-top").replace("px",""));$(formContainer).css("margin-top",(currentMargin-recentSearchContainerHeight)+"px");if($.browser.msie){if(selectedChildCount==8)
totalChildAgeDivHeight=totalChildAgeDivHeight+1;}
else if(selectedChildCount==7)
totalChildAgeDivHeight=totalChildAgeDivHeight-1;}else if(selectedChildCount>=7)
totalChildAgeDivHeight=totalChildAgeDivHeight+1;var widgetTabeHeight=$("#vacationSearchWidgetContainer div.widgetTabs").height()+
parseInt($("#vacationSearchWidgetContainer div.widgetTabs").css("padding-top").replace("px",""));var vacationTabHeight=$("#book-delta-vacations-content-tab").height();if(totalChildAgeDivHeight>childCountRightContainerHeight){var paddingLastDiv=20;$("#childCountRightContainer"+selectedTab+formType).height((totalChildAgeDivHeight+paddingLastDiv)+"px");var vacationSearchWidgetHeight=(totalChildAgeDivHeight+paddingLastDiv+20+vacationSearchWidgetPadding)-
recentSearchContainerHeight-widgetTabeHeight-vacationTabHeight;if(formType==""){$("#flightHotelExpandedWidgetDiv").height((totalChildAgeDivHeight+paddingLastDiv+10)+"px");$("#flightHotelVacationSearchContainer").height(vacationSearchWidgetHeight+"px");}else if(formType=="_flightCar"){$("#flightCarExpandedWidgetDiv").height((totalChildAgeDivHeight+paddingLastDiv+10)+"px");$("#flightCarVacationSearchContainer").height(vacationSearchWidgetHeight+"px");}
resizeVacationsWidget.resize();}else{delta.widgetnav.vacations.setExpandedWidgetContainerHeight();}},saveRecentSearchesData:function(){var activeSearchTabId=$("#book-delta-vacations-content .widgetTabs ul li.active")[0].id;if(activeSearchTabId=="flightHotelTab"){saveSingleAttributeValuePair("vacationFlightHotelSearches",delta.widgetnav.vacations.flightHotel_FormatRecentSearchesData());}else if(activeSearchTabId=="flightCarTab"){saveSingleAttributeValuePair("vacationFlightCarSearches",delta.widgetnav.vacations.flightCar_FormatRecentSearchesData());}else{saveSingleAttributeValuePair("vacationHotelCarSearches",delta.widgetnav.vacations.hotelCar_FormatRecentSearchesData());}},flightHotel_FormatRecentSearchesData:function(){var vacationSearchParams="";var searchType="flightHotelVacationSearch";var departureAirport=$("form#flightHotelSearchForm #fromAirport").val();var arrivalAirport=$("form#flightHotelSearchForm #toAirport").val();var departureDate=$("form#flightHotelSearchForm #vacationsdepartureDate").val();var arrivalDate=$("form#flightHotelSearchForm #vacationsreturnDate").val();var adultCount=$("form#flightHotelSearchForm #adultCount").val();var childCount=$("form#flightHotelSearchForm #childCount").val();var roomCount=parseInt($("form#flightHotelSearchForm #numberOfRooms").val());vacationSearchParams=searchType+"|"+vacationSearchParams+departureAirport+"|"+arrivalAirport+"|"+departureDate+"|"
+arrivalDate+"|"+roomCount+"|"+adultCount+"|"+childCount+"|";var perRoomAdultChildCountParam="";if(roomCount>1){for(var i=1;i<=roomCount;i++){var perRoomAdultChildSearchParam="";var perRoomAdultCount=parseInt($("form#flightHotelSearchForm #hiddenAdultCount"+i).val());var perRoomChildCount=parseInt($("form#flightHotelSearchForm #hiddenchildrenNumber"+i).val());perRoomAdultChildCountParam=perRoomAdultChildCountParam+perRoomAdultCount+"~"+perRoomChildCount;if(perRoomChildCount>0){for(var j=1;j<=perRoomChildCount;j++){var perRoomChildAge=parseInt($("form#flightHotelSearchForm #child_"+i+"_"+j+"Age").val());perRoomAdultChildSearchParam=perRoomAdultChildSearchParam+perRoomChildAge+"_";}
perRoomAdultChildCountParam=perRoomAdultChildCountParam+"~"+perRoomAdultChildSearchParam+"|";}else{perRoomAdultChildCountParam=perRoomAdultChildCountParam+"|";}}}else if(childCount>0){var perRoomAdultChildSearchParam="";var perRoomAdultCount=parseInt($("form#flightHotelSearchForm #hiddenAdultCount1").val());var perRoomChildCount=parseInt($("form#flightHotelSearchForm #hiddenchildrenNumber1").val());perRoomAdultChildCountParam=perRoomAdultChildCountParam+perRoomAdultCount+"~"+perRoomChildCount;if(perRoomChildCount>0){for(var j=1;j<=perRoomChildCount;j++){var perRoomChildAge=parseInt($("form#flightHotelSearchForm #child_1"+"_"+j+"Age").val());perRoomAdultChildSearchParam=perRoomAdultChildSearchParam+perRoomChildAge+"_";}
perRoomAdultChildCountParam=perRoomAdultChildCountParam+"~"+perRoomAdultChildSearchParam+"|";}else{perRoomAdultChildCountParam=perRoomAdultChildCountParam+"|";}}
vacationSearchParams=vacationSearchParams+perRoomAdultChildCountParam+"#"+$("#flightHotelRecentSearches").val();return vacationSearchParams;},flightCar_FormatRecentSearchesData:function(){var vacationSearchParams="";var searchType="flightCarVacationSearch";var departureAirport=$("form#flightCarSearchForm #flightCarFromAirport").val();var arrivalAirport=$("form#flightCarSearchForm #flightCarToAirport").val();var departureDate=$("form#flightCarSearchForm #flightCarVacationsdepartureDate").val();var arrivalDate=$("form#flightCarSearchForm #flightCarVacationsreturnDate").val();var adultCount=$("form#flightCarSearchForm #flightCarAdultCount").val();var childCount=$("form#flightCarSearchForm #flightCarChildCount").val();vacationSearchParams=searchType+"|"+vacationSearchParams+departureAirport+"|"+arrivalAirport+"|"+departureDate+"|"
+arrivalDate+"|"+adultCount+"|"+childCount+"|";var childDetailsParam="";if(childCount>0){var perRoomAdultChildSearchParam="";var perRoomAdultCount=parseInt($("form#flightCarSearchForm #hiddenAdultCount1_flightCar").val());var perRoomChildCount=parseInt($("form#flightCarSearchForm #hiddenchildrenNumber1_flightCar").val());childDetailsParam=childDetailsParam+perRoomAdultCount+"~"+perRoomChildCount;if(perRoomChildCount>0){for(var j=1;j<=perRoomChildCount;j++){var perRoomChildAge=parseInt($("form#flightCarSearchForm #child_1"+"_"+j+"Age_flightCar").val());perRoomAdultChildSearchParam=perRoomAdultChildSearchParam+perRoomChildAge+"_";}
childDetailsParam=childDetailsParam+"~"+perRoomAdultChildSearchParam+"|";}else{childDetailsParam=childDetailsParam+"|";}}
vacationSearchParams=vacationSearchParams+childDetailsParam+"#"+$("#flightCarRecentSearches").val();return vacationSearchParams;},hotelCar_FormatRecentSearchesData:function(){var vacationSearchParams="";var searchType="hotelCarVacationSearch";var departureAirport=$("form#hotelCarSearchForm #vacationHotelLocation").val();var locationCode=$("form#hotelCarSearchForm #vacationsHotelLocationCodeWidget").val();var locationType=$("form#hotelCarSearchForm #vacationsHotelLocationTypeWidget").val();var departureDate=$("form#hotelCarSearchForm #hotelCheckInDate").val();var arrivalDate=$("form#hotelCarSearchForm #hotelCheckOutDate").val();var adultCount=$("form#hotelCarSearchForm #travelerAdultCount").val();var childCount=$("form#hotelCarSearchForm #travelerChildCount").val();var roomCount=parseInt($("form#hotelCarSearchForm #hotelNumberOfRooms").val());vacationSearchParams=searchType+"|"+departureAirport+"|"+locationCode+"|"+locationType+"|"+departureDate+"|"
+arrivalDate+"|"+roomCount+"|"+adultCount+"|"+childCount+"|";var perRoomAdultChildCountParam="";if(roomCount>1){for(var i=1;i<=roomCount;i++){var perRoomAdultChildSearchParam="";var perRoomAdultCount=parseInt($("form#hotelCarSearchForm #hiddenAdultCount"+i+"_hotelCar").val());var perRoomChildCount=parseInt($("form#hotelCarSearchForm #hiddenchildrenNumber"+i+"_hotelCar").val());perRoomAdultChildCountParam=perRoomAdultChildCountParam+perRoomAdultCount+"~"+perRoomChildCount;if(perRoomChildCount>0){for(var j=1;j<=perRoomChildCount;j++){var perRoomChildAge=parseInt($("form#hotelCarSearchForm #child_"+i+"_"+j+"Age_hotelCar").val());perRoomAdultChildSearchParam=perRoomAdultChildSearchParam+perRoomChildAge+"_";}
perRoomAdultChildCountParam=perRoomAdultChildCountParam+"~"+perRoomAdultChildSearchParam+"|";}else{perRoomAdultChildCountParam=perRoomAdultChildCountParam+"|";}}}else if(childCount>0){var perRoomAdultChildSearchParam="";var perRoomAdultCount=parseInt($("form#hotelCarSearchForm #hiddenAdultCount1_hotelCar").val());var perRoomChildCount=parseInt($("form#hotelCarSearchForm #hiddenchildrenNumber1_hotelCar").val());perRoomAdultChildCountParam=perRoomAdultChildCountParam+perRoomAdultCount+"~"+perRoomChildCount;if(perRoomChildCount>0){for(var j=1;j<=perRoomChildCount;j++){var perRoomChildAge=parseInt($("form#hotelCarSearchForm #child_1"+"_"+j+"Age_hotelCar").val());perRoomAdultChildSearchParam=perRoomAdultChildSearchParam+perRoomChildAge+"_";}
perRoomAdultChildCountParam=perRoomAdultChildCountParam+"~"+perRoomAdultChildSearchParam+"|";}else{perRoomAdultChildCountParam=perRoomAdultChildCountParam+"|";}}
vacationSearchParams=vacationSearchParams+perRoomAdultChildCountParam+"#"+$("#hotelCarRecentSearches").val();return vacationSearchParams;},storeRecentSearches:function(attributeList){if(attributeList!=undefined&&attributeList!=null&&attributeList!="")
{delta.widgetnav.vacations.fetchedRecentSearchesData=attributeList;delta.widgetnav.vacations.recentSearchesStored=true;$("ul#vacationsRecentSearch").html("");var activeSearchTabId=$("#book-delta-vacations-content .widgetTabs ul li.active")[0].id;if(activeSearchTabId=="flightHotelTab"){if(attributeList.indexOf("flightHotelVacationSearch")!=-1)
{$("#vacationsRecentSearchContainer").show();}else{$("#vacationsRecentSearchContainer").hide();}}else if(activeSearchTabId=="flightCarTab"){if(attributeList.indexOf("flightCarVacationSearch")!=-1)
{$("#vacationsRecentSearchContainer").show();}else{$("#vacationsRecentSearchContainer").hide();}}else{if(attributeList.indexOf("hotelCarVacationSearch")!=-1)
{$("#vacationsRecentSearchContainer").show();}else{$("#vacationsRecentSearchContainer").hide();}}}else{$("ul#vacationsRecentSearch").html("");$("#vacationsRecentSearchContainer").hide();}},populateSearchCriteria:function(key){var attributeList=null;if(delta.widgetnav.vacations.recentSearchesStored){attributeList=delta.widgetnav.vacations.fetchedRecentSearchesData;}
else
{delta.widgetnav.vacations.loadRecentSearches(key);attributeList=delta.widgetnav.vacations.fetchedRecentSearchesData;}
$("ul#vacationsRecentSearch").html("");var activeSearchTabId=$("#book-delta-vacations-content .widgetTabs ul li.active")[0].id;if(activeSearchTabId=="flightHotelTab"){delta.widgetnav.vacations.flightHotel_PopulateSearchCriteria(attributeList);}else if(activeSearchTabId=="flightCarTab"){delta.widgetnav.vacations.flightCar_PopulateSearchCriteria(attributeList);}else{delta.widgetnav.vacations.hotelCar_PopulateSearchCriteria(attributeList);}},flightHotel_PopulateSearchCriteria:function(attributeList){if(attributeList!=undefined&&attributeList!=null&&attributeList!=""){$("#flightHotelRecentSearches").val(attributeList);var recentSearches=attributeList.split("#");var list="";for(var i=0;i<recentSearches.length;i++){var search=recentSearches[i];if(search!=null&&search!="")
{var searchDetailsArr=search.split("|");var searchType=searchDetailsArr[0];if(searchType=='flightHotelVacationSearch'){var departurenCity=searchDetailsArr[1];var arrivalCity=searchDetailsArr[2];var departureDate=searchDetailsArr[3];var arrivalDate=searchDetailsArr[4];var roomCount=searchDetailsArr[5];var departure_date=new Date(departureDate);var deptDateStr=month_names[departure_date.getMonth()]+" "+departure_date.getDate();var arrival_date=new Date(arrivalDate);var arrivalDateStr=month_names[arrival_date.getMonth()]+" "+arrival_date.getDate();list=list+"<li class='vacationsRecentInput' id='"+search+"' > "+departurenCity+" to "
+arrivalCity+", "+deptDateStr+" - "+arrivalDateStr+"</li>";}}}
$("ul#vacationsRecentSearch").html(list);}},flightCar_PopulateSearchCriteria:function(attributeList){if(attributeList!=undefined&&attributeList!=null&&attributeList!=""){$("#flightCarRecentSearches").val(attributeList);var recentSearches=attributeList.split("#");var list="";for(var i=0;i<recentSearches.length;i++){var search=recentSearches[i];if(search!=null&&search!="")
{var searchDetailsArr=search.split("|");var searchType=searchDetailsArr[0];if(searchType=='flightCarVacationSearch'){var departurenCity=searchDetailsArr[1];var arrivalCity=searchDetailsArr[2];var departureDate=searchDetailsArr[3];var arrivalDate=searchDetailsArr[4];var roomCount=searchDetailsArr[5];var departure_date=new Date(departureDate);var deptDateStr=month_names[departure_date.getMonth()]+" "+departure_date.getDate();var arrival_date=new Date(arrivalDate);var arrivalDateStr=month_names[arrival_date.getMonth()]+" "+arrival_date.getDate();list=list+"<li class='vacationsRecentInput' id='"+search+"' > "+departurenCity+" to "
+arrivalCity+", "+deptDateStr+" - "+arrivalDateStr+"</li>";}}}
$("ul#vacationsRecentSearch").html(list);}},hotelCar_PopulateSearchCriteria:function(attributeList){if(attributeList!=undefined&&attributeList!=null&&attributeList!=""){$("#hotelCarRecentSearches").val(attributeList);var recentSearches=attributeList.split("#");var list="";for(var i=0;i<recentSearches.length;i++){var search=recentSearches[i];if(search!=null&&search!="")
{var searchDetailsArr=search.split("|");var searchType=searchDetailsArr[0];if(searchType=='hotelCarVacationSearch'){var hotelLocation=searchDetailsArr[1];var startDate=searchDetailsArr[4];var endDate=searchDetailsArr[5];var start_date=new Date(startDate);var startDateStr=month_names[start_date.getMonth()]+" "+start_date.getDate();var end_date=new Date(endDate);var endDateStr=month_names[end_date.getMonth()]+" "+end_date.getDate();list=list+"<li class='vacationsRecentInput' id='"+search+"' > "+hotelLocation+", "+
startDateStr+" - "+endDateStr+"</li>";}}}
$("ul#vacationsRecentSearch").html(list);}},expandFlightHotelWidget:function(){$("#widget-booking").addClass("expandedWidgetContainer");$("#delta-vacations-expanded-tabs").show();$("#book-delta-vacations-content-tab").addClass("book-delta-vacations-content-tab-expanded");$("#book-tabs").addClass("float-left");$("#delta-vacations-expanded-tabs").addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");$("#book-delta-vacations-content #vacationSearchWidgetContainer").addClass("vacationSearchWidgetContainerExpanded");$("#book-delta-vacations-content #vacationSearchWidgetContainer #seperatorForExpand").show();$("#book-delta-vacations-content #vacationSearchWidgetContainer #flightHotelVacationSearchContainer #advancedSearch").hide();$("#book-delta-vacations-content #vacationSearchWidgetContainer #flightHotelVacationSearchContainer #vacationsSubmit").hide();$("#vacationSearchWidgetContainer").addClass("expadedContainer");$("#flightHotelVacationExpandedSearchContainer").show();$("#flightHotelExpandedWidgetDiv").addClass("expandedBorder");$("#flightHotelVacationSearchContainer").addClass("expandedBorder");},expandFlightCarWidget:function(){$("#widget-booking").addClass("expandedWidgetContainer");$("#delta-vacations-expanded-tabs").show();$("#book-delta-vacations-content-tab").addClass("book-delta-vacations-content-tab-expanded");$("#book-tabs").addClass("float-left");$("#delta-vacations-expanded-tabs").addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");$("#book-delta-vacations-content #vacationSearchWidgetContainer").addClass("vacationSearchWidgetContainerExpanded");$("#book-delta-vacations-content #vacationSearchWidgetContainer #seperatorForExpand").show();$("#book-delta-vacations-content #vacationSearchWidgetContainer #flightCarVacationSearchContainer #flightCarAdvancedSearch").hide();$("#book-delta-vacations-content #vacationSearchWidgetContainer #flightCarVacationSearchContainer #flightCarVacationsSubmit").hide();$("#vacationSearchWidgetContainer").addClass("expadedContainer");$("#flightCarVacationExpandedSearchContainer").show();$("#flightCarExpandedWidgetDiv").addClass("expandedBorder");$("#flightCarVacationSearchContainer").addClass("expandedBorder");},expandHotelCarWidget:function(){$("#widget-booking").addClass("expandedWidgetContainer");$("#delta-vacations-expanded-tabs").show();$("#book-delta-vacations-content-tab").addClass("book-delta-vacations-content-tab-expanded");$("#book-tabs").addClass("float-left");$("#delta-vacations-expanded-tabs").addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");$("#book-delta-vacations-content #vacationSearchWidgetContainer").addClass("vacationSearchWidgetContainerExpanded");$("#book-delta-vacations-content #vacationSearchWidgetContainer #seperatorForExpand").show();$("#book-delta-vacations-content #vacationSearchWidgetContainer #hotelCarVacationSearchContainer #hotelCarAdvancedSearch").hide();$("#book-delta-vacations-content #vacationSearchWidgetContainer #hotelCarVacationSearchContainer #hotelCarVacationsSubmit").hide();$("#vacationSearchWidgetContainer").addClass("expadedContainer");$("#hotelCarVacationExpandedSearchContainer").show();$("#hotelCarExpandedWidgetDiv").addClass("expandedBorder");$("#hotelCarVacationSearchContainer").addClass("expandedBorder");},collapseFlightHotelWidget:function(){$("#widget-booking").removeClass("expandedWidgetContainer");$("#delta-vacations-expanded-tabs").hide();$("#book-delta-vacations-content-tab").removeClass("book-delta-vacations-content-tab-expanded");$("#book-tabs").removeClass("float-left");$("#book-delta-vacations-content #vacationSearchWidgetContainer").removeClass("vacationSearchWidgetContainerExpanded");$("#book-delta-vacations-content #vacationSearchWidgetContainer #seperatorForExpand").hide();$("#book-delta-vacations-content #vacationSearchWidgetContainer #flightHotelVacationSearchContainer .advancedSearch").show();$("#book-delta-vacations-content #vacationSearchWidgetContainer #vacationsSubmit").show();$("#flightHotelExpandedWidgetDiv").removeClass("expandedBorder");$("#flightHotelVacationSearchContainer").removeClass("expandedBorder");},collapseFlightCarWidget:function(){$("#widget-booking").removeClass("expandedWidgetContainer");$("#delta-vacations-expanded-tabs").hide();$("#book-delta-vacations-content-tab").removeClass("book-delta-vacations-content-tab-expanded");$("#book-tabs").removeClass("float-left");$("#book-delta-vacations-content #vacationSearchWidgetContainer").removeClass("vacationSearchWidgetContainerExpanded");$("#book-delta-vacations-content #vacationSearchWidgetContainer #seperatorForExpand").hide();$("#book-delta-vacations-content #vacationSearchWidgetContainer #flightCarVacationSearchContainer .advancedSearch").show();$("#book-delta-vacations-content #vacationSearchWidgetContainer #vacationsSubmit").show();$("#flightCarExpandedWidgetDiv").removeClass("expandedBorder");$("#flightCarVacationSearchContainer").removeClass("expandedBorder");},collapseHotelCarWidget:function(){$("#widget-booking").removeClass("expandedWidgetContainer");$("#delta-vacations-expanded-tabs").hide();$("#book-delta-vacations-content-tab").removeClass("book-delta-vacations-content-tab-expanded");$("#book-tabs").removeClass("float-left");$("#book-delta-vacations-content #vacationSearchWidgetContainer").removeClass("vacationSearchWidgetContainerExpanded");$("#book-delta-vacations-content #vacationSearchWidgetContainer #seperatorForExpand").hide();$("#book-delta-vacations-content #vacationSearchWidgetContainer #hotelCarAdvancedSearch").show();$("#book-delta-vacations-content #vacationSearchWidgetContainer #hotelCarVacationsSubmit").show();$("#hotelCarExpandedWidgetDiv").removeClass("expandedBorder");$("#hotelCarVacationSearchContainer").removeClass("expandedBorder");},resetRoomTabs:function(){for(var j=1;j<=4;j++){$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+j).parent().show();$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+j).parent().removeClass("lastVacationsRoomTab");}},setEachRoomTabWidth:function(){var totalWidth=$("#delta-vacations-expanded-tabs").width();var maxRoomCount=4;var eachRoomTabWidth=((totalWidth-1)-(maxRoomCount-1))/maxRoomCount;$("#delta-vacations-expanded-tabs ul li").css("width",eachRoomTabWidth+"px");$("#delta-vacations-expanded-tabs ul li a.vacationRooms").css("width",eachRoomTabWidth+"px");},hideRoomTabs:function(roomCount){for(var i=parseInt(roomCount)+1;i<=4;i++){$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+i).parent().hide();}
$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+roomCount).parent().addClass("lastVacationsRoomTab");},showExpandedTabName:function(){for(var j=1;j<=4;j++){$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+j).parent().show();}
$("#delta-vacations-expanded-tabs ul").removeClass("noRoomExpandedTab");},hideExpandedTabName:function(){for(var j=1;j<=4;j++){$("#delta-vacations-expanded-tabs ul li a#vacationsRoom"+j).parent().hide();}
$("#delta-vacations-expanded-tabs ul").addClass("noRoomExpandedTab");},hideRemovedRoomDetails:function(roomCount,formContainer,formType){for(var k=parseInt(roomCount)+1;k<=4;k++){$(formContainer+"#hiddenAdultCount"+k+formType).val("1");var roomChildCount=$(formContainer+"#hiddenchildrenNumber"+k+formType).val();$(formContainer+"#hiddenchildrenNumber"+k+formType).val("0");for(var i=1;i<=roomChildCount;i++){$(formContainer+"#child_"+k+"_"+i+"AgeDiv"+formType).hide();$(formContainer+"#child_"+k+"_"+i+"AgeDiv"+formType).removeClass("childSeatOtpionHidden");$(formContainer+"#child_"+k+"_"+i+"Age"+formType).val("1");if(formType==""){$(formContainer+"#inLapOption_"+k+"_"+i).removeClass("seatOptionUnSelected");$(formContainer+"#inLapOption_"+k+"_"+i).addClass("seatOptionSelected");$(formContainer+"#inSeatOption_"+k+"_"+i).addClass("seatOptionUnSelected");$(formContainer+"#inSeatOption_"+k+"_"+i).removeClass("seatOptionSelected");}}
$(formContainer+"#roomGuestLeftContainer"+k+formType).hide();$(formContainer+"#childCountRightContainer"+k+formType).hide();}},promoCodeDataChangeEvent:function(){$("#promoCode").autocomplete({promoCode:"promoCode",smNumber:"skyMilesNumber",source:delta.widgetnav.vacations.promoCodeComplete});$('#promoCode').keyup(function(e){if(e.keyCode==8||e.keyCode==46)
{var smNumberId="skyMilesNumber";var promoCodeVal=this.value;var promoCodeId=this.id;delta.widgetnav.vacations.smNumberDisplay(promoCodeVal,promoCodeId,smNumberId);}});},flightCar_promoCodeDataChangeEvent:function(){$("#flightCarPromoCode").autocomplete({promoCode:"flightCarPromoCode",smNumber:"flightCarSkyMilesNumber",source:delta.widgetnav.vacations.promoCodeComplete});$('#flightCarPromoCode').keyup(function(e){if(e.keyCode==8||e.keyCode==46)
{var smNumberId="flightCarSkyMilesNumber";var promoCodeVal=this.value;var promoCodeId=this.id;delta.widgetnav.vacations.smNumberDisplay(promoCodeVal,promoCodeId,smNumberId);}});},hotelCar_promoCodeDataChangeEvent:function(){$("#hotelCarPromoCode").autocomplete({promoCode:"hotelCarPromoCode",smNumber:"hotelCarSkyMilesNumber",source:delta.widgetnav.vacations.promoCodeComplete});$('#hotelCarPromoCode').keyup(function(e){if(e.keyCode==8||e.keyCode==46)
{var smNumberId="hotelCarSkyMilesNumber";var promoCodeVal=this.value;var promoCodeId=this.id;delta.widgetnav.vacations.smNumberDisplay(promoCodeVal,promoCodeId,smNumberId);}});},promoCodeComplete:function(request,response){var promoCodeVal=request.term.replace(/^\s+/g,"");var promoCodeId=$(this)[0].options.promoCode;var smNumberId=$(this)[0].options.smNumber;delta.widgetnav.vacations.smNumberDisplay(promoCodeVal,promoCodeId,smNumberId);},smNumberDisplay:function(promoCodeVal,promoCodeId,smNumberId){if(promoCodeVal!=""&&promoCodeVal!=undefined&&promoCodeVal.length>1&&promoCodeVal.toLowerCase().substring(0,2)=="sm"){$("#"+promoCodeId+"_div").addClass("promoCodeSmNumberDisplay");$("#"+smNumberId+"_div").show();}else{$('div[for="'+smNumberId+'"]').html("");$('div[for="'+smNumberId+'"]').hide();$("#"+promoCodeId+"_div").removeClass("promoCodeSmNumberDisplay");$("#"+smNumberId).val("");$("#"+smNumberId+"_div").hide();}},validateAdultChildTotal:function(formIdentifier,formType){var formName=formIdentifier+"SearchForm";var errorContainer="vacations-"+formIdentifier+"Search-errorMsg";var formContainer="#"+formIdentifier+"VacationExpandedSearchContainer ";var adultCountSearch=parseInt($("#"+formName+" [name='travelersAdults']").val());var childCountSearch=parseInt($("#"+formName+" [name='travelersChildren']").val());var roomCountSearch=parseInt($("#"+formName+" [name='numberOfRooms']").val());var adultCountExpanded=0;var childCountExpanded=0;var returnVal=true;var countMismatchErrorMsg="Adult and Child count does not match with search.";if(roomCountSearch>1){for(var i=1;i<=roomCountSearch;i++){adultCountExpanded=adultCountExpanded+parseInt($("#"+formName+" [name='rooms["+(i-1)+"].adultsNumber']").val());childCountExpanded=childCountExpanded+parseInt($("#"+formName+" [name='rooms["+(i-1)+"].childrenNumber']").val());}
if((adultCountSearch!=adultCountExpanded)||(childCountSearch!=childCountExpanded)){$("#"+errorContainer).show();$("#"+errorContainer+" div#adultChildCountMismatch"+formType).html(countMismatchErrorMsg);$("#"+errorContainer+" div#adultChildCountMismatch"+formType).show();returnVal=false;}else{$("#"+errorContainer).hide();$("#"+errorContainer+" div#adultChildCountMismatch"+formType).html("");$("#"+errorContainer+" div#adultChildCountMismatch"+formType).hide();returnVal=true;}}else if(childCountSearch>0){adultCountExpanded=parseInt($("#"+formName+" [name='rooms[0].adultsNumber']").val());childCountExpanded=parseInt($("#"+formName+" [name='rooms[0].childrenNumber']").val());if((adultCountSearch!=adultCountExpanded)||(childCountSearch!=childCountExpanded)){$("#"+errorContainer).show();$("#"+errorContainer+" div#adultChildCountMismatch"+formType).html(countMismatchErrorMsg);$("#"+errorContainer+" div#adultChildCountMismatch"+formType).show();returnVal=false;}else{$("#"+errorContainer).hide();$("#"+errorContainer+" div#adultChildCountMismatch"+formType).html("");$("#"+errorContainer+" div#adultChildCountMismatch"+formType).hide();returnVal=true;}}else{returnVal=true;}
delta.widgetnav.vacations.resetHeightOnError(formIdentifier);return returnVal;},resetHeightOnError:function(formType){var errorMessageContainer="vacations-"+formType+"Search-errorMsg";var expandedDiv=formType+"ExpandedWidgetDiv";var searchContainer=formType+"VacationSearchContainer";if(!delta.widgetnav.vacations.isErrorHeightReset&&$("#"+errorMessageContainer).css("display")!="none"){var errorMsgContainerHeight=$("#"+errorMessageContainer).height()+
parseInt($("#"+errorMessageContainer).css("padding-top").replace("px",""));var expandeDivHeight=$("#"+expandedDiv).height();$("#"+expandedDiv).css("height",(errorMsgContainerHeight+expandeDivHeight)+"px");$("#"+searchContainer).css("height",($("#"+searchContainer).height())+"px");delta.widgetnav.vacations.isErrorHeightReset=true;}}};var resizeVacationsWidget={resize:function(){setTimeout(function(){var widgetContainer=$("#widget-booking");widgetContainer.css("height",resizeVacationsWidget.getWidgetHeight());},1);},getWidgetHeight:function(){var vacationContainer=$("#book-tabs");return vacationContainer.height()+vacationContainer.position().top+(!delta.navwidget.isDockedState()?0:33);}};